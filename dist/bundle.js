/*! For license information please see bundle.js.LICENSE.txt */
const e="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};(function(){var e=Object.defineProperty,t=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(n,r){if(r)e:{var o=t;n=n.split(".");for(var i=0;i<n.length-1;i++){var a=n[i];if(!(a in o))break e;o=o[a]}(r=r(i=o[n=n[n.length-1]]))!=i&&null!=r&&e(o,n,{configurable:!0,writable:!0,value:r})}}("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")});var n,r,o=this||self;function i(e,t){function n(){}n.prototype=t.prototype,e.qa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.oa=function(e,n,r){for(var o=Array(arguments.length-2),i=2;i<arguments.length;i++)o[i-2]=arguments[i];return t.prototype[n].apply(e,o)}}function a(e,t){if(Error.captureStackTrace)Error.captureStackTrace(this,a);else{const e=Error().stack;e&&(this.stack=e)}e&&(this.message=String(e)),void 0!==t&&(this.cause=t)}function s(e){o.setTimeout(()=>{throw e},0)}i(a,Error),a.prototype.name="CustomError";e:{for(var c=["CLOSURE_FLAGS"],l=o,u=0;u<c.length;u++)if(null==(l=l[c[u]])){r=null;break e}r=l}var d,p=r&&r[610401301];n=null!=p&&p;const f=o.navigator;function h(e){return!!n&&!!d&&d.brands.some(({brand:t})=>t&&-1!=t.indexOf(e))}function g(e){var t;return(t=o.navigator)&&(t=t.userAgent)||(t=""),-1!=t.indexOf(e)}function m(){return!!n&&!!d&&d.brands.length>0}function y(){return m()?h("Chromium"):(g("Chrome")||g("CriOS"))&&!(!m()&&g("Edge"))||g("Silk")}function v(e,t){(t=Array.prototype.indexOf.call(e,t,void 0))>=0&&Array.prototype.splice.call(e,t,1)}function w(e){let t="",n=0;const r=e.length-10240;for(;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}d=f&&f.userAgentData||null,!g("Android")||y(),y(),g("Safari")&&(y()||!m()&&g("Coast")||!m()&&g("Opera")||!m()&&g("Edge")||(m()?h("Microsoft Edge"):g("Edg/"))||m()&&h("Opera"));const b=/[-_.]/g,k={"-":"+",_:"/",".":"="};function E(e){return k[e]||""}function A(e){return null!=e&&e instanceof Uint8Array}var S={};function T(){return P||(P=new I(null,S))}var I=class{constructor(e,t){if(C(t),this.g=e,null!=e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}};let P,x;function C(e){if(e!==S)throw Error("illegal external caller")}function U(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function M(){const e=Error();U(e,"incident"),s(e)}function j(e){return U(e=Error(e),"warning"),e}function O(){return"function"==typeof BigInt}function _(e){return Array.prototype.slice.call(e)}function N(e,t){return t&&Symbol.for&&e?Symbol.for(e):null!=e?Symbol(e):Symbol()}var R=N("jas",!0);N();var L=N(),G=N();function z(e,t){t[R]=-30975&e}function B(e,t){t[R]=-30941&e|34}N(),N();var D,F={},K={};function W(e){return!(!e||"object"!=typeof e||e.g!==K)}function $(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&e.constructor===Object}function q(e,t){if(null!=e)if("string"==typeof e)e=e?new I(e,S):T();else if(e.constructor!==I)if(A(e))e=e.length?new I(new Uint8Array(e),S):T();else{if(!t)throw Error();e=void 0}return e}function J(e){return!(!Array.isArray(e)||e.length||!(1&e[R]))}const Y=[];function V(e){if(2&e)throw Error()}Y[R]=55,D=Object.freeze(Y);var H=Object.freeze({});function X(e){return e.pa=!0,e}var Q=X(e=>"number"==typeof e),Z=X(e=>"string"==typeof e),ee=X(e=>"boolean"==typeof e),te="function"==typeof o.BigInt&&"bigint"==typeof o.BigInt(0),ne=X(e=>te?e>=oe&&e<=ae:"-"===e[0]?se(e,re):se(e,ie));const re=Number.MIN_SAFE_INTEGER.toString(),oe=te?BigInt(Number.MIN_SAFE_INTEGER):void 0,ie=Number.MAX_SAFE_INTEGER.toString(),ae=te?BigInt(Number.MAX_SAFE_INTEGER):void 0;function se(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],o=t[n];if(r>o)return!1;if(r<o)return!0}}let ce=0,le=0;function ue(e){const t=e>>>0;ce=t,le=(e-t)/4294967296>>>0}function de(e){if(e<0){ue(-e);const[t,n]=he(ce,le);ce=t>>>0,le=n>>>0}else ue(e)}function pe(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else O()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+fe(n)+fe(e));return n}function fe(e){return e=String(e),"0000000".slice(e.length)+e}function he(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function ge(e){return null==e||"boolean"==typeof e?e:"number"==typeof e?!!e:void 0}const me=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function ye(e){const t=typeof e;switch(t){case"bigint":return!0;case"number":return Number.isFinite(e)}return"string"===t&&me.test(e)}function ve(e){if(null!=e){if(!Number.isFinite(e))throw j("enum");e|=0}return e}function we(e){if(null!=e){if("string"==typeof e){if(!e)return;e=+e}"number"==typeof e&&Number.isFinite(e)}}function be(e){if(null!=e)e:{if(!ye(e))throw j("int64");switch(typeof e){case"string":e=Ee(e);break e;case"bigint":var t=e=BigInt.asIntN(64,e);if(Z(t)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(t))throw Error(String(t))}else if(Q(t)&&!Number.isSafeInteger(t))throw Error(String(t));e=te?BigInt(e):ee(e)?e?"1":"0":Z(e)?e.trim()||"0":String(e);break e;default:e=ke(e)}}return e}function ke(e){if(e=Math.trunc(e),!Number.isSafeInteger(e)){de(e);var t=ce,n=le;(e=2147483648&n)&&(n=~n>>>0,0==(t=1+~t>>>0)&&(n=n+1>>>0));const r=4294967296*n+(t>>>0);e="number"==typeof(t=Number.isSafeInteger(r)?r:pe(t,n))?e?-t:t:e?"-"+t:t}return e}function Ee(e){var t=Math.trunc(Number(e));if(Number.isSafeInteger(t))return String(t);if(-1!==(t=e.indexOf("."))&&(e=e.substring(0,t)),!("-"===e[0]?e.length<20||20===e.length&&Number(e.substring(0,7))>-922337:e.length<19||19===e.length&&Number(e.substring(0,6))<922337)){if(e.length<16)de(Number(e));else if(O())e=BigInt(e),ce=Number(e&BigInt(4294967295))>>>0,le=Number(e>>BigInt(32)&BigInt(4294967295));else{t=+("-"===e[0]),le=ce=0;const n=e.length;for(let r=t,o=(n-t)%6+t;o<=n;r=o,o+=6){const t=Number(e.slice(r,o));le*=1e6,ce=1e6*ce+t,ce>=4294967296&&(le+=Math.trunc(ce/4294967296),le>>>=0,ce>>>=0)}if(t){const[e,t]=he(ce,le);ce=e,le=t}}if(e=ce,2147483648&(t=le))if(O())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=he(e,t);e="-"+pe(n,r)}else e=pe(e,t)}return e}function Ae(e){if(null!=e&&"string"!=typeof e)throw Error();return e}function Se(e,t,n){if(null!=e&&"object"==typeof e&&e.H===F)return e;if(Array.isArray(e)){var r=0|e[R],o=r;return 0===o&&(o|=32&n),(o|=2&n)!==r&&(e[R]=o),new t(e)}}let Te,Ie,Pe,xe,Ce,Ue;function Me(e){let t;return null==(t=Te)?void 0:t.get(e)}function je(e){try{return-1!==e.toString().indexOf("[native code]")?e:null}catch{return null}}function Oe(e,t){return _e(t)}function _e(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"bigint":return ne(e)?Number(e):String(e);case"boolean":return e?1:0;case"object":if(e)if(Array.isArray(e)){if(J(e))return}else{if(A(e))return w(e);if(e instanceof I){const t=e.g;return null==t?"":"string"==typeof t?t:e.g=w(t)}}}return e}function Ne(e,t,n,r,o){if(null!=e){if(Array.isArray(e))e=J(e)?void 0:o&&2&e[R]?e:Re(e,t,n,void 0!==r,o);else if($(e)){const i={};for(let a in e)i[a]=Ne(e[a],t,n,r,o);e=i}else e=t(e,r);return e}}function Re(e,t,n,r,o){const i=r||n?0|e[R]:0;r=r?!!(32&i):void 0,e=_(e);for(let i=0;i<e.length;i++)e[i]=Ne(e[i],t,n,r,o);return n&&n(i,e),e}function Le(e){return e.H===F?e.toJSON():_e(e)}function Ge(e,t,n=B){if(null!=e){if(e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[R];return 2&r?e:(t&&(t=0===r||!!(32&r)&&!(64&r||!(16&r))),t?(e[R]=-12293&r|34,e):Re(e,Ge,4&r?B:n,!0,!0))}return e.H===F&&(e=2&(r=(n=e.m)[R])?e:new e.constructor(ze(n,r,!0))),e}}function ze(e,t,n){const r=n||2&t?B:z,o=!!(32&t);return e=function(e,t,n){var r=(e=_(e)).length;const o=256&t?e[r-1]:void 0;for(r+=o?-1:0,t=512&t?1:0;t<r;t++)e[t]=n(e[t]);if(o){t=e[t]={};for(const e in o)t[e]=n(o[e])}return e}(e,t,e=>Ge(e,o,r)),e[R]=32|e[R]|(n?2:0),e}function Be(e){const t=e.m,n=t[R];return 2&n?new e.constructor(ze(t,n,!1)):e}function De(e,t){return Ke(e=e.m,e[R],t)}function Fe(e,t,n,r){if(!((t=r+(+!!(512&t)-1))<0||t>=e.length||t>=n))return e[t]}function Ke(e,t,n,r){if(-1===n)return null;const o=t>>15&1023||536870912;if(!(n>=o)){var i,a=e.length;return r&&256&t&&null!=(r=e[a-1][n])?(Fe(e,t,o,n)&&null!=L&&(e=null!=(i=x)?i:x={},(i=e[L]||0)>=4||(e[L]=i+1,M())),r):Fe(e,t,o,n)}return 256&t?e[e.length-1][n]:void 0}function We(e,t,n){const r=e.m;let o=r[R];return V(o),$e(r,o,t,n),e}function $e(e,t,n,r){const o=t>>15&1023||536870912;if(n>=o){let i,a=t;if(256&t)i=e[e.length-1];else{if(null==r)return a;i=e[o+(+!!(512&t)-1)]={},a|=256}return i[n]=r,n<o&&(e[n+(+!!(512&t)-1)]=void 0),a!==t&&(e[R]=a),a}return e[n+(+!!(512&t)-1)]=r,256&t&&n in(e=e[e.length-1])&&delete e[n],t}function qe(e,t,n,r){return void 0!==Qe(e,t,n=Ve(e,r)===n?n:-1)}function Je(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function Ye(e,t,n,r){const o=e.m;let i=o[R];return V(i),$e(o,i,t,("0"===r?0===Number(n):n===r)?void 0:n),e}function Ve(e,t){return Xe(He(e=e.m),e,e[R],t)}function He(e){let t;return null!=(t=e[G])?t:e[G]=new Map}function Xe(e,t,n,r){let o=e.get(r);if(null!=o)return o;o=0;for(let e=0;e<r.length;e++){const i=r[e];null!=Ke(t,n,i)&&(0!==o&&(n=$e(t,n,o)),o=i)}return e.set(r,o),o}function Qe(e,t,n,r){let o=(e=e.m)[R];return(t=Se(r=Ke(e,o,n,r),t,o))!==r&&null!=t&&$e(e,o,n,t),t}function Ze(e,t,n){if(null==(t=Qe(e,t,n,!1)))return t;let r=(e=e.m)[R];if(!(2&r)){const o=Be(t);o!==t&&$e(e,r,n,t=o)}return t}function et(e,t,n){return null==n&&(n=void 0),We(e,t,n)}function tt(e,t,n,r){null==r&&(r=void 0);e:{const a=e.m;var o=a[R];if(V(o),null==r){var i=He(a);if(Xe(i,a,o,n)!==t)break e;i.set(n,0)}else{const e=He(i=a),r=Xe(e,i,o,n);r!==t&&(r&&(o=$e(i,o,r)),e.set(n,t))}$e(a,o,t,r)}return e}function nt(e,t){const n=e.m;let r=n[R];if(V(r),null==t)return $e(n,r,1),e;var o,i=t;t=(null==(o=Ie)?void 0:o.get(i))||i,o=i=0|t[R];const a=Je(i),s=a||Object.isFrozen(t);let c=!0,l=!0;for(let e=0;e<t.length;e++){var u=t[e];a||(u=!!(2&u.m[R]),c&&(c=!u),l&&(l=u))}return a||(i=c?13:5,i=l?16|i:-17&i),s&&i===o||(t=_(t),o=0,i=ot(i=rt(i,r),r,!0)),i!==o&&(t[R]=i),$e(n,r,1,t),e}function rt(e,t){return-2049&(2&t?2|e:-3&e)|32}function ot(e,t,n){return 32&t&&n||(e&=-33),e}function it(e,t){return null!=e?e:t}function at(e){return null!=(e=De(e,1))&&("bigint"==typeof e?ne(e)?e=Number(e):(e=BigInt.asIntN(64,e),e=ne(e)?Number(e):String(e)):e=ye(e)?"number"==typeof e?ke(e):Ee(e):void 0),it(e,0)}function st(e,t){return it(null==(e=De(e,t))||"string"==typeof e?e:void 0,"")}function ct(e,t){return it(e=null==(e=De(e,t))?e:Number.isFinite(e)?0|e:void 0,0)}function lt(e,t,n,r){return Ze(e,t,n=Ve(e,r)===n?n:-1)}function ut(e){try{return Ue=!0,JSON.stringify(pt(e),Oe)}finally{Ue=!1}}var dt=class{constructor(e){e:{var t=null!=t?t:0;if(null==e){var n=96;e=[]}else{if(!Array.isArray(e))throw Error("narr");if(2048&(n=0|e[R]))throw Error("farr");if(64&n)break e;1===t||2===t||(n|=64);var r=(t=e).length;if(r&&$(t[--r])){if((t=r-(+!!(512&(n|=256))-1))>=1024)throw Error("pvtlmt");n=-33521665&n|(1023&t)<<15}}e[R]=n}this.m=e}toJSON(){return pt(this)}};function pt(e){e=e.m,e=Ue?e:Re(e,Le,void 0,void 0,!1);{var t=!Ue;let l=e.length;if(l){var n=e[l-1],r=$(n);r?l--:n=void 0;var o=e;if(r){e:{var i,a=n,s=!1;if(a)for(let e in a)if(isNaN(+e)){let t;(null!=(t=i)?t:i={})[e]=a[e]}else if(r=a[e],Array.isArray(r)&&(J(r)||W(r)&&0===r.size)&&(r=null),null==r&&(s=!0),null!=r){let t;(null!=(t=i)?t:i={})[e]=r}if(s||(i=a),i)for(let e in i){s=i;break e}s=null}a=null==s?null!=n:s!==n}for(;l>0&&(null==(i=o[l-1])||J(i)||W(i)&&0===i.size);l--)var c=!0;(o!==e||a||c)&&(t?(c||a||s)&&(o.length=l):o=Array.prototype.slice.call(o,0,l),s&&o.push(s)),c=o}else c=e}return c}function ft(e){return t=>{if(null==t||""==t)t=new e;else{if(t=JSON.parse(t),!Array.isArray(t))throw Error("dnarr");t[R]|=32,t=new e(t)}return t}}dt.prototype.H=F,dt.prototype.toString=function(){try{return Ue=!0,pt(this).toString()}finally{Ue=!1}};var ht,gt=(ht=class extends dt{},e=>{if(e=JSON.parse(e),!Array.isArray(e)){var t=typeof e;throw Error("Expected jspb data to be an array, got "+("object"!=t?t:e?Array.isArray(e)?"array":t:"null")+": "+e)}return e[R]|=34,new ht(e)}),mt=class extends dt{};function yt(e){return vt(e,e.index)>=e.g&&(e.h[e.index]=Date.now(),e.index=(e.index+1)%1,!0)}function vt(e,t){let n;return Date.now()-(null!=(n=e.h[t])?n:-1*e.g)}var wt=class{constructor(e){this.g=e,this.h=[],this.index=0}},bt=class extends dt{},kt=[2,3],Et=class extends dt{},At=class extends Error{constructor({errorType:e,message:t,i:n}){super(`Meet Add-on SDK error: ${t}${n?` - ${n}`:""}`),this.errorType=e}},St={errorType:"InternalError",message:"An unexpected error has occurred.",i:"No further information is available."},Tt={errorType:"MissingUrlParameter",message:"Missing required Meet SDK URL parameter",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not strip URL parameters (e.g. as part of a redirect)."},It={errorType:"NeedsMainStageContext",message:"This method can only be invoked if the addon is running in the main stage.",i:"Use getFrameType to check whether the addon is running in the main stage before invoking this method."},Pt={errorType:"NeedsSidePanelContext",message:"This method can only be invoked if the addon is running in the side panel.",i:"Use getFrameType to check whether the addon is running in the side panel before invoking this method."},xt={errorType:"NotSupportedInStandalone",message:"This method is not supported in standalone mode.",i:"Do not call this method in standalone mode."},Ct={errorType:"InternalError",message:"The frame type URL parameter is set to an unexpected value.",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not modify URL parameters (e.g. as part of a redirect)."},Ut={errorType:"InvalidCloudProjectNumber",message:"Cloud Project Number provided by meet does not match the one passed in by the SDK. Ensure that the correct Cloud Project Number is passed to the SDK as a string.",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not modify URL parameters (e.g. as part of a redirect) and ensure that the correct Cloud Project Number was passed into the SDK as a string."},Mt={errorType:"DestinationNotReady",message:"The recipient frame is not connected via the addon SDK and cannot receive the notification.",i:"Make sure the destination frame has connected before sending messages to it."},jt={errorType:"InvalidActivityStartingState",message:"Origin of the ActivityStartingState iframeURLs does not match the origin of the URLs provided in the Add-on manifest.",i:"Ensure that the ActivityStartingState iframeURL origins match the origins of the URLs provided in the Add-on manifest."},Ot={errorType:"ActivityStartingStateMissingAttributes",message:"The supplied ActivityStartingState object does not contain any recognized attributes.",i:"Ensure that the ActivityStartingState object contains at least one of the following attributes: mainStageUrl, sidePanelUrl, additionalData."},_t={errorType:"ActivityStartingStateUnrecognizedAttributes",message:"The supplied ActivityStartingState object contains attributes that are not recognized.",i:"Ensure that the ActivityStartingState object has only the following attributes: mainStageUrl, sidePanelUrl, additionalData."},Nt={errorType:"AddonStartingStateMissingAttributes",message:"The supplied AddonStartingState object does not contain any recognized attributes.",i:"Ensure that the AddonStartingState object contains at least one of the following attributes: sidePanelUrl, additionalData."},Rt={errorType:"AddonStartingStateUnrecognizedAttributes",message:"The supplied AddonStartingState object contains attributes that are not recognized.",i:"Ensure that the AddonStartingState object has only the following attributes: sidePanelUrl, additionalData."},Lt=e=>({errorType:"ArgumentNullError",message:`The argument supplied for '${e}' was 'null' but a value was expected.`,i:"Ensure you are passing a value of the expected type for the argument."}),Gt=(e,t,n)=>({errorType:"ArgumentTypeError",message:`The type '${t}' of argument supplied for '${e}' did not match the expected type '${n}'.`,i:"Ensure the type of the argument provided matches the expected type."}),zt={errorType:"ActivityIsOngoing",message:"Operation cannot be performed while an activity is ongoing.",i:"Ensure that no activity is ongoing."},Bt={errorType:"InternalError",message:"Frame message missing required Meet SDK command.",i:"Send one of the available commands in the frame message."},Dt={errorType:"NoActivityFound",message:"No activity found.",i:"Ensure that the activity is started before performing this operation."},Ft={errorType:"RequiresEapEnrollment",message:"This feature is only available to early access partners.",i:"Meet add-on early access enrollment is currently closed."},Kt={errorType:"UserNotInitiator",message:"Operation cannot be performed because the user is not the initiator of the current activity.",i:"Ensure that the user is the initiator of the current activity or that the activity has ended."},Wt={errorType:"SizeLimitExceededActivityStartingState",message:"The size of the activityStartingState URLs and/or its data exceed the limits allowed.",i:"Ensure that the activityStartingState URL size is less than 512 characters and the additional data size is less than 4096 characters."},$t={errorType:"SizeLimitExceededFrameToFrameMessage",message:"The size of the frame to frame message exceeds the limits allowed.",i:"Ensure that the frame to frame message size is less than 1,000,000 characters."},qt={errorType:"AddonSessionAlreadyCreated",message:"The addon session has already been created.",i:"Only instantiate the AddonSession once."},Jt={errorType:"UserCancelled",message:"The user cancelled starting an activity.",i:"The user needs to click continue to start the activity."},Yt={errorType:"NotSupportedInMeetCall",message:"This method is not supported during a Meet call.",i:"Do not call this method during a Meet call."},Vt={errorType:"InvalidAddonStartingState",message:"Origin of the AddonStartingState iframeURLs does not match the origin of the URLs provided in the Add-on manifest.",i:"Ensure that the AddonStartingState iframeURL origins match the origins of the URLs provided in the Add-on manifest."},Ht={errorType:"SizeLimitExceededAddonStartingState",message:"The size of the AddonStartingState URLs and/or its data exceed the limits allowed.",i:"Ensure that the AddonStartingState URL size is less than 512 characters and the additional data size is less than 4096 characters."},Xt={errorType:"MeetingPolicyPreventsStartingActivity",message:"A meeting policy (such as using host control settings) prevents the user from starting the activity.",i:"Have a meeting host or administrator modify the necessary settings to allow the current user to start the activity."};function Qt({errorType:e,message:t,i:n},r=""){throw new At({errorType:e,message:r?`${t} ${r}`:t,i:n})}function Zt(e,t){Qt({...Tt,message:`${Tt.message}: ${e}. In URL ${t}`})}function en(e){return Ye(new rn,1,ve(e),0)}function tn(e,t){return Ye(e,2,Ae(t),"")}function nn(e,t){return Ye(e,3,Ae(t),"")}var rn=class extends dt{getFrameType(){return ct(this,1)}};function on(e){var t;t=void 0===H?2:4;var n=e.m[R],r=n,o=!(2&n),i=rn;t=(n=!!(2&r))?1:t,o&&(o=!n),n=Ke(e=e.m,r,1);var a=0|(n=Array.isArray(n)?n:D)[R],s=!!(4&a);if(!s){var c=a;0===c&&(c=rt(c,r)),a=n;var l=r;const e=!!(2&(c|=1));e&&(l|=2);let t=!e,o=!0,s=0,u=0;for(;s<a.length;s++){const n=Se(a[s],i,l);if(n instanceof i){if(!e){const e=!!(2&n.m[R]);t&&(t=!e),o&&(o=e)}a[u++]=n}}u<s&&(a.length=u),c|=4,c=o?16|c:-17&c,c=t?8|c:-9&c,a[R]=c,e&&Object.freeze(a),a=c}if(o&&!(8&a||!n.length&&(1===t||4===t&&32&a))){for(Je(a)&&(n=_(n),a=rt(a,r),r=$e(e,r,1,n)),o=n,i=a,a=0;a<o.length;a++)(c=o[a])!==(l=Be(c))&&(o[a]=l);i|=8,i=o.length?-17&i:16|i,a=o[R]=i}let u;if(1===t||4===t&&32&a){if(!Je(a)){r=a;var d=!!(32&a);(a|=!n.length||16&a&&(!s||d)?2:2048)!==r&&(n[R]=a),Object.freeze(n)}}else s=5===t&&(!!(32&a)||Je(a)||!!Me(n)),(2===t||s)&&Je(a)&&(n=_(n),a=ot(a=rt(a,r),r,!1),n[R]=a,r=$e(e,r,1,n)),Je(a)||(e=a,(a=ot(a,r,!1))!==e&&(n[R]=a)),s?u=function(e){var t;return void 0===Pe&&(Pe="function"==typeof Proxy?je(Proxy):null),(t=!Pe)||(void 0===xe&&(xe="function"==typeof WeakMap?je(WeakMap):null),t=!xe),t?e:(t=Me(e))?t:Math.random()>.01?e:(function(e){if(void 0===Ce){const e=new Pe([],{});Ce=1===Array.prototype.concat.call([],e).length}Ce&&"function"==typeof Symbol&&Symbol.isConcatSpreadable&&(e[Symbol.isConcatSpreadable]=!0)}(e),function(e,t){(Te||(Te=new xe)).set(e,t),(Ie||(Ie=new xe)).set(t,e)}(e,t=new Pe(e,{set:(e,t,n)=>(M(),e[t]=n,!0)})),t)}(n):2===t&&(null==(d=Te)||d.delete(n));return u||n}function an(e){return nt(new sn,e)}var sn=class extends dt{},cn=class extends dt{};function ln(e){return Ye(new un,1,ve(e),0)}var un=class extends dt{},dn=class extends dt{},pn=class extends dt{},fn=class extends dt{},hn=class extends dt{getMeetingInfo(){return lt(this,fn,3,gn)}getMeetPlatformInfo(){return lt(this,pn,4,gn)}},gn=[2,3,4,5],mn=class extends dt{},yn=[1,4,5,6,7,8,9,10,11,12,13,14,15,16,17],vn=class extends dt{},wn=class extends dt{},bn=new Map([[2,"MAIN_STAGE"],[1,"SIDE_PANEL"]]),kn=new Map([[0,"UNKNOWN"],[1,"OPEN_ADDON"],[2,"START_ACTIVITY"],[3,"JOIN_ACTIVITY"]]);function En(e){e&&"function"==typeof e.dispose&&e.dispose()}function An(){this.s=this.s,this.g=this.g}function Sn(e,t){e.s?t():(e.g||(e.g=[]),e.g.push(t))}function Tn({J:e,R:t}){if(null===e)throw new At(Lt("activityStartingState"));if(t||void 0!==e){if("object"!=typeof e)throw new At(Gt("activityStartingState",typeof e,"object"+(t?"":" | undefined")));if(void 0!==e.mainStageUrl&&"string"!=typeof e.mainStageUrl)throw new At(Gt("mainStageUrl",typeof e.mainStageUrl,"string | undefined"));if(void 0!==e.sidePanelUrl&&"string"!=typeof e.sidePanelUrl)throw new At(Gt("sidePanelUrl",typeof e.sidePanelUrl,"string | undefined"));if(void 0!==e.additionalData&&"string"!=typeof e.additionalData)throw new At(Gt("additionalData",typeof e.additionalData,"string | undefined"));if(Object.keys(e).length!==+!!e.mainStageUrl+ +!!e.sidePanelUrl+ +!!e.additionalData)throw new At(_t);if(0===Object.keys(e).length)throw new At(Ot)}}function In(e){const t=[];return t.push(nn(tn(en(2),e.mainStageUrl),e.additionalData)),t.push(nn(tn(en(1),e.sidePanelUrl),e.additionalData)),t}An.prototype.s=!1,An.prototype.dispose=function(){this.s||(this.s=!0,this.G())},An.prototype[Symbol.dispose]=function(){this.dispose()},An.prototype.G=function(){if(this.g)for(;this.g.length;)this.g.shift()()};var Pn=class extends An{constructor(e){super(),this.context=e,this.h={},Mr(this.context.g.U,e=>{if(7===Ve(e.content,yn)){const n=this.h.frameToFrameMessage;if(e=lt(e.content,dn,7,yn),n&&e){var t=ct(e,1);if(void 0===(t=bn.get(t)))throw Error("Unknown frame type.");n({originator:t,payload:st(e,2)})}}})}async getMeetingInfo(){const e=await Vr(this.context.g,ln(2));return{meetingId:st(e.getMeetingInfo(),1),meetingCode:st(e.getMeetingInfo(),2)}}async getFrameOpenReason(){let e;const t=null!=(e=this.context.h.ca)?e:0;let n;return null!=(n=kn.get(t))?n:"UNKNOWN"}async getActivityStartingState(){var e=lt(await Vr(this.context.g,ln(1)),sn,2,gn);const t=null==e?void 0:on(e).find(e=>2===e.getFrameType());return e=null==e?void 0:on(e).find(e=>1===e.getFrameType()),{mainStageUrl:(null==t?void 0:st(t,2))||void 0,sidePanelUrl:(null==e?void 0:st(e,2))||void 0,additionalData:(null==e?void 0:st(e,3))||void 0}}async setActivityStartingState(e){Tn({J:e,R:!0});var t=In(e);e=Hr;var n=this.context.g,r=new vn;r=et(r,1,t=an(t)),await e(n,r)}on(e,t){this.h[e]=t}async getMeetPlatformInfo(){return{isMeetHardware:it(ge(De((await Vr(this.context.g,ln(3))).getMeetPlatformInfo(),1)),!1)}}async closeAddon(){await async function(e){var t=Qr,n=new Dn,r=new Un;n=tt(n,11,Fn,r),await t(e,Gr(n))}(this.context.g)}async startActivity(e){Tn({J:e,R:!1});const t=new wn;e&&et(t,1,e=an(e=In(e))),await async function(e,t){var n=Qr;t=tt(new Dn,14,Fn,t),await n(e,Gr(t))}(this.context.g,t)}async endActivity(e){var t=Xr,n=this.context.g;e=Ye(new cn,1,ve("aab61ee0-51b4-475d-aa4d-849f2498640d"===e?999:0),0),await t(n,e)}},xn=ft(class extends dt{getFrameOpenReason(){return ct(this,5)}});function Cn(){var e=window.location.href,t=window.location.href,n=new URL(t).searchParams.get("meet_sdk");if(n?t=xn(atob(n)):(Zt("meet_sdk",t),t=void 0),(n=st(t,1))||Zt("meet_addon_frame_type",e),2!==(n=Number(n))&&1!==n)throw new At(Ct);const r=st(t,2);r||Zt("meet_control_channel_name",e);const o=st(t,4);var i;return o||Zt("addon_cloud_project_number",e),{ca:e=null!=(i=t.getFrameOpenReason())?i:0,frameType:n,ba:r,cloudProjectNumber:o,S:i=st(t,3)||"https://meet.google.com"}}var Un=class extends dt{},Mn=class extends dt{},jn=class extends dt{},On=[1,2],_n=class extends dt{},Nn=class extends dt{},Rn=class extends dt{},Ln=class extends dt{},Gn=class extends dt{},zn=class extends dt{setAddonStartingState(e){return et(this,1,e)}},Bn=class extends dt{},Dn=class extends dt{},Fn=[1,2,5,6,7,8,9,10,11,13,14,15,16],Kn=class extends dt{},Wn=ft(Kn),$n=[1,2];class qn{constructor(e,t){this.data=e,this.channel=t}}var Jn=Promise;function Yn(e){const t=new MessageChannel;return Xn(t.port1,e),t}function Vn(e,t){return Xn(e,t),new Hn(e)}class Hn{constructor(e){this.g=e}send(e,t,n=[]){t=Yn(t),this.g.postMessage(e,[t.port2].concat(n))}C(e,t){return new Jn(n=>{this.send(e,n,t)})}}function Xn(e,t){t&&(e.onmessage=e=>{var n=e.data;e=Vn(e.ports[0]),t(new qn(n,e))})}var Qn="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function Zn(e,t){e.l(t),e.h<100&&(e.h++,t.next=e.g,e.g=t)}class er{constructor(e,t){this.j=e,this.l=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.j(),e}}function tr(){var e=ar;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var nr=new er(()=>new rr,e=>e.reset());class rr{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let or,ir=!1,ar=new class{constructor(){this.h=this.g=null}add(e,t){const n=nr.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},sr=(e,t)=>{or||cr(),ir||(or(),ir=!0),ar.add(e,t)},cr=()=>{const e=Promise.resolve(void 0);or=()=>{e.then(lr)}};function lr(){let e;for(;e=tr();){try{e.h.call(e.g)}catch(e){s(e)}Zn(nr,e)}ir=!1}function ur(){}function dr(e){if(this.g=0,this.T=void 0,this.l=this.h=this.j=null,this.v=this.B=!1,e!=ur)try{const t=this;e.call(void 0,function(e){vr(t,2,e)},function(e){vr(t,3,e)})}catch(e){vr(this,3,e)}}function pr(){this.next=this.context=this.h=this.l=this.g=null,this.j=!1}pr.prototype.reset=function(){this.context=this.h=this.l=this.g=null,this.j=!1};var fr=new er(function(){return new pr},function(e){e.reset()});function hr(e,t,n){const r=fr.get();return r.l=e,r.h=t,r.context=n,r}function gr(e,t){(t=hr(t=Qn(t),t)).j=!0,yr(e,t)}function mr(e,t){if(0==e.g)if(e.j){var n=e.j;if(n.h){var r=0,o=null,i=null;for(let t=n.h;t&&(t.j||(r++,t.g==e&&(o=t),!(o&&r>1)));t=t.next)o||(i=t);o&&(0==n.g&&1==r?mr(n,t):(i?((r=i).next==n.l&&(n.l=r),r.next=r.next.next):br(n),kr(n,o,3,t)))}e.j=null}else vr(e,3,t)}function yr(e,t){e.h||2!=e.g&&3!=e.g||wr(e),e.l?e.l.next=t:e.h=t,e.l=t}function vr(e,t,n){if(0==e.g){e===n&&(t=3,n=new TypeError("Promise cannot resolve to itself")),e.g=1;e:{var r=n,o=e.ma,i=e.na;if(r instanceof dr){yr(r,hr(o||ur,i||null,e));var a=!0}else{if(r)try{var s=!!r.$goog_Thenable}catch(e){s=!1}else s=!1;if(s)r.then(o,i,e),a=!0;else{if("object"==(s=typeof r)&&null!=r||"function"==s)try{const t=r.then;if("function"==typeof t){!function(e,t,n,r,o){function i(e){a||(a=!0,r.call(o,e))}let a=!1;try{t.call(e,function(e){a||(a=!0,n.call(o,e))},i)}catch(e){i(e)}}(r,t,o,i,e),a=!0;break e}}catch(t){i.call(e,t),a=!0;break e}a=!1}}}a||(e.T=n,e.g=t,e.j=null,wr(e),3!=t||n instanceof Sr||function(e,t){e.v=!0,sr(function(){e.v&&Ar.call(null,t)})}(e,n))}}function wr(e){e.B||(e.B=!0,sr(e.la,e))}function br(e){let t=null;return e.h&&(t=e.h,e.h=t.next,t.next=null),e.h||(e.l=null),t}function kr(e,t,n,r){if(3==n&&t.h&&!t.j)for(;e&&e.v;e=e.j)e.v=!1;if(t.g)t.g.j=null,Er(t,n,r);else try{t.j?t.l.call(t.context):Er(t,n,r)}catch(e){Ar.call(null,e)}Zn(fr,t)}function Er(e,t,n){2==t?e.l.call(e.context,n):e.h&&e.h.call(e.context,n)}dr.prototype.then=function(e,t,n){return function(e,t,n,r){const o=hr(null,null,null);return o.g=new dr(function(e,i){o.l=t?function(n){try{const o=t.call(r,n);e(o)}catch(e){i(e)}}:e,o.h=n?function(t){try{const o=n.call(r,t);void 0===o&&t instanceof Sr?i(t):e(o)}catch(e){i(e)}}:i}),o.g.j=e,yr(e,o),o.g}(this,Qn("function"==typeof e?e:null),Qn("function"==typeof t?t:null),n)},dr.prototype.$goog_Thenable=!0,dr.prototype.cancel=function(e){if(0==this.g){const t=new Sr(e);sr(function(){mr(this,t)},this)}},dr.prototype.ma=function(e){this.g=0,vr(this,2,e)},dr.prototype.na=function(e){this.g=0,vr(this,3,e)},dr.prototype.la=function(){let e;for(;e=br(this);)kr(this,e,this.g,this.T);this.B=!1};var Ar=s;function Sr(e){a.call(this,e)}function Tr(e,t,n){this.promise=e,this.resolve=t,this.reject=n}i(Sr,a),Sr.prototype.name="cancel";let Ir=1,Pr=new WeakMap;function xr(e,t,n){var r=Ur;e.h.has(t),r(t,n)}var Cr=class extends An{constructor(){super(),this.h=new Set}signal(){const e=new jr;return this.h.add(e),Sn(this,function(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}(En,e)),e}};function Ur(e,t){return new Promise(n=>{Nr(()=>{e.L&&(e.ea=t,e.P=!0);for(const{I:n,slot:r}of e.o.values())try{r(t,{signal:e,I:n})}catch(e){s(e)}for(const n of e.A)n.resolve(t);e.A.clear(),n()})})}function Mr(e,t,n){const r=Ir++;return Nr(()=>{!function(e,t,n,r){if(!e.s)if(r){if(!r.s){const o=()=>{Nr(()=>{e.o.delete(t);const n=Pr.get(r);n&&v(n,o)})};e.o.set(t,{I:t,slot:n,F:o}),Lr(r,o)}}else e.o.set(t,{I:t,slot:n,F:()=>e.o.delete(t)})}(e,r,t,n)}),r}var jr=class extends An{constructor(){super(),this.L=!1,this.o=new Map,this.A=new Set,this.P=!1}detach(e){Nr(()=>{const t=this.o.get(e);t&&t.F()})}value(e){return this.promise(!0,e)}next(e){return this.promise(!1,e)}promise(e,t){const n=function(){let e,t;return new Tr(new dr(function(n,r){e=n,t=r}),e,t)}();return Nr(()=>{if(this.s)n.reject(new Sr("Signal initially disposed"));else if(t&&t.s)n.reject(new Sr("Owner initially disposed"));else if(e&&this.L&&this.P)n.resolve(this.ea);else if(this.A.add(n),gr(n.promise,()=>{this.A.delete(n)}),t){const e=()=>{n.reject(new Sr("Owner asynchronously disposed"))};gr(n.promise,()=>{const n=Pr.get(t);n&&v(n,e)}),Lr(t,e)}}),n.promise}G(){super.G(),Nr(()=>{for(const{F:e}of this.o.values())e();this.o.clear();for(const e of this.A)e.reject(new Sr("Signal asynchronously disposed"));this.A.clear()})}};const Or=[];let _r=!1;function Nr(e){Or.push(e),async function(){if(!_r)try{_r=!0;let e=Rr(0);for(;e<Or.length;)await Promise.resolve(),e=Rr(e)}catch(e){s(e)}finally{Or.length=0,_r=!1}}()}function Rr(e){const t=e+100;for(;e<t&&e<Or.length;)try{Or[e++]()}catch(e){s(e)}return e}function Lr(e,t){if(e.s)t();else{var n=Pr.get(e);if(n)n.push(t);else{const n=[t];Pr.set(e,n),Sn(e,()=>{for(const e of[...n])e();Pr.delete(e)})}}}function Gr(e){return{content:ut(e=tt(new Kn,1,$n,e))}}const zr=new Cr;function Br(e,t){const n=zr.signal();return{channel:Vn(e,e=>{const r=t(e.data);xr(zr,n,{content:r,ka:e})}),signal:n}}let Dr;var Fr=class extends dt{},Kr=class extends dt{},Wr=class extends dt{h(){return lt(this,Fr,2,$r)}g(){return qe(this,Fr,2,$r)}j(){return lt(this,Kr,3,$r)}l(){return qe(this,Kr,3,$r)}},$r=[2,3],qr=ft(class extends dt{}),Jr=ft(class extends dt{}),Yr=[1,2];async function Vr(e,t){var n=Qr;let r;return t=tt(new Dn,9,Fn,t),e=await n(e,Gr(t)),null==(r=lt(Wn(e.data.content),mn,2,$n))?void 0:lt(r,hn,9,yn)}async function Hr(e,t){var n=Qr;t=tt(new Dn,8,Fn,t),await n(e,Gr(t))}async function Xr(e,t){var n=Qr;t=tt(new Dn,15,Fn,t),await n(e,Gr(t))}async function Qr(e,t){let n;(e=await e.channel.C(t))||Qt(St,`Falsy response received from the message channel. ${JSON.stringify(e)}`),(t=e.data)||Qt(St,`Data field in the response from the message channel is falsy. ${JSON.stringify(t)}`),(t=t.content)||Qt(St,`Content field in the response from the message channel is falsy. ${JSON.stringify(t)}`);try{n=Wn(t)}catch(e){Qt(St,`The ControlMessage can't be deserialized. ${JSON.stringify(t)}. ${JSON.stringify(e)}`)}if((t=lt(n,mn,2,$n))||Qt(St,`MeetToAddonMessage field on ControlMessage is falsy. ${JSON.stringify(t)}`),void 0!==(null==(t=null==t?void 0:lt(t,Et,10,yn))?void 0:ct(t,1)))throw new At(function(e){switch(e){case 0:default:return St;case 1:return Mt;case 2:return jt;case 3:return zt;case 4:return Bt;case 5:return Ft;case 6:return xt;case 7:return Kt;case 8:return Wt;case 9:return $t;case 10:return Jt;case 11:return Yt;case 12:return Vt;case 13:return Ht;case 14:return Dt;case 15:return Xt}}(ct(t,1)));return e}async function Zr(e){const t=function(){var e=new jn,t=new Mn;return tt(e,1,On,t)}(),{channel:n,response:r}=await async function(e,t){var n,r=Qr;return t=tt(new Dn,1,Fn,t),e=(r=await r(e,Gr(t))).data.messagePort,n=null!=(r=null==(n=lt(Wn(r.data.content),mn,2,$n))?void 0:lt(n,bt,1,yn))?r:Ye(n=new bt,1,ve(0),0),{channel:e?Br(e,e=>Jr(e)):void 0,response:n}}(e,t);if(!n)throw new At(function(e){let t;var n=null!=(t=ct(e,1))?t:0;switch(e=function(e){switch(e){case 2:return"co";case 3:return"gd";default:return"unknown"}}(Ve(e,kt)),n){case 1:return{errorType:"InternalError",message:`Could not connect to ${e} channel. Meet did not respond with a MessagePort.`,i:"No further information is available."};case 2:return{errorType:"InternalError",message:`Could not connect to ${e}. A conflicting ${e} exists.`,i:"No further information is available."};case 3:return{errorType:"InternalError",message:`Could not connect to ${e} channel. The addon does not have permission to open a ${e}.`,i:"This method might require EAP enrollment."};case 4:return{errorType:"InternalError",message:`Could not connect to ${e} channel. The addon is not authorized for this ${e}.`,i:"No further information is available."};case 0:default:return(e=>({errorType:"InternalError",message:`Could not connect to ${e} channel. Unknown error`,i:"No further information is available."}))(e);case 5:return"co"===e?{errorType:"InternalError",message:`Could not connect to ${e} channel. The coActivity was not found.`,i:`Consider starting the ${e} only after after the startActivity promise returns.`}:{errorType:"InternalError",message:`Could not connect to ${e} channel.`,i:"No further information is available."}}}(r));return n}async function eo(e,t,n){var r=Qr,o=new Dn;t=Ye(new Rn,1,ve(t),0),n=Ye(t,2,Ae(n),""),o=tt(o,7,Fn,n),await r(e,Gr(o))}class to extends An{constructor(e,t,n){super(),this.U=e,this.channel=t,this.h=function(e){var t=new wt(100),n=Promise.resolve();return(...r)=>yt(t)?e(...r):n}(async()=>{var e=this.channel,t=e.C,n=new Dn,r=new Ln;n=tt(n,13,Fn,r),await t.call(e,Gr(n))}),e=function(){var e=Dr||(Dr=gt("[1,2,0]"));const t=(e=We(e=Be(e),4,Ae("dev-706864954"))).m,n=t[R];return 2&n?e:new e.constructor(ze(t,n,!0))}(),st(e,4),we(De(e,1)),we(De(e,2)),we(De(e,3)),n=function(e,t){return tt(e,2,Fn,t)}(new Dn,function(e,t){return Ye(e,3,Ae(t),"")}(function(e){return et(new _n,2,e)}(e),n)),this.channel.send(Gr(n)),Mr(this.U,async e=>{16===Ve(e.content,yn)&&await async function(e){await e.h()}(this)})}}let no;var ro=class{constructor(e){var t=no;this.h=e,this.g=t}delete(){throw Error("Not implemented.")}},oo=class extends dt{h(){return lt(this,Fr,2,io)}g(){return qe(this,Fr,2,io)}j(){return lt(this,Kr,3,io)}l(){return qe(this,Kr,3,io)}},io=[2,3],ao=class extends dt{},so=class extends dt{},co=class extends dt{},lo=class extends dt{h(){return lt(this,Fr,2,uo)}g(){return qe(this,Fr,2,uo)}j(){return lt(this,Kr,3,uo)}l(){return qe(this,Kr,3,uo)}},uo=[2,3],po=[5,6],fo=class extends dt{},ho=class extends dt{},go=[1,2,3],mo=class extends Error{constructor(){super("Failed to create CoActivity: Connection refused - Meet refused to begin Live Sharing")}},yo=class{constructor(e){this.config=e}start(){return null!=this.g||(this.g=setInterval(()=>{this.config.ha()},this.config.da)),this}shutdown(){clearInterval(this.g)}};function vo(){const e=new Map,t={set:(n,r)=>(e.set(n,r),t),D:()=>e};return t}function wo(e){if(e.g()){var t=(e=e.h().m)[R],n=Ke(e,t,1),r=q(n,!0);if(null!=r&&r!==n&&$e(e,t,1,r),t=null==(e=r)?T():e,e=Uint8Array,C(S),null!=(n=t.g)&&!A(n))if("string"==typeof n){b.test(n)&&(n=n.replace(b,E)),n=atob(n),r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);n=r}else n=null;return{bytes:new e((t=null==n?n:t.g=n)||0)}}}function bo(e,t){return t=Eo(t),tt(e,2,uo,t),e}function ko(e,t){return t=Eo(t),tt(e,2,io,t),e}function Eo(e){return Ye(new Fr,1,q(e.bytes,!1),T())}function Ao(e){if(e.l()){var t,n,r=st(e=e.j(),1),o=null!=(n=null==(t=Ze(e,mt,2))?void 0:at(t))?n:0;let i=(n=e.m)[R];const a=Ke(n,i,4);return null!=(t=null==a||"number"==typeof a?a:"NaN"===a||"Infinity"===a||"-Infinity"===a?Number(a):void 0)&&t!==a&&$e(n,i,4,t),{mediaId:r,mediaPlayoutPosition:o,mediaPlayoutRate:it(t,0),playbackState:Io.get(ct(e,3))}}}function So(e,t){return t=xo(t),tt(e,3,uo,t),e}function To(e,t){return t=xo(t),tt(e,3,io,t),e}const Io=vo().set(0,"INVALID").set(1,"BUFFERING").set(2,"PLAY").set(3,"PAUSE").set(4,"ENDED").D(),Po=vo().set("INVALID",0).set("BUFFERING",1).set("PLAY",2).set("PAUSE",3).set("ENDED",4).D();function xo(e){var t=new Kr;t=Ye(t,1,Ae(e.mediaId),"");var n=e.mediaPlayoutRate;if(null!=n&&"number"!=typeof n)throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);return t=Ye(t,4,n,0),n=Ye(n=new mt,1,be(e.mediaPlayoutPosition),"0"),Ye(t=et(t,2,n),3,ve(e=Po.get(e.playbackState)),0)}function Co(e,t){return t=Ye(new so,1,ve(t.u),0),tt(e,6,po,t),e}function Uo(e){var t=new ao;return tt(e,5,po,t),e}const Mo=vo().set("co-doing",1).set("co-watching",2).D();async function jo(e,t,n){var r=t.C,o=new ho,i=new fo;let a;if(i=Ye(i,1,Ae(e.activityTitle),""),i=Ye(i,2,ve(Mo.get(e.K)),0),o=tt(o,3,go,i),null!=(a=it(ge(De(r=await r.call(t,o,qr),1)),!1))&&a)return new No(e,t,n,Ze(r,Wr,2));throw new mo}function Oo(e,t){const n=e.config.N(t);n&&!e.config.M(e.g,n)&&(e.g=n,e.j=at(t),e.v(e.g))}function _o(e,t){const{state:n,fa:r,context:o}=t(e.g);e.g=n,e.notify(e.g,o,r)}class No{constructor(e,t,n,r){this.l=e,this.h=t,this.config=n,this.v=function(e){var t=new wt(500);let n,r=0;return(...o)=>{yt(t)?e(...o):(n=()=>{e(...o)},r||(r=setTimeout(()=>{let e;r=0,null==(e=n)||e()},function(e){const t=e.g;return(e=vt(e,e.index))>=t?0:t-e}(t))))}}(e=>{this.l.O(e)}),function(e,t){const n=Mr(e.signal,e=>{t(e)});e.o.push(n)}(this.h,e=>{const t=Ve(e,Yr);switch(t){case 1:Oo(this,lt(e,Wr,1,Yr));break;case 2:case 0:console.warn(`IllegalMessage: ${t} - Unhandled message - Please raise a bug with the MeetJS team`)}}),this.B=new yo({da:1e3,ha:()=>{var e,t,n=null==(t=(e=this.l).ja)?void 0:t.call(e);if(null!==this.g){this.g={...this.g,...n},e=new ho,n=(t=this.config).W;var r=new oo;r=Ye(r,1,be(this.j),"0"),t=n.call(t,r,this.g),e=tt(e,1,go,t),this.h.send(e)}}}).start(),this.g=null,this.j=0,r&&Oo(this,r)}disconnect(){this.h.shutdown(),this.B.shutdown()}notify(e,t,n){var r=n?function({activityTitle:e}){return We(new co,4,Ae(e))}(n):void 0,o=(n=this.config).X,i=new lo;r=et(i=Ye(i,1,be(this.j),"0"),4,r),e=o.call(n,r,e),e=this.config.V(e,t),n=(t=this.h).send,e=tt(o=new ho,2,go,e),n.call(t,e)}}var Ro=class{constructor(e){this.g=e}broadcastStateUpdate(e){_o(this.g,()=>({state:e,context:{}}))}disconnect(){this.g.disconnect()}};function Lo(e,t){return null!=e&&null!=t&&e.bytes.length===t.bytes.length&&e.bytes.every((e,n)=>e===t.bytes[n])}var Go=class{constructor(e){this.g=e}notifySwitchedToMedia(e,t,n){_o(this.g,()=>({state:{mediaId:t,mediaPlayoutRate:1,mediaPlayoutPosition:n,playbackState:"PLAY"},fa:{activityTitle:e},context:{u:1}}))}notifyPauseState(e,t){_o(this.g,n=>{if(null==n)throw Error("Invalid before coWatchingState");return{state:{...n,playbackState:e?"PAUSE":"PLAY",mediaPlayoutPosition:t},context:{u:3}}})}notifySeekToTimestamp(e){_o(this.g,t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutPosition:e},context:{u:2}}})}notifyPlayoutRate(e){_o(this.g,t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutRate:e},context:{u:4}}})}notifyBuffering(e){_o(this.g,t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutPosition:e,playbackState:"BUFFERING"},context:{u:3}}})}notifyReady(e){_o(this.g,t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutPosition:e},context:{u:3}}})}disconnect(){this.g.disconnect()}};function zo(e,t){if(null==e||null==t)return!1;const n="PLAY"===e.playbackState?3*Math.max(e.mediaPlayoutRate,1):0,r=Math.abs(e.mediaPlayoutPosition-t.mediaPlayoutPosition);return e.mediaId===t.mediaId&&e.mediaPlayoutRate===t.mediaPlayoutRate&&r<=n&&e.playbackState===t.playbackState}var Bo=class{constructor(e,t){this.channel=e,this.signal=t,this.o=[]}send(e){this.channel.send(ut(e))}async C(e,t){return t((e=await this.channel.C(ut(e))).data)}shutdown(){this.o.forEach(e=>{this.signal.detach(e)})}};async function Do(e){const t=new Cr,n=t.signal();!function(e,t,n,r=e=>e){Mr(n,n=>{xr(e,t,r(n))},e)}(t,n,(e=await e).signal,e=>e.content);const{ia:r,ga:o}=function(e,t){var n=Fo;const r=e.signal(),o=e.signal();return Mr(t,t=>{const i=n(t)?r:o;xr(e,i,t)},e),{ia:r,ga:o}}(t,n);return{Z:new Bo(e.channel,r),aa:new Bo(e.channel,o)}}function Fo(e){if(1!==Ve(e,Yr))throw Error("CA Message arrived with no known content message set");return(e=lt(e,Wr,1,Yr)).g()}var Ko=class extends Pn{async notifySidePanel(e){await eo(this.context.g,1,e)}async unloadSidePanel(){await async function(e){var t=Qr,n=new Dn,r=new Bn;n=tt(n,5,Fn,r),await t(e,Gr(n))}(this.context.g)}async loadSidePanel(){await async function(e){var t=Qr,n=new Dn,r=new Nn;n=tt(n,6,Fn,r),await t(e,Gr(n))}(this.context.g)}},Wo=class extends Pn{async setAddonStartingState(e){if(null===e)throw new At(Lt("addonStartingState"));if("object"!=typeof e)throw new At(Gt("addonStartingState",typeof e,"object | undefined"));if(void 0!==e.sidePanelUrl&&"string"!=typeof e.sidePanelUrl)throw new At(Gt("sidePanelUrl",typeof e.sidePanelUrl,"string | undefined"));if(void 0!==e.additionalData&&"string"!=typeof e.additionalData)throw new At(Gt("additionalData",typeof e.additionalData,"string | undefined"));if(Object.keys(e).length!==+!!e.sidePanelUrl+ +!!e.additionalData)throw new At(Rt);if(0===Object.keys(e).length)throw new At(Nt);var t=[];t.push(nn(tn(en(1),e.sidePanelUrl),e.additionalData)),e=this.context.g;var n=new zn,r=n.setAddonStartingState;t=nt(new Gn,t),await async function(e,t){var n=Qr;t=tt(new Dn,16,Fn,t),await n(e,Gr(t))}(e,r.call(n,t))}},$o=class extends Pn{async notifyMainStage(e){await eo(this.context.g,2,e)}},qo=class{constructor(e){e=e.cloudProjectNumber;const t=Cn();if(t.cloudProjectNumber!==e)throw new At(Ut);const n=t.S,r=t.ba;let o;no=null!=(o=no)?o:function(e,t,n){const r=new Cr,o=r.signal();return e=(({destination:e,origin:t,ra:n,Y:r="ZNWN1d",onMessage:o})=>{if("*"===t)throw Error("Sending to wildcard origin not allowed.");const i=Yn(o);return e.postMessage(n?{n:r,t:n}:r,t,[i.port2]),Vn(i.port1,o)})({destination:window.parent,origin:t,Y:e,onMessage:e=>{const t=Wn(e.data.content);2===Ve(t,$n)&&xr(r,o,{content:lt(t,mn,2,$n),ka:e,messagePort:e.data.messagePort})}}),new to(o,e,n)}(r,n,e),this.g=new ro(t)}async createMainStageClient(){var e=this.g;if(2!==e.h.frameType)throw new At(It);return await Promise.resolve(new Ko(e))}async createSidePanelClient(){var e=this.g;if(1!==e.h.frameType)throw new At(Pt);return await Promise.resolve(new $o(e))}async createCoWatchingClient(e){return await async function(e,t){if(({aa:e}=await Do(Zr(e.g))),t=await async function(e,t){if(t)return e=await jo({activityTitle:t.activityTitle,K:"co-watching",ja:()=>t.onCoWatchingStateQuery(),O:e=>{t.onCoWatchingStateChanged(e)}},e,{X:So,W:To,V:Co,N:Ao,M:zo}),new Go(e)}(e,t),!t)throw Error("Failed to create co-watching session");return t}(this.g,e)}async createCoDoingClient(e){return await async function(e,t){if(({Z:e}=await Do(Zr(e.g))),t=await async function(e,t){if(t)return e=await jo({activityTitle:t.activityTitle,K:"co-doing",O:e=>{t.onCoDoingStateChanged(e)}},e,{X:bo,W:ko,V:Uo,N:wo,M:Lo}),new Ro(e)}(e,t),!t)throw Error("Failed to create co-doing session");return t}(this.g,e)}async createRoomsStandaloneClient(){var e=this.g;if(2!==e.h.frameType)throw new At(It);return await Promise.resolve(new Wo(e))}};let Jo=null;var Yo,Vo={addon:{getFrameType:function(){e:{var e=Cn().frameType;switch(e){case 2:e="MAIN_STAGE";break e;case 1:e="SIDE_PANEL";break e;default:throw Error(`Unknown frame type: ${e}`)}}return e},createAddonSession:async function(e){if(null===e)throw new At(Lt("config"));if("object"!=typeof e)throw new At(Gt("config",typeof e,"object"));if("string"!=typeof e.cloudProjectNumber)throw new At(Gt("cloudProjectNumber",typeof e.cloudProjectNumber,"string"));if(Jo&&"integration.test.google.com"!==Cn().S)throw new At(qt);return Jo=new qo(e)}}},Ho=["meet"],Xo=o;Ho[0]in Xo||void 0===Xo.execScript||Xo.execScript("var "+Ho[0]);for(;Ho.length&&(Yo=Ho.shift());)Ho.length||void 0===Vo?Xo=Xo[Yo]&&Xo[Yo]!==Object.prototype[Yo]?Xo[Yo]:Xo[Yo]={}:Xo[Yo]=Vo}).apply(e);const t=e.meet;function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(){var e,t,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function s(n,r,i,a){var s=r&&r.prototype instanceof l?r:l,u=Object.create(s.prototype);return o(u,"_invoke",function(n,r,o){var i,a,s,l=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return i=t,a=0,s=e,p.n=n,c}};function f(n,r){for(a=n,s=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,i=u[t],f=p.p,h=i[2];n>3?(o=h===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=f&&((o=n<2&&f<i[1])?(a=0,p.v=r,p.n=i[1]):f<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,a=0))}if(o||n>1)return c;throw d=!0,r}return function(o,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,h),a=u,s=h;(t=a<2?e:s)||!d;){i||(a?a<3?(a>1&&(p.n=-1),f(a,s)):p.n=s:p.v=s);try{if(l=2,i){if(a||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((t=(d=p.n<0)?s:n.call(r,p))!==c)break}catch(t){i=e,a=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,i,a),!0),u}var c={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var p=[][i]?t(t([][i]())):(o(t={},i,function(){return this}),t),f=d.prototype=l.prototype=Object.create(p);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=d,o(f,"constructor",d),o(d,"constructor",u),u.displayName="GeneratorFunction",o(d,a,"GeneratorFunction"),o(f),o(f,a,"Generator"),o(f,i,function(){return this}),o(f,"toString",function(){return"[object Generator]"}),(r=function(){return{w:s,m:h}})()}function o(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}o=function(e,t,n,r){function a(t,n){o(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},o(e,t,n,r)}function i(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,c,"next",e)}function c(e){i(a,r,o,s,c,"throw",e)}s(void 0)})}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var l=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.credentials=t,this.participants=new Map,this.isConnected=!1,this.meetingId=null,this.meetSession=null,this.eventsBackendUrl=(null==t?void 0:t.eventsBackendUrl)||null,this.developerPreviewEnabled=!0,this.onParticipantJoined=null,this.onParticipantLeft=null,this.onAudioData=null,this.onError=null},t=[{key:"initializeAuth",value:(p=a(r().m(function e(){var t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("Initializing Google Meet Add-ons SDK..."),this.meetSession=this.credentials.meetSession,this.meetSession){e.n=1;break}throw new Error("Meet session not available");case 1:return console.log("✅ Google Meet Add-ons SDK initialized"),e.a(2,!0);case 2:throw e.p=2,t=e.v,console.error("❌ Authentication failed:",t),t;case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return p.apply(this,arguments)})},{key:"getCurrentParticipants",value:(d=a(r().m(function e(){var t,n;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.meetSession){e.n=1;break}throw new Error("Meet session not initialized");case 1:return e.n=2,this.fetchParticipantsViaWorkspaceEvents();case 2:if(!((t=e.v)&&t.length>0)){e.n=3;break}return e.a(2,t);case 3:return console.log("⚠️ Meet Add-ons SDK has limited participant access"),console.log("📋 No participants available via API"),e.a(2,[]);case 4:return e.p=4,n=e.v,console.error("Error getting current participants:",n),e.a(2,[])}},e,this,[[0,4]])})),function(){return d.apply(this,arguments)})},{key:"fetchParticipantsViaWorkspaceEvents",value:(u=a(r().m(function e(){var t,n,o,i,a,s,c;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.eventsBackendUrl){e.n=1;break}return e.a(2,[]);case 1:if(!this.meetSession||!this.meetSession.getMeetingInfo){e.n=3;break}return e.n=2,this.meetSession.getMeetingInfo();case 2:s=e.v,e.n=4;break;case 3:s=null;case 4:if(n=(null==(t=s)?void 0:t.meetingId)||(null==t?void 0:t.id)||this.meetingId){e.n=5;break}return e.a(2,[]);case 5:return o="".concat(this.eventsBackendUrl.replace(/\/$/,""),"/participants?meetingId=").concat(encodeURIComponent(n)),e.n=6,fetch(o,{method:"GET",credentials:"omit"});case 6:if((i=e.v).ok){e.n=7;break}return console.warn("Workspace Events backend returned non-OK status:",i.status),e.a(2,[]);case 7:return e.n=8,i.json();case 8:if(a=e.v,Array.isArray(a)){e.n=9;break}return e.a(2,[]);case 9:return e.a(2,a.map(function(e){return{id:e.id||e.participantId||e.name||"participant_".concat(Math.random().toString(36).slice(2)),name:e.name||e.displayName||"Unknown Participant",email:e.email||"",isLocal:!!e.isLocal,isSpeaking:!1,avatar:"👤",transcript:"",lastSpoke:null,joinedAt:(new Date).toISOString()}}));case 10:return e.p=10,c=e.v,console.warn("Failed to fetch participants via Workspace Events backend:",c),e.a(2,[])}},e,this,[[0,10]])})),function(){return u.apply(this,arguments)})},{key:"getMeetingInfo",value:(l=a(r().m(function e(){var t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.meetSession){e.n=1;break}throw new Error("Meet session not initialized");case 1:return console.log("⚠️ Meet Add-ons SDK has limited meeting info access"),e.a(2,{meetingId:this.meetingId||null,title:"Google Meet Session",startTime:(new Date).toISOString(),participantCount:this.participants.size});case 2:return e.p=2,t=e.v,console.error("Error getting meeting info:",t),e.a(2,{})}},e,this,[[0,2]])})),function(){return l.apply(this,arguments)})},{key:"startParticipantTracking",value:(c=a(r().m(function e(){var t,n,o=this;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Starting participant tracking with Meet Add-ons SDK..."),e.n=1,this.getCurrentParticipants();case 1:(t=e.v).length>0?(console.log("Found participants:",t.length),t.forEach(function(e){o.handleParticipantJoined(e)})):console.log("No participants found via API"),console.log("✅ Participant tracking started"),e.n=3;break;case 2:throw e.p=2,n=e.v,console.error("Error starting participant tracking:",n),n;case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return c.apply(this,arguments)})},{key:"handleParticipantJoined",value:function(e){try{var t={id:e.id||e.participantId||"participant_".concat(Date.now()),name:e.name||e.displayName||"Unknown Participant",email:e.email||"",isLocal:e.isLocal||!1,isSpeaking:e.isSpeaking||!1,avatar:e.avatar||"👤",transcript:"",lastSpoke:null,joinedAt:(new Date).toISOString()};this.participants.set(t.id,t),console.log("Participant joined:",t),this.onParticipantJoined&&this.onParticipantJoined(t)}catch(e){console.error("Error handling participant joined:",e)}}},{key:"handleParticipantLeft",value:function(e){try{var t=this.participants.get(e);t&&(this.participants.delete(e),console.log("Participant left:",t),this.onParticipantLeft&&this.onParticipantLeft(t))}catch(e){console.error("Error handling participant left:",e)}}},{key:"getAllParticipants",value:function(){return Array.from(this.participants.values())}},{key:"getParticipant",value:function(e){return this.participants.get(e)}},{key:"updateParticipantSpeaking",value:function(e,t){var n=this.participants.get(e);n&&(n.isSpeaking=t,t&&(n.lastSpoke=(new Date).toISOString()),this.onParticipantJoined&&this.onParticipantJoined(n))}},{key:"updateParticipantTranscript",value:function(e,t){var n=this.participants.get(e);n&&(n.transcript=t,n.lastSpoke=(new Date).toISOString(),this.onParticipantJoined&&this.onParticipantJoined(n))}},{key:"startAudioMonitoring",value:(i=a(r().m(function e(){var t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("Starting audio monitoring..."),this.developerPreviewEnabled){e.n=1;break}return console.log("⚠️ Developer Preview not enabled. Skipping Meet Media API audio."),e.a(2,!0);case 1:return console.log("📋 Meet Media API audio capture requires a separate client (WebRTC) joining the call."),console.log("📋 Implement a backend or native client to join and forward audio to this add-on."),e.a(2,!0);case 2:throw e.p=2,t=e.v,console.error("Error starting audio monitoring:",t),t;case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return i.apply(this,arguments)})},{key:"stopAudioMonitoring",value:(o=a(r().m(function e(){var t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Stopping audio monitoring..."),e.a(2,!0);case 1:throw e.p=1,t=e.v,console.error("Error stopping audio monitoring:",t),t;case 2:return e.a(2)}},e,null,[[0,1]])})),function(){return o.apply(this,arguments)})},{key:"leaveMeeting",value:(n=a(r().m(function e(){var t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Leaving meeting..."),this.participants.clear(),this.isConnected=!1,console.log("✅ Left meeting successfully"),e.a(2,!0);case 1:throw e.p=1,t=e.v,console.error("Error leaving meeting:",t),t;case 2:return e.a(2)}},e,this,[[0,1]])})),function(){return n.apply(this,arguments)})}],t&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,o,i,c,l,u,d,p}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=f(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return h(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function g(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return m(l,"_invoke",function(n,r,o){var i,s,c,l=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,i=u[t],f=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=f&&((o=n<2&&f<i[1])?(s=0,p.v=r,p.n=i[1]):f<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,h),s=u,c=h;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(p.n=-1),f(s,c)):p.n=c:p.v=c);try{if(l=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?c:n.call(r,p))!==a)break}catch(t){i=e,s=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,i),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(m(t={},r,function(){return this}),t),d=l.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,m(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,m(d,"constructor",l),m(l,"constructor",c),c.displayName="GeneratorFunction",m(l,o,"GeneratorFunction"),m(d),m(d,o,"Generator"),m(d,r,function(){return this}),m(d,"toString",function(){return"[object Generator]"}),(g=function(){return{w:i,m:p}})()}function m(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}m=function(e,t,n,r){function i(t,n){m(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},m(e,t,n,r)}function y(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function v(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){y(i,r,o,a,s,"next",e)}function s(e){y(i,r,o,a,s,"throw",e)}a(void 0)})}}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var k=function(){return e=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.apiKey=t,this.credentials=n,this.sidePanelClient=r.sidePanelClient||null,this.mainStageClient=r.mainStageClient||null,this.botId=null,this.meetingUrl=null,this.isActive=!1,this.pollInterval=null,this.transcriptEntries=[],this.useWebhooks=!1,this.webhookUrl=null,this.webhookPollInterval=null,this.lastWebhookTimestamp=0,this.onTranscriptUpdate=null,this.onBotStatusChange=null,this.onError=null,this.baseUrl="https://app.attendee.dev/api/v1",this.proxyServerUrl=(null==n?void 0:n.proxyServerUrl)||(null==n?void 0:n.proxyUrl)||"http://localhost:8787",this.useProxy="undefined"!=typeof window,console.log("[Attendee] Proxy config initialized:",{useProxy:this.useProxy,proxyServerUrl:this.proxyServerUrl,isBrowser:"undefined"!=typeof window,location:"undefined"!=typeof window?window.location.href:"N/A"}),this.pollIntervalMs=2e3,this.webhookPollIntervalMs=500},t=[{key:"promptForMeetingUrl",value:(f=v(g().m(function e(){return g().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e){if("undefined"!=typeof window){try{var t=prompt('Could not automatically detect the meeting URL.\n\nPlease enter the Google Meet code (e.g., "abc-defg-hij") or full URL:');if(t){var n=t.trim();if(n.includes("http")||(n="https://meet.google.com/".concat(n.replace(/^\/+|\/+$/g,""))),n.includes("meet.google.com"))return console.log("✅ Using manually entered meeting URL:",n),void e(n)}}catch(e){console.warn("Could not show prompt:",e)}e(null)}else e(null)}))},e)})),function(){return f.apply(this,arguments)})},{key:"requestMeetingCodeFromParent",value:(u=v(g().m(function e(){return g().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e){var t=function(n){n.data&&"MEETING_CODE_RESPONSE"===n.data.type&&(window.removeEventListener("message",t),e(n.data.meetingCode||null))};window.addEventListener("message",t);try{window.parent&&window.parent!==window?(window.parent.postMessage({type:"REQUEST_MEETING_CODE"},"*"),setTimeout(function(){window.removeEventListener("message",t),e(null)},1e3)):e(null)}catch(n){console.warn("Error requesting meeting code from parent:",n),window.removeEventListener("message",t),e(null)}}))},e)})),function(){return u.apply(this,arguments)})},{key:"getMeetingUrl",value:(l=v(g().m(function e(){var t,n,r,o,i,a,s,c,l,u,f,h,m,y,v,w,b,k,E,A,S,T,I,P,x,C,U,M,j,O,_,N,R,L,G,z,B,D,F,K,W,$,q,J,Y,V,H,X,Q,Z,ee,te,ne,re,oe,ie,ae,se,ce,le,ue,de,pe,fe,he,ge,me,ye,ve,we,be,ke,Ee,Ae,Se,Te,Ie,Pe,xe,Ce,Ue,Me;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("Attempting to detect meeting URL..."),e.p=1,n=new URLSearchParams(window.location.search),!(r=n.get("origin"))){e.n=3;break}if(o=decodeURIComponent(r),console.log("Found origin parameter:",o),!o.includes("meet.google.com")){e.n=3;break}return e.n=2,this.requestMeetingCodeFromParent();case 2:if(!(i=e.v)){e.n=3;break}return a="https://meet.google.com/".concat(i),console.log("✅ Found meeting URL from parent communication:",a),e.a(2,a);case 3:if(!(s=n.get("meet_sdk"))){e.n=12;break}if(e.p=4,c=atob(s),l=JSON.parse(c),console.log("Decoded meet_sdk:",l),!(l&&Array.isArray(l)&&l.length>1)){e.n=10;break}if(!(u=l.find(function(e){return"string"==typeof e&&e.includes("meet.google.com")}))){e.n=10;break}if("https://meet.google.com"!==u&&!u.endsWith("meet.google.com/")){e.n=9;break}if(console.log("⚠️ Found base URL from meet_sdk, trying to extract meeting code from parent..."),e.p=5,!window.parent||window.parent===window){e.n=6;break}if(f=window.parent.location.href,!(h=f.match(/meet\.google\.com\/([a-z0-9-]+)/i))||!h[1]){e.n=6;break}return m="https://meet.google.com/".concat(h[1]),console.log("✅ Extracted meeting URL from parent window:",m),e.a(2,m);case 6:e.n=8;break;case 7:e.p=7,be=e.v,console.warn("Could not access parent window (cross-origin):",be.message);case 8:console.log("⚠️ Could not extract meeting code, continuing to other detection methods"),e.n=10;break;case 9:return console.log("✅ Found meeting URL from meet_sdk:",u),e.a(2,u);case 10:e.n=12;break;case 11:e.p=11,ke=e.v,console.warn("Could not decode meet_sdk parameter:",ke);case 12:e.n=14;break;case 13:e.p=13,Ee=e.v,console.warn("Error extracting from URL parameters:",Ee);case 14:if(!this.sidePanelClient){e.n=25;break}return e.p=15,e.n=16,null===(y=(v=this.sidePanelClient).getMeetingInfo)||void 0===y?void 0:y.call(v);case 16:if(w=e.v,console.log("📋 Meeting info from sidePanelClient:",JSON.stringify(w,null,2)),null==w||!w.meetingUrl){e.n=17;break}return console.log("✅ Found meeting URL from sidePanelClient:",w.meetingUrl),e.a(2,w.meetingUrl);case 17:if(null==w||!w.meetingCode){e.n=18;break}return b="https://meet.google.com/".concat(w.meetingCode),console.log("✅ Constructed meeting URL from meetingCode:",b),e.a(2,b);case 18:if(null==w||!w.meetingId){e.n=19;break}return k="https://meet.google.com/".concat(w.meetingId),console.log("✅ Constructed meeting URL from meetingId:",k),e.a(2,k);case 19:E=0,A=Object.entries(w||{});case 20:if(!(E<A.length)){e.n=23;break}if(S=p(A[E],2),T=S[0],"string"!=typeof(I=S[1])){e.n=22;break}if(!I.includes("meet.google.com")){e.n=21;break}return console.log("✅ Found meeting URL in field ".concat(T,":"),I),e.a(2,I);case 21:if(!/^[a-z]{3}-[a-z]{4}-[a-z]{3}$/i.test(I)){e.n=22;break}return P="https://meet.google.com/".concat(I),console.log("✅ Found meeting code in field ".concat(T,":"),P),e.a(2,P);case 22:E++,e.n=20;break;case 23:e.n=25;break;case 24:e.p=24,Ae=e.v,console.warn("Could not get meeting URL from sidePanelClient:",Ae);case 25:if(!this.mainStageClient){e.n=36;break}return e.p=26,e.n=27,null===(x=(C=this.mainStageClient).getMeetingInfo)||void 0===x?void 0:x.call(C);case 27:if(U=e.v,console.log("📋 Meeting info from mainStageClient:",JSON.stringify(U,null,2)),null==U||!U.meetingUrl){e.n=28;break}return console.log("✅ Found meeting URL from mainStageClient:",U.meetingUrl),e.a(2,U.meetingUrl);case 28:if(null==U||!U.meetingCode){e.n=29;break}return M="https://meet.google.com/".concat(U.meetingCode),console.log("✅ Constructed meeting URL from meetingCode:",M),e.a(2,M);case 29:if(null==U||!U.meetingId){e.n=30;break}return j="https://meet.google.com/".concat(U.meetingId),console.log("✅ Constructed meeting URL from meetingId:",j),e.a(2,j);case 30:O=0,_=Object.entries(U||{});case 31:if(!(O<_.length)){e.n=34;break}if(N=p(_[O],2),R=N[0],"string"!=typeof(L=N[1])){e.n=33;break}if(!L.includes("meet.google.com")){e.n=32;break}return console.log("✅ Found meeting URL in field ".concat(R,":"),L),e.a(2,L);case 32:if(!/^[a-z]{3}-[a-z]{4}-[a-z]{3}$/i.test(L)){e.n=33;break}return G="https://meet.google.com/".concat(L),console.log("✅ Found meeting code in field ".concat(R,":"),G),e.a(2,G);case 33:O++,e.n=31;break;case 34:e.n=36;break;case 35:e.p=35,Se=e.v,console.warn("Could not get meeting URL from mainStageClient:",Se);case 36:if(null===(t=this.credentials)||void 0===t||!t.meetSession){e.n=47;break}return e.p=37,e.n=38,null===(z=(B=this.credentials.meetSession).getMeetingInfo)||void 0===z?void 0:z.call(B);case 38:if(D=e.v,console.log("📋 Meeting info from meetSession:",JSON.stringify(D,null,2)),null==D||!D.meetingUrl){e.n=39;break}return console.log("✅ Found meeting URL from meetSession:",D.meetingUrl),e.a(2,D.meetingUrl);case 39:if(null==D||!D.meetingCode){e.n=40;break}return F="https://meet.google.com/".concat(D.meetingCode),console.log("✅ Constructed meeting URL from meetingCode:",F),e.a(2,F);case 40:if(null==D||!D.meetingId){e.n=41;break}return K="https://meet.google.com/".concat(D.meetingId),console.log("✅ Constructed meeting URL from meetingId:",K),e.a(2,K);case 41:W=0,$=Object.entries(D||{});case 42:if(!(W<$.length)){e.n=45;break}if(q=p($[W],2),J=q[0],"string"!=typeof(Y=q[1])){e.n=44;break}if(!Y.includes("meet.google.com")){e.n=43;break}return console.log("✅ Found meeting URL in field ".concat(J,":"),Y),e.a(2,Y);case 43:if(!/^[a-z]{3}-[a-z]{4}-[a-z]{3}$/i.test(Y)){e.n=44;break}return V="https://meet.google.com/".concat(Y),console.log("✅ Found meeting code in field ".concat(J,":"),V),e.a(2,V);case 44:W++,e.n=42;break;case 45:e.n=47;break;case 46:e.p=46,Te=e.v,console.warn("Could not get meeting URL from Meet session:",Te);case 47:if(e.p=47,!window.parent||window.parent===window){e.n=48;break}if(H=window.parent.location.href,console.log("Parent window URL:",H),!H.includes("meet.google.com")){e.n=48;break}if(!((X=H.match(/meet\.google\.com\/([a-z0-9-]+)/i))&&X[1]&&X[1].length>3)){e.n=48;break}return Q=X[1],Z="https://meet.google.com/".concat(Q),console.log("✅ Found meeting URL from parent window:",Z),e.a(2,Z);case 48:e.n=50;break;case 49:e.p=49,Ie=e.v,console.warn("Could not access parent window (cross-origin):",Ie.message);case 50:if(e.p=50,!(ee=document.referrer)||!ee.includes("meet.google.com")){e.n=51;break}if(!((te=ee.match(/meet\.google\.com\/([a-z0-9-]+)/i))&&te[1]&&te[1].length>3)){e.n=51;break}return ne=te[1],re="https://meet.google.com/".concat(ne),console.log("✅ Found meeting URL from referrer:",re),e.a(2,re);case 51:e.n=53;break;case 52:e.p=52,Pe=e.v,console.warn("Could not get meeting URL from referrer:",Pe);case 53:if(!(oe=window.location.href).includes("meet.google.com")){e.n=54;break}if(!((ie=oe.match(/meet\.google\.com\/([a-z0-9-]+)/i))&&ie[1]&&ie[1].length>3)){e.n=54;break}return ae=ie[1],se="https://meet.google.com/".concat(ae),console.log("✅ Found meeting URL from current URL:",se),e.a(2,se);case 54:if(!((ce=document.querySelectorAll('a[href*="meet.google.com"]')).length>0)){e.n=61;break}le=d(ce),e.p=55,le.s();case 56:if((ue=le.n()).done){e.n=58;break}if(de=ue.value,pe=de.href,!((fe=pe.match(/meet\.google\.com\/([a-z0-9-]+)/i))&&fe[1]&&fe[1].length>3)){e.n=57;break}return he="https://meet.google.com/".concat(fe[1]),console.log("✅ Found meeting URL from DOM link:",he),e.a(2,he);case 57:e.n=56;break;case 58:e.n=60;break;case 59:e.p=59,xe=e.v,le.e(xe);case 60:return e.p=60,le.f(),e.f(60);case 61:if(e.p=61,!(ge=sessionStorage.getItem("meet_url")||localStorage.getItem("meet_url"))||!ge.includes("meet.google.com")){e.n=62;break}return console.log("✅ Found meeting URL from storage:",ge),e.a(2,ge);case 62:if(!(me=sessionStorage.getItem("meet_code")||localStorage.getItem("meet_code"))){e.n=63;break}return ye="https://meet.google.com/".concat(me),console.log("✅ Found meeting URL from stored code:",ye),e.a(2,ye);case 63:e.n=65;break;case 64:e.p=64,Ce=e.v,console.warn("Could not access storage:",Ce);case 65:if(e.p=65,!window.name||!window.name.includes("meet.google.com")){e.n=66;break}if(!(ve=window.name.match(/meet\.google\.com\/([a-z0-9-]+)/i))||!ve[1]){e.n=66;break}return we="https://meet.google.com/".concat(ve[1]),console.log("✅ Found meeting URL from window.name:",we),e.a(2,we);case 66:e.n=68;break;case 67:e.p=67,Ue=e.v,console.warn("Could not access window.name:",Ue);case 68:return console.warn("⚠️ Could not automatically detect meeting URL from any source"),e.a(2,null);case 69:return e.p=69,Me=e.v,console.error("Error getting meeting URL:",Me),e.a(2,null)}},e,this,[[65,67],[61,64],[55,59,60,61],[50,52],[47,49],[37,46],[26,35],[15,24],[5,7],[4,11],[1,13],[0,69]])})),function(){return l.apply(this,arguments)})},{key:"setWebhookUrl",value:function(e){this.webhookUrl=e,this.useWebhooks=!!e,console.log("Webhook URL set:",e)}},{key:"createBot",value:(c=v(g().m(function e(){var t,n,r,o,i,a,s,c,l,u,d,p,f=arguments;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=f.length>0&&void 0!==f[0]?f[0]:null,e.p=1,this.apiKey){e.n=2;break}throw new Error("Attendee.ai API key is required");case 2:if(t){e.n=6;break}return e.n=3,this.getMeetingUrl();case 3:if(t=e.v){e.n=6;break}return e.n=4,this.promptForMeetingUrl();case 4:if(!(n=e.v)){e.n=5;break}t=n,e.n=6;break;case 5:throw new Error("Could not detect meeting URL. Please ensure you are running this from within a Google Meet session. You may need to manually enter the meeting URL if automatic detection fails.");case 6:return this.meetingUrl=t,console.log("Creating Attendee.ai bot for meeting:",t),r=t.match(/meet\.google\.com\/([a-z0-9-]+)/i),o=r?r[1]:"meet-bot",i="Transcript Bot - ".concat(o),a={meeting_url:t,bot_name:i,transcription_settings:{deepgram:{language:"en-US",model:"nova-2"}}},this.useWebhooks&&this.webhookUrl&&(a.webhooks=[{url:this.webhookUrl,triggers:["transcript.update","bot.state_change"]}],console.log("Using webhooks for real-time updates:",this.webhookUrl)),s=this.useProxy?"".concat(this.proxyServerUrl,"/api/attendee/bots"):"".concat(this.baseUrl,"/bots"),console.log("[Attendee] Proxy configuration:",{useProxy:this.useProxy,proxyServerUrl:this.proxyServerUrl,baseUrl:this.baseUrl,finalUrl:s,isBrowser:"undefined"!=typeof window}),c={"Content-Type":"application/json"},this.useProxy?(c["x-attendee-api-key"]=this.apiKey,console.log("[Attendee] Using proxy server:",s)):(c.Authorization="Token ".concat(this.apiKey),console.log("[Attendee] Using direct API (not in browser):",s)),e.n=7,fetch(s,{method:"POST",headers:c,body:JSON.stringify(a)});case 7:if((l=e.v).ok){e.n=9;break}return e.n=8,l.json().catch(function(){return{}});case 8:throw u=e.v,new Error("Failed to create bot: ".concat(l.status," ").concat(l.statusText,". ").concat(u.message||u.detail||""));case 9:return e.n=10,l.json();case 10:return d=e.v,this.botId=d.id||d.bot_id,console.log("✅ Bot created successfully:",this.botId),this.onBotStatusChange&&this.onBotStatusChange({status:"created",botId:this.botId}),e.a(2,d);case 11:throw e.p=11,p=e.v,console.error("Error creating bot:",p),this.onError&&this.onError(p),p;case 12:return e.a(2)}},e,this,[[1,11]])})),function(){return c.apply(this,arguments)})},{key:"getTranscript",value:(s=v(g().m(function e(){var t,n,r,o,i,a;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.botId){e.n=1;break}throw new Error("Bot ID is required. Create a bot first.");case 1:return t=this.useProxy?"".concat(this.proxyServerUrl,"/api/attendee/bots/").concat(this.botId,"/transcript"):"".concat(this.baseUrl,"/bots/").concat(this.botId,"/transcript"),n={"Content-Type":"application/json"},this.useProxy?n["x-attendee-api-key"]=this.apiKey:n.Authorization="Token ".concat(this.apiKey),e.n=2,fetch(t,{method:"GET",headers:n});case 2:if((r=e.v).ok){e.n=5;break}if(404!==r.status){e.n=3;break}return console.log("[Attendee] No transcripts yet (bot may have just started)"),e.a(2,[]);case 3:return e.n=4,r.json().catch(function(){return{}});case 4:throw o=e.v,new Error("Failed to get transcript: ".concat(r.status," ").concat(r.statusText,". ").concat(o.message||o.detail||""));case 5:return e.n=6,r.json();case 6:return i=e.v,e.a(2,i);case 7:throw e.p=7,a=e.v,console.error("Error getting transcript:",a),this.onError&&this.onError(a),a;case 8:return e.a(2)}},e,this,[[0,7]])})),function(){return s.apply(this,arguments)})},{key:"startTranscription",value:(a=v(g().m(function e(){var t,n,r,o,i=this,a=arguments;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:null,e.p=1,!this.isActive){e.n=2;break}return console.warn("Transcription is already active"),e.a(2);case 2:if(this.botId){e.n=3;break}return e.n=3,this.createBot(t);case 3:if(this.isActive=!0,this.transcriptEntries=[],this.lastWebhookTimestamp=0,this.pollCount=0,!(n=this.webhookUrl)&&this.useProxy&&this.proxyServerUrl)try{"https:"===new URL(this.proxyServerUrl).protocol&&(n="".concat(this.proxyServerUrl,"/api/webhooks/attendee"),console.log("[Attendee] Using proxy server webhook URL:",n),this.setWebhookUrl(n))}catch(e){}return this.useWebhooks&&n?(console.log("Starting webhook-based transcription polling..."),this.startWebhookPolling()):(console.log("Starting API-based transcription polling..."),this.startPolling()),this.onBotStatusChange&&this.onBotStatusChange({status:"active",botId:this.botId}),console.log("[Attendee] Transcription active. Waiting for transcripts..."),this.onTranscriptUpdate&&(r={speakerName:"System",transcription:"🎙️ Bot is active. Waiting for participants to speak...",timestamp:Date.now(),duration:0,isFinal:!0,isPlaceholder:!0},setTimeout(function(){0===i.transcriptEntries.length&&i.onTranscriptUpdate(r)},1e3)),e.a(2,!0);case 4:throw e.p=4,o=e.v,console.error("Error starting transcription:",o),this.isActive=!1,this.onError&&this.onError(o),o;case 5:return e.a(2)}},e,this,[[1,4]])})),function(){return a.apply(this,arguments)})},{key:"startWebhookPolling",value:function(){var e=this;this.webhookPollInterval&&clearInterval(this.webhookPollInterval),this.pollWebhookTranscripts(),this.webhookPollInterval=setInterval(function(){e.pollWebhookTranscripts()},this.webhookPollIntervalMs)}},{key:"pollWebhookTranscripts",value:(i=v(g().m(function e(){var t,n,r,o,i,a=this;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.isActive&&this.botId){e.n=1;break}return e.a(2);case 1:return t="".concat(this.proxyServerUrl,"/api/webhooks/attendee/transcripts/").concat(this.botId,"?since=").concat(this.lastWebhookTimestamp),e.n=2,fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}});case 2:if((n=e.v).ok){e.n=3;break}return console.warn("Error polling webhook transcripts:",n.status),e.a(2);case 3:return e.n=4,n.json();case 4:r=e.v,(o=r.transcripts||[]).length>0&&(o.forEach(function(e){if("bot_state_change"===e.type)a.onBotStatusChange&&a.onBotStatusChange({status:e.newState,oldStatus:e.oldState,eventType:e.eventType,botId:e.botId});else if(e.transcription&&a.onTranscriptUpdate){var t={speakerName:e.speakerName||"Unknown",speakerUuid:e.speakerUuid||null,timestamp:e.timestamp||0,duration:e.duration||0,transcription:e.transcription,words:e.words||null,isFinal:!0};a.onTranscriptUpdate(t)}}),r.latestTimestamp>this.lastWebhookTimestamp&&(this.lastWebhookTimestamp=r.latestTimestamp)),e.n=6;break;case 5:e.p=5,i=e.v,console.error("Error polling webhook transcripts:",i);case 6:return e.a(2)}},e,this,[[0,5]])})),function(){return i.apply(this,arguments)})},{key:"startPolling",value:function(){var e=this;this.pollInterval&&clearInterval(this.pollInterval),this.pollTranscript(),this.pollInterval=setInterval(function(){e.pollTranscript()},this.pollIntervalMs)}},{key:"pollTranscript",value:(o=v(g().m(function e(){var t,n,r;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.isActive&&this.botId){e.n=1;break}return e.a(2);case 1:return e.n=2,this.getTranscript();case 2:t=e.v,n=[],Array.isArray(t)?n=t:t.entries?n=t.entries:t.transcript?n=Array.isArray(t.transcript)?t.transcript:[t.transcript]:t.data&&Array.isArray(t.data)&&(n=t.data),void 0===this.pollCount&&(this.pollCount=0),this.pollCount++,(this.pollCount<=3||n.length>0)&&(console.log("[Attendee] Poll #".concat(this.pollCount,": Found ").concat(n.length," transcript entries")),n.length>0&&console.log("[Attendee] Sample entry:",JSON.stringify(n[0],null,2))),n.length>0&&this.processTranscriptEntries(n),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Error polling transcript:",r);case 4:return e.a(2)}},e,this,[[0,3]])})),function(){return o.apply(this,arguments)})},{key:"processTranscriptEntries",value:function(e){var t=this;if(e&&0!==e.length){var n=new Set(this.transcriptEntries.map(function(e){return e.timestamp||e.timestamp_ms||"".concat(e.speakerName,"-").concat(e.transcription)})),r=e.filter(function(e){var t,r=e.timestamp_ms||e.timestamp||0,o=e.speaker_name||e.speakerName||"Unknown";t=e.transcription?"string"==typeof e.transcription?e.transcription:e.transcription.transcript||e.transcription.text||"":e.text||e.transcript||"";var i=r||"".concat(o,"-").concat(t);return!n.has(i)});0!==r.length&&(console.log("[Attendee] Processing ".concat(r.length," new transcript entries")),r.forEach(function(e){if(t.onTranscriptUpdate){var n="";if(!(n=e.transcription?"string"==typeof e.transcription?e.transcription:e.transcription.transcript||e.transcription.text||"":e.text||e.transcript||"")||!n.trim())return;var r={speakerName:e.speaker_name||e.speakerName||"Unknown",speakerUuid:e.speaker_uuid||e.speakerUuid||null,timestamp:e.timestamp_ms||e.timestamp||0,duration:e.duration_ms||e.duration||0,transcription:n.trim(),isFinal:!1!==e.is_final};t.transcriptEntries.push({timestamp:r.timestamp||"".concat(r.speakerName,"-").concat(r.transcription),speakerName:r.speakerName,transcription:r.transcription}),t.onTranscriptUpdate(r)}}))}}},{key:"stopTranscription",value:(r=v(g().m(function e(){var t;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Stopping transcription..."),this.isActive=!1,this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null),this.webhookPollInterval&&(clearInterval(this.webhookPollInterval),this.webhookPollInterval=null),this.onBotStatusChange&&this.onBotStatusChange({status:"stopped",botId:this.botId}),console.log("✅ Transcription stopped"),e.a(2,!0);case 1:throw e.p=1,t=e.v,console.error("Error stopping transcription:",t),t;case 2:return e.a(2)}},e,this,[[0,1]])})),function(){return r.apply(this,arguments)})},{key:"getBotInfo",value:(n=v(g().m(function e(){var t,n,r,o;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.botId){e.n=1;break}throw new Error("Bot ID is required");case 1:return t=this.useProxy?"".concat(this.proxyServerUrl,"/api/attendee/bots/").concat(this.botId):"".concat(this.baseUrl,"/bots/").concat(this.botId),n={"Content-Type":"application/json"},this.useProxy?n["x-attendee-api-key"]=this.apiKey:n.Authorization="Token ".concat(this.apiKey),e.n=2,fetch(t,{method:"GET",headers:n});case 2:if((r=e.v).ok){e.n=3;break}throw new Error("Failed to get bot info: ".concat(r.status," ").concat(r.statusText));case 3:return e.n=4,r.json();case 4:return e.a(2,e.v);case 5:throw e.p=5,o=e.v,console.error("Error getting bot info:",o),o;case 6:return e.a(2)}},e,this,[[0,5]])})),function(){return n.apply(this,arguments)})},{key:"destroy",value:function(){this.stopTranscription(),this.botId=null,this.meetingUrl=null,this.transcriptEntries=[],this.onTranscriptUpdate=null,this.onBotStatusChange=null,this.onError=null}}],t&&w(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,a,s,c,l,u,f}();function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function A(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return S(l,"_invoke",function(n,r,o){var i,s,c,l=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,i=u[t],f=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=f&&((o=n<2&&f<i[1])?(s=0,p.v=r,p.n=i[1]):f<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,h),s=u,c=h;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(p.n=-1),f(s,c)):p.n=c:p.v=c);try{if(l=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?c:n.call(r,p))!==a)break}catch(t){i=e,s=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,i),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(S(t={},r,function(){return this}),t),d=l.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,S(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,S(d,"constructor",l),S(l,"constructor",c),c.displayName="GeneratorFunction",S(l,o,"GeneratorFunction"),S(d),S(d,o,"Generator"),S(d,r,function(){return this}),S(d,"toString",function(){return"[object Generator]"}),(A=function(){return{w:i,m:p}})()}function S(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}S=function(e,t,n,r){function i(t,n){S(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},S(e,t,n,r)}function T(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function I(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){T(i,r,o,a,s,"next",e)}function s(e){T(i,r,o,a,s,"throw",e)}a(void 0)})}}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function x(e){var t=function(e){if("object"!=E(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:t+""}var C=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.credentials=t,this.proxyUrl=(null==t?void 0:t.proxyUrl)||null,this.accessToken=null,this.isActive=!1,this.pollInterval=null,this.conferenceRecord=null,this.transcript=null,this.lastEntryTime=null,this.pc=null,this.sessionControl=null,this.mediaStats=null,this.deepgramConnections=new Map,this.onTranscriptUpdate=null,this.onError=null,this.pollIntervalMs=2e3,console.log("[GMTA] Constructed GoogleMeetTranscriptAPI",{proxyUrl:this.proxyUrl||"http://localhost:8787"})},t=[{key:"initializeAuth",value:(p=I(A().m(function e(t){var n;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("[GMTA] Initializing Google Meet Transcript API..."),t){e.n=1;break}throw new Error("Access token is required for Google Meet API");case 1:return this.accessToken=t,console.log("[GMTA] ✅ Google Meet Transcript API initialized"),e.a(2,!0);case 2:throw e.p=2,n=e.v,console.error("❌ Authentication failed:",n),n;case 3:return e.a(2)}},e,this,[[0,2]])})),function(e){return p.apply(this,arguments)})},{key:"getAccessToken",value:(d=I(A().m(function e(){var t,n;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("[GMTA] getAccessToken"),null===(t=this.credentials)||void 0===t||!t.meetSession){e.n=1;break}return e.a(2,this.accessToken);case 1:return e.a(2,this.accessToken);case 2:return e.p=2,n=e.v,console.error("[GMTA] Error getting access token:",n),e.a(2,null)}},e,this,[[0,2]])})),function(){return d.apply(this,arguments)})},{key:"lookupSpace",value:(u=I(A().m(function e(t){var n,r,o,i,a,s,c;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("[GMTA] lookupSpace start",{meetingCode:t}),e.n=1,this.getAccessToken();case 1:if(n=e.v){e.n=2;break}throw new Error("Access token not available");case 2:return r=this.proxyUrl||"http://localhost:8787",o="".concat(r,"/api/lookupSpace?meetingCode=").concat(encodeURIComponent(t)),console.log("[GMTA] Looking up space via proxy:",o),e.n=3,fetch(o,{method:"GET",headers:{"x-access-token":n,"Content-Type":"application/json"}});case 3:if((i=e.v).ok){e.n=5;break}return e.n=4,i.text();case 4:throw a=e.v,console.warn("[GMTA] lookupSpace non-OK",{status:i.status,statusText:i.statusText,bodyPreview:a.substring(0,200)}),new Error("Failed to lookup space: ".concat(i.status," ").concat(i.statusText,". ").concat(a));case 5:return e.n=6,i.json();case 6:return s=e.v,console.log("[GMTA] ✅ Space lookup successful:",s),e.a(2,s);case 7:throw e.p=7,c=e.v,console.error("[GMTA] Error looking up space:",c),c;case 8:return e.a(2)}},e,this,[[0,7]])})),function(e){return u.apply(this,arguments)})},{key:"verifySpace",value:(l=I(A().m(function e(t){var n,r,o,i,a,s;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.getAccessToken();case 1:if(n=e.v){e.n=2;break}throw new Error("Access token not available");case 2:return console.log("Access token:",n),console.log("Space name:",t),console.log("Proxy URL:",this.proxyUrl),r=this.proxyUrl||"http://localhost:8787",o="".concat(r,"/api/verifySpace?spaceName=").concat(encodeURIComponent(t)),console.log("URL:",o),e.n=3,fetch(o,{method:"GET",headers:{"x-access-token":n,"Content-Type":"application/json"}});case 3:if((i=e.v).ok){e.n=5;break}return e.n=4,i.text();case 4:throw a=e.v,new Error("Failed to verify space: ".concat(i.status," ").concat(i.statusText,". ").concat(a));case 5:return e.n=6,i.json();case 6:return s=e.v,e.a(2,s);case 7:throw e.p=7,e.v;case 8:return e.a(2)}},e,this,[[0,7]])})),function(e){return l.apply(this,arguments)})},{key:"getConferenceRecords",value:(c=I(A().m(function e(t){var n,r,o,i,a,s,c;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("[GMTA] getConferenceRecords start",{spaceName:t}),e.n=1,this.getAccessToken();case 1:if(n=e.v){e.n=2;break}throw new Error("Access token not available");case 2:return r=this.proxyUrl||"http://localhost:8787",o="".concat(r,"/api/conferenceRecords?spaceName=").concat(encodeURIComponent(t)),console.log("[GMTA] Fetching conference records via proxy:",o),e.n=3,fetch(o,{method:"GET",headers:{"x-access-token":n,"Content-Type":"application/json"}});case 3:if((i=e.v).ok){e.n=5;break}return e.n=4,i.text();case 4:throw a=e.v,console.warn("[GMTA] getConferenceRecords non-OK",{status:i.status,statusText:i.statusText,bodyPreview:a.substring(0,200)}),new Error("Failed to get conference records: ".concat(i.status," ").concat(i.statusText,". ").concat(a));case 5:return e.n=6,i.json();case 6:return s=e.v,console.log("[GMTA] ✅ Conference records fetched:",s),e.a(2,s);case 7:throw e.p=7,c=e.v,console.error("[GMTA] Error getting conference records:",c),c;case 8:return e.a(2)}},e,this,[[0,7]])})),function(e){return c.apply(this,arguments)})},{key:"getTranscripts",value:(s=I(A().m(function e(t){var n,r,o,i,a,s,c;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("[GMTA] getTranscripts start",{conferenceRecord:t}),e.n=1,this.getAccessToken();case 1:if(n=e.v){e.n=2;break}throw new Error("Access token not available");case 2:return r=this.proxyUrl||"http://localhost:8787",o="".concat(r,"/api/transcripts?conferenceRecord=").concat(encodeURIComponent(t)),console.log("[GMTA] Fetching transcripts via proxy:",o),e.n=3,fetch(o,{method:"GET",headers:{"x-access-token":n,"Content-Type":"application/json"}});case 3:if((i=e.v).ok){e.n=5;break}return e.n=4,i.text();case 4:throw a=e.v,console.warn("[GMTA] getTranscripts non-OK",{status:i.status,statusText:i.statusText,bodyPreview:a.substring(0,200)}),new Error("Failed to get transcripts: ".concat(i.status," ").concat(i.statusText,". ").concat(a));case 5:return e.n=6,i.json();case 6:return s=e.v,console.log("[GMTA] ✅ Transcripts fetched:",s),e.a(2,s);case 7:throw e.p=7,c=e.v,console.error("[GMTA] Error getting transcripts:",c),c;case 8:return e.a(2)}},e,this,[[0,7]])})),function(e){return s.apply(this,arguments)})},{key:"getTranscriptEntries",value:(a=I(A().m(function e(t){var n,r,o,i,a,s,c;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("[GMTA] getTranscriptEntries start",{transcriptName:t}),e.n=1,this.getAccessToken();case 1:if(n=e.v){e.n=2;break}throw new Error("Access token not available");case 2:return r=this.proxyUrl||"http://localhost:8787",o="".concat(r,"/api/transcripts/entries?transcript=").concat(encodeURIComponent(t)),e.n=3,fetch(o,{method:"GET",headers:{"x-access-token":n,"Content-Type":"application/json"}});case 3:if((i=e.v).ok){e.n=5;break}return e.n=4,i.text();case 4:throw a=e.v,console.warn("[GMTA] getTranscriptEntries non-OK",{status:i.status,statusText:i.statusText,bodyPreview:a.substring(0,200)}),new Error("Failed to get transcript entries: ".concat(i.status," ").concat(i.statusText,". ").concat(a));case 5:return e.n=6,i.json();case 6:return s=e.v,e.a(2,s);case 7:throw e.p=7,c=e.v,console.error("[GMTA] Error getting transcript entries:",c),c;case 8:return e.a(2)}},e,this,[[0,7]])})),function(e){return a.apply(this,arguments)})},{key:"extractMeetingCode",value:function(e){try{var t=e.match(/meet\.google\.com\/([a-z0-9-]+)/i);return t&&t[1]?t[1]:/^[a-z]{3}-[a-z]{4}-[a-z]{3}$/i.test(e)?e:null}catch(e){return console.error("Error extracting meeting code:",e),null}}},{key:"startTranscription",value:(i=I(A().m(function e(t,n){var r,o,i,a,s,c,l,u,d,p,f,h,g,m,y;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("[GMTA] Starting Google Meet transcript API..."),n){e.n=1;break}throw new Error("Access token is required. Please authenticate first.");case 1:return e.n=2,this.initializeAuth(n);case 2:if(r=this.extractMeetingCode(t)||t){e.n=3;break}throw new Error("Could not extract meeting code from URL");case 3:return console.log("[GMTA] Meeting code:",r),o=null,e.p=4,e.n=5,this.lookupSpace(r);case 5:i=e.v,o=(null==i?void 0:i.name)||(null==i?void 0:i.spaceName)||null,e.n=13;break;case 6:e.p=6,m=e.v,a=["spaces/".concat(r),"spaces/".concat((r||"").replace(/-/g,""))],s=0,c=a;case 7:if(!(s<c.length)){e.n=12;break}return l=c[s],e.p=8,e.n=9,this.verifySpace(l);case 9:return o=l,e.a(3,12);case 10:e.p=10,e.v;case 11:s++,e.n=7;break;case 12:if(o){e.n=13;break}throw m;case 13:if(o){e.n=14;break}throw new Error("Could not get space name from lookup");case 14:return console.log("[GMTA] ✅ Space name:",o),e.n=15,this.getConferenceRecords(o);case 15:if(u=e.v,0!==(d=(null==u?void 0:u.conferenceRecords)||[]).length){e.n=16;break}throw new Error("No conference records found. Make sure the meeting is active.");case 16:if(p=d[0],this.conferenceRecord=(null==p?void 0:p.name)||(null==p?void 0:p.conferenceRecord),this.conferenceRecord){e.n=17;break}throw new Error("Could not get conference record");case 17:return console.log("[GMTA] ✅ Conference record:",this.conferenceRecord),e.n=18,this.getTranscripts(this.conferenceRecord);case 18:if(f=e.v,0!==(h=(null==f?void 0:f.transcripts)||[]).length){e.n=19;break}throw new Error("No transcripts found. Transcription may not be enabled for this meeting.");case 19:if(g=h[0],this.transcript=(null==g?void 0:g.name)||(null==g?void 0:g.transcript),this.transcript){e.n=20;break}throw new Error("Could not get transcript");case 20:return console.log("[GMTA] ✅ Transcript:",this.transcript),this.isActive=!0,this.startPolling(),console.log("[GMTA] ✅ Live transcription started successfully"),e.a(2,!0);case 21:throw e.p=21,y=e.v,console.error("[GMTA] Error starting transcription:",y),this.isActive=!1,this.onError&&this.onError(y),y;case 22:return e.a(2)}},e,this,[[8,10],[4,6],[0,21]])})),function(e,t){return i.apply(this,arguments)})},{key:"startPolling",value:function(){var e=this;this.pollInterval&&clearInterval(this.pollInterval),console.log("[GMTA] startPolling now"),this.pollTranscriptEntries(),this.pollInterval=setInterval(function(){e.pollTranscriptEntries()},this.pollIntervalMs)}},{key:"pollTranscriptEntries",value:(o=I(A().m(function e(){var t,n,r,o,i,a,s=this;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.isActive&&this.transcript){e.n=1;break}return console.log("[GMTA] pollTranscriptEntries skipped (inactive or no transcript)"),e.a(2);case 1:return e.n=2,this.getTranscriptEntries(this.transcript);case 2:t=e.v,n=(null==t?void 0:t.entries)||(null==t?void 0:t.transcriptEntries)||[],(r=n.filter(function(e){if(!s.lastEntryTime)return!0;var t=e.startTime||e.startOffset||e.timestamp;return!t||s.parseTimeToMs(t)>s.lastEntryTime})).length>0&&(this.processTranscriptEntries(r),o=r[r.length-1],(i=o.startTime||o.startOffset||o.timestamp)&&(this.lastEntryTime=this.parseTimeToMs(i))),e.n=4;break;case 3:e.p=3,a=e.v,console.error("[GMTA] Error polling transcript entries:",a);case 4:return e.a(2)}},e,this,[[0,3]])})),function(){return o.apply(this,arguments)})},{key:"parseTimeToMs",value:function(e){try{return"number"==typeof e?e:e.endsWith("s")?1e3*parseFloat(e):e.endsWith("ms")?parseFloat(e):e.includes("T")?new Date(e).getTime():parseFloat(e)}catch(t){return console.warn("Error parsing time:",e,t),Date.now()}}},{key:"processTranscriptEntries",value:function(e){var t=this;e.forEach(function(e){if(t.onTranscriptUpdate){var n,r,o,i={speakerName:(null===(n=e.participant)||void 0===n?void 0:n.displayName)||(null===(r=e.participant)||void 0===r?void 0:r.name)||e.speaker||"Unknown",speakerId:(null===(o=e.participant)||void 0===o?void 0:o.id)||e.participantId||null,timestamp:e.startTime||e.startOffset||e.timestamp||0,duration:e.endTime?t.parseTimeToMs(e.endTime)-t.parseTimeToMs(e.startTime||e.startOffset||0):e.duration||0,transcription:e.text||e.transcript||e.transcription||"",isFinal:!1!==e.isFinal,confidence:e.confidence||1};i.transcription&&i.transcription.trim()&&t.onTranscriptUpdate(i)}})}},{key:"stopTranscription",value:(r=I(A().m(function e(){var t;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0,console.log("[GMTA] Stopping transcription..."),this.isActive=!1,this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null),this.conferenceRecord=null,this.transcript=null,this.lastEntryTime=null;try{this.pc&&(this.pc.getSenders().forEach(function(e){try{e.track&&e.track.stop&&e.track.stop()}catch(e){}}),this.pc.getReceivers().forEach(function(e){try{e.track&&e.track.stop&&e.track.stop()}catch(e){}}),this.pc.close())}catch(e){}return this.pc=null,this.sessionControl=null,this.mediaStats=null,this.deepgramConnections.forEach(function(e){var t=e.socket,n=e.mediaRecorder,r=e.audioStream;try{n&&"inactive"!==n.state&&n.stop()}catch(e){}try{r&&r.getTracks().forEach(function(e){return e.stop()})}catch(e){}try{t&&t.close&&t.close()}catch(e){}}),this.deepgramConnections.clear(),console.log("[GMTA] ✅ Transcription stopped"),e.a(2,!0);case 1:throw e.p=1,t=e.v,console.error("[GMTA] Error stopping transcription:",t),t;case 2:return e.a(2)}},e,this,[[0,1]])})),function(){return r.apply(this,arguments)})},{key:"destroy",value:function(){this.stopTranscription(),this.accessToken=null,this.onTranscriptUpdate=null,this.onError=null}},{key:"startRealtimeAudio",value:(n=I(A().m(function e(t,n){var r,o,i,a,s,c,l,u=this,d=arguments;return A().w(function(e){for(;;)switch(e.n){case 0:if(r=d.length>2&&void 0!==d[2]?d[2]:null,t&&t.startsWith("spaces/")){e.n=1;break}throw new Error("Invalid space name. Expected format: spaces/…");case 1:for(this.accessToken=n,o=this.proxyUrl||"http://localhost:8787",console.log("[GMTA] startRealtimeAudio",{spaceName:t,baseUrl:o}),this.pc=new RTCPeerConnection({iceServers:[{urls:["stun:stun.l.google.com:19302"]}]}),i=0;i<3;i++)this.pc.addTransceiver("audio",{direction:"recvonly"});return this.sessionControl=this.pc.createDataChannel("session-control",{ordered:!0}),this.mediaStats=this.pc.createDataChannel("media-stats",{ordered:!0}),this.pc.ontrack=function(e){if(console.log("[GMTA] ontrack",e.track.kind,"id:",e.track&&e.track.id),"audio"===e.track.kind){var t=e.track.id,n=new MediaStream([e.track]);try{var o=document.createElement("audio");o.style.display="none",o.autoplay=!0,o.muted=!0,o.playsInline=!0,o.srcObject=n,document.body.appendChild(o);var i=o.play();i&&i.catch&&i.catch(function(){})}catch(e){console.warn("[GMTA] failed to attach audio element",e)}r&&r.trim()?u.startDeepgram(n,t,r.trim()):console.log("[GMTA] Deepgram API key not provided; transcription disabled for track",t)}},e.n=2,this.pc.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});case 2:return a=e.v,e.n=3,this.pc.setLocalDescription(a);case 3:return console.log("[GMTA] Local SDP created, sending to proxy"),e.n=4,fetch("".concat(o,"/api/connectActiveConference"),{method:"POST",headers:{"Content-Type":"application/json","x-access-token":this.accessToken},body:JSON.stringify({spaceName:t,offer:a.sdp})});case 4:if((s=e.v).ok){e.n=6;break}return e.n=5,s.text();case 5:throw c=e.v,new Error("connectActiveConference failed: ".concat(s.status," ").concat(c));case 6:return e.n=7,s.json();case 7:if((l=e.v)&&l.answer){e.n=8;break}throw new Error("No SDP answer returned by proxy");case 8:return e.n=9,this.pc.setRemoteDescription({type:"answer",sdp:l.answer});case 9:console.log("[GMTA] Remote SDP set; ICE connecting…"),this.isActive=!0;case 10:return e.a(2)}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"startDeepgram",value:function(e,t,n){var r=this;try{var o=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"}),i=new WebSocket("wss://api.deepgram.com/v1/listen?model=nova-3&numerals=true&smart_format=true&interim_results=true",["token",n]);i.onopen=function(){console.log("[GMTA] Deepgram connected for",t),o.start(1e3),o.ondataavailable=function(e){e.data&&e.data.size>0&&i.readyState===WebSocket.OPEN&&i.send(e.data)}},i.onmessage=function(e){try{var n=JSON.parse(e.data);if(n&&n.type&&"Metadata"!==n.type){var o=JSON.stringify(n).slice(0,200);console.log("[GMTA] Deepgram msg",o)}if(n&&n.channel&&n.channel.alternatives&&n.channel.alternatives[0]){var i=n.channel.alternatives[0].transcript||"";i&&r.onTranscriptUpdate&&r.onTranscriptUpdate({speakerName:"Track ".concat(t),transcription:i,isFinal:!!n.is_final,confidence:1})}}catch(e){}},i.onclose=function(){try{o&&"inactive"!==o.state&&o.stop()}catch(e){}},this.deepgramConnections.set(t,{socket:i,mediaRecorder:o,audioStream:e})}catch(e){console.error("[GMTA] Deepgram start error",e)}}}],t&&P(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,a,s,c,l,u,d,p}();function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function M(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return j(l,"_invoke",function(n,r,o){var i,s,c,l=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,i=u[t],f=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=f&&((o=n<2&&f<i[1])?(s=0,p.v=r,p.n=i[1]):f<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,h),s=u,c=h;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(p.n=-1),f(s,c)):p.n=c:p.v=c);try{if(l=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?c:n.call(r,p))!==a)break}catch(t){i=e,s=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,i),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(j(t={},r,function(){return this}),t),d=l.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,j(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,j(d,"constructor",l),j(l,"constructor",c),c.displayName="GeneratorFunction",j(l,o,"GeneratorFunction"),j(d),j(d,o,"Generator"),j(d,r,function(){return this}),j(d,"toString",function(){return"[object Generator]"}),(M=function(){return{w:i,m:p}})()}function j(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}j=function(e,t,n,r){function i(t,n){j(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},j(e,t,n,r)}function O(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function _(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){O(i,r,o,a,s,"next",e)}function s(e){O(i,r,o,a,s,"throw",e)}a(void 0)})}}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,R(r.key),r)}}function R(e){var t=function(e){if("object"!=U(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==U(t)?t:t+""}var L=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.credentials=null,this.isInitialized=!1,this.validationErrors=[]},t=[{key:"isBrowserMode",get:function(){return"undefined"!=typeof window}},{key:"initialize",value:(i=_(M().m(function e(){var t;return M().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("🔐 Initializing secure credential manager..."),e.n=1,this.loadEnvironmentVariables();case 1:if(!this.isBrowserMode){e.n=2;break}return console.log("✅ Using Google Meet Add-ons platform authentication"),this.isInitialized=!0,e.a(2,!0);case 2:if(this.validateCredentials(),0!==this.validationErrors.length){e.n=4;break}return e.n=3,this.initializeGoogleAuth();case 3:this.isInitialized=!0,console.log("✅ Secure credential manager initialized successfully"),e.n=5;break;case 4:throw new Error("Credential validation failed: ".concat(this.validationErrors.join(", ")));case 5:return e.a(2,!0);case 6:throw e.p=6,t=e.v,console.error("❌ Failed to initialize secure credential manager:",t),t;case 7:return e.a(2)}},e,this,[[0,6]])})),function(){return i.apply(this,arguments)})},{key:"loadEnvironmentVariables",value:(o=_(M().m(function e(){var t;return M().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!this.isBrowserMode){e.n=1;break}return console.warn("⚠️ Running in browser environment - credentials should be provided securely"),this.credentials={cloudProjectNumber:process.env.CLOUD_PROJECT_NUMBER||"409997382473",deepgramApiKey:process.env.DEEPGRAM_API_KEY||"",attendeeApiKey:process.env.ATTENDEE_API_KEY||"",claudeApiKey:process.env.ANTHROPIC_API_KEY||process.env.CLAUDE_API_KEY||"",oauthClientId:process.env.OAUTH_CLIENT_ID||"409997382473-c9kq9iijvgibd139ngrg8acitiip22vl.apps.googleusercontent.com",proxyUrl:process.env.MEET_PROXY_URL||("undefined"==typeof window||"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname?null:"http://localhost:8787"),mainStageUrl:process.env.MAIN_STAGE_URL||window.location.origin+"/mainstage.html",sidePanelUrl:process.env.SIDE_PANEL_URL||window.location.origin+"/sidepanel.html",eventsBackendUrl:process.env.EVENTS_BACKEND_URL||null,nodeEnv:"production",logLevel:"info"},console.log("📋 Browser environment credentials loaded"),e.a(2);case 1:this.credentials={serviceAccountEmail:process.env.SERVICE_ACCOUNT_EMAIL,privateKey:process.env.SERVICE_ACCOUNT_PRIVATE_KEY,clientId:process.env.CLIENT_ID,cloudProjectNumber:process.env.CLOUD_PROJECT_NUMBER,deepgramApiKey:process.env.DEEPGRAM_API_KEY,attendeeApiKey:process.env.ATTENDEE_API_KEY||"",claudeApiKey:process.env.ANTHROPIC_API_KEY||process.env.CLAUDE_API_KEY||"",mainStageUrl:process.env.MAIN_STAGE_URL,sidePanelUrl:process.env.SIDE_PANEL_URL,nodeEnv:"production",logLevel:process.env.LOG_LEVEL||"info"},console.log("📋 Environment variables loaded"),e.n=3;break;case 2:throw e.p=2,t=e.v,console.error("❌ Error loading environment variables:",t),t;case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return o.apply(this,arguments)})},{key:"validateCredentials",value:function(){var e=this;this.validationErrors=[],this.isBrowserMode?console.log("✅ Skipping credential validation in browser environment"):([{key:"serviceAccountEmail",name:"SERVICE_ACCOUNT_EMAIL"},{key:"privateKey",name:"SERVICE_ACCOUNT_PRIVATE_KEY"},{key:"clientId",name:"CLIENT_ID"},{key:"cloudProjectNumber",name:"CLOUD_PROJECT_NUMBER"},{key:"deepgramApiKey",name:"DEEPGRAM_API_KEY"}].forEach(function(t){e.credentials&&e.credentials[t.key]&&"YOUR_PRIVATE_KEY_HERE"!==e.credentials[t.key]&&"YOUR_DEEPGRAM_API_KEY_HERE"!==e.credentials[t.key]||e.validationErrors.push("Missing or placeholder value for ".concat(t.name))}),this.credentials&&this.credentials.privateKey&&!this.credentials.privateKey.includes("BEGIN PRIVATE KEY")&&this.validationErrors.push("SERVICE_ACCOUNT_PRIVATE_KEY must be in PEM format"),this.credentials&&this.credentials.serviceAccountEmail&&!this.credentials.serviceAccountEmail.includes("@")&&this.validationErrors.push("SERVICE_ACCOUNT_EMAIL must be a valid email address"),this.credentials&&this.credentials.clientId&&!this.credentials.clientId.includes(".apps.googleusercontent.com")&&this.validationErrors.push("CLIENT_ID must be a valid Google OAuth client ID"),this.validationErrors.length>0?console.error("❌ Credential validation errors:",this.validationErrors):console.log("✅ All credentials validated successfully"))}},{key:"initializeGoogleAuth",value:(r=_(M().m(function e(){return M().w(function(e){for(;;)switch(e.n){case 0:try{this.isBrowserMode?(console.log("✅ Using browser-compatible authentication for Google Meet Add-ons"),this.googleAuth={isBrowserMode:!0,platform:"google-meet-addons"},console.log("✅ Browser authentication initialized")):console.warn("⚠️ Running in Node.js environment - Google Meet Add-ons require browser environment")}catch(e){console.warn("⚠️ Authentication initialization warning:",e.message)}case 1:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"getCredentials",value:function(){if(!this.isInitialized)throw new Error("Credential manager not initialized. Call initialize() first.");if(this.isBrowserMode)return{cloudProjectNumber:this.credentials.cloudProjectNumber,deepgramApiKey:this.credentials.deepgramApiKey,attendeeApiKey:this.credentials.attendeeApiKey,claudeApiKey:this.credentials.claudeApiKey,oauthClientId:this.credentials.oauthClientId,proxyUrl:this.credentials.proxyUrl,mainStageUrl:this.credentials.mainStageUrl,sidePanelUrl:this.credentials.sidePanelUrl,nodeEnv:this.credentials.nodeEnv,logLevel:this.credentials.logLevel,isBrowserMode:!0};if(this.validationErrors.length>0)throw new Error("Invalid credentials: ".concat(this.validationErrors.join(", ")));return{serviceAccountEmail:this.credentials.serviceAccountEmail,privateKey:this.credentials.privateKey,clientId:this.credentials.clientId,cloudProjectNumber:this.credentials.cloudProjectNumber,deepgramApiKey:this.credentials.deepgramApiKey,attendeeApiKey:this.credentials.attendeeApiKey,claudeApiKey:this.credentials.claudeApiKey,mainStageUrl:this.credentials.mainStageUrl,sidePanelUrl:this.credentials.sidePanelUrl,nodeEnv:this.credentials.nodeEnv,logLevel:this.credentials.logLevel}}},{key:"getGoogleAuthClient",value:(n=_(M().m(function e(){return M().w(function(e){for(;;)switch(e.n){case 0:if(this.isInitialized){e.n=1;break}throw new Error("Credential manager not initialized");case 1:if(!this.googleAuth||!this.googleAuth.isBrowserMode){e.n=2;break}return e.a(2,{isBrowserMode:!0,platform:"google-meet-addons",getAccessToken:function(){var e=_(M().m(function e(){return M().w(function(e){for(;;)if(0===e.n)return console.log("Using Google Meet Add-ons platform authentication"),e.a(2,{token:"platform-managed"})},e)}));return function(){return e.apply(this,arguments)}}()});case 2:return e.a(2,null)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"isValid",value:function(){return this.isInitialized&&(this.isBrowserMode||0===this.validationErrors.length)}},{key:"getValidationErrors",value:function(){return this.validationErrors}},{key:"logSecurityStatus",value:function(){var e,t;console.log("🔒 Security Status:"),console.log("  - Credential Manager Initialized: ".concat(this.isInitialized)),console.log("  - Browser Mode: ".concat(this.isBrowserMode)),console.log("  - Validation Errors: ".concat(this.validationErrors.length)),console.log("  - Environment: ".concat((null===(e=this.credentials)||void 0===e?void 0:e.nodeEnv)||"unknown")),console.log("  - Log Level: ".concat((null===(t=this.credentials)||void 0===t?void 0:t.logLevel)||"unknown")),this.validationErrors.length>0&&console.log("  - Validation Errors:",this.validationErrors)}}],t&&N(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i}());function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function z(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return B(l,"_invoke",function(n,r,o){var i,s,c,l=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,i=u[t],f=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=f&&((o=n<2&&f<i[1])?(s=0,p.v=r,p.n=i[1]):f<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,h),s=u,c=h;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(p.n=-1),f(s,c)):p.n=c:p.v=c);try{if(l=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?c:n.call(r,p))!==a)break}catch(t){i=e,s=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,i),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(B(t={},r,function(){return this}),t),d=l.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,B(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,B(d,"constructor",l),B(l,"constructor",c),c.displayName="GeneratorFunction",B(l,o,"GeneratorFunction"),B(d),B(d,o,"Generator"),B(d,r,function(){return this}),B(d,"toString",function(){return"[object Generator]"}),(z=function(){return{w:i,m:p}})()}function B(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}B=function(e,t,n,r){function i(t,n){B(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},B(e,t,n,r)}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach(function(t){K(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function K(e,t,n){return(t=function(e){var t=function(e){if("object"!=G(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==G(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function $(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){W(i,r,o,a,s,"next",e)}function s(e){W(i,r,o,a,s,"throw",e)}a(void 0)})}}var q,J,Y,V=null,H=null,X=null,Q=null,Z=null,ee=new Map,te=!1,ne=[],re=null,oe=null,ie=null;function ae(){return se.apply(this,arguments)}function se(){return(se=$(z().m(function e(){var t,n;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("🔐 Initializing secure credentials..."),e.n=1,L.initialize();case 1:return V=L.getCredentials(),H=V.cloudProjectNumber,V.deepgramApiKey,X=V.attendeeApiKey,Q=V.claudeApiKey,Z=V.mainStageUrl,L.logSecurityStatus(),console.log("✅ Secure credentials initialized successfully"),e.a(2,!0);case 2:throw e.p=2,n=e.v,console.error("❌ Failed to initialize secure credentials:",n),(t=L.getValidationErrors()).length>0&&(console.error("Validation errors:",t),console.error("Please check your configuration and ensure all required credentials are set.")),n;case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function ce(){return le.apply(this,arguments)}function le(){return le=$(z().m(function e(){var t,n,r,o=arguments;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:null,e.p=1,console.log("Initializing Meet Media API..."),V){e.n=2;break}throw new Error("Credentials not initialized. Call initializeSecureCredentials() first.");case 2:return t&&(V.meetSession=t,console.log("✅ Meet session added to credentials for real API access")),(ie=new l(V)).onParticipantJoined=function(e){console.log("Participant joined:",e),ee.set(e.id,e),Ee()},ie.onParticipantLeft=function(e){console.log("Participant left:",e),ee.delete(e.id),Ee()},ie.onAudioData=function(e){ue(e)},ie.onError=function(e){console.error("Meet Media API error:",e),$e("Meet Media API error: "+e.message,"error")},e.n=3,ie.initializeAuth();case 3:return console.log("✅ Meet Media API initialized successfully"),console.log("📋 Note: This implementation uses the official Google Meet Media API"),console.log("📋 Requirements: Google Meet REST API must be enabled and Developer Preview enrollment"),e.p=4,e.n=5,ie.startParticipantTracking();case 5:e.n=7;break;case 6:e.p=6,n=e.v,console.warn("Participant tracking failed to start:",n);case 7:return e.a(2,!0);case 8:return e.p=8,r=e.v,console.error("❌ Failed to initialize Meet Media API:",r),$e("Failed to initialize Meet Media API: "+r.message,"error"),e.a(2,!1)}},e,null,[[4,6],[1,8]])})),le.apply(this,arguments)}function ue(e){var t=e.participantId,n=e.participantName;e.audioData,e.timestamp,console.log("Audio from ".concat(n," (").concat(t,")"))}function de(){console.log("Initializing Google Meet Transcript API...");try{(oe=new C(V)).onTranscriptUpdate=function(e){!function(e){var t=e.speakerName,n=e.transcription;if(n&&n.trim()){var r=document.getElementById("transcript-container");if(r){var o=document.createElement("div"),i=t||"Speaker";o.textContent="".concat(i,": ").concat(n),o.style.color=!1===e.isFinal?"#555":"#111",o.style.fontStyle=!1===e.isFinal?"italic":"normal",r.appendChild(o),r.scrollTop=r.scrollHeight,ne.push("".concat(i,": ").concat(n))}}}(e)},oe.onError=function(e){console.error("Google Meet Transcript API error:",e),$e("Transcript API error: "+e.message,"error")},console.log("✅ Google Meet Transcript API initialized successfully")}catch(e){console.error("Error initializing Google Meet Transcript API:",e),$e("Error initializing Transcript API: "+e.message,"error")}}function pe(){console.log("Initializing Attendee Integration...");try{var e,t,n,r;if(!X)return void console.warn("⚠️ Attendee API key not found. Attendee transcription will not be available.");var o=(null===(e=V)||void 0===e?void 0:e.attendeeWebhookUrl)||"undefined"!=typeof process&&(null===(t=process.env)||void 0===t?void 0:t.ATTENDEE_WEBHOOK_URL)||null,i=(null===(n=V)||void 0===n?void 0:n.proxyUrl)||(null===(r=V)||void 0===r?void 0:r.proxyServerUrl);if(!i)if("undefined"!=typeof window){var a=window.location.hostname;"localhost"===a||"127.0.0.1"===a||(console.warn("[Attendee] ⚠️ Running from production domain but no proxy URL configured. Requests will fail."),console.warn("[Attendee] Set MEET_PROXY_URL environment variable or configure proxyUrl in credentials.")),i="http://localhost:8787"}else i="http://localhost:8787";console.log("[Attendee] Initializing with proxy URL:",i),console.log("[Attendee] Current location:","undefined"!=typeof window?window.location.href:"N/A"),re=new k(X,F(F({},V),{},{proxyServerUrl:i,proxyUrl:i}),{sidePanelClient:q,mainStageClient:J}),o?(re.setWebhookUrl(o),console.log("✅ Webhook URL configured for real-time transcript updates")):console.log("ℹ️ No webhook URL configured, will use API polling (slower but works without webhook setup)"),re.onTranscriptUpdate=function(e){!function(e){var t=e.speakerName,n=e.transcription,r=e.timestamp,o=(e.duration,e.isPlaceholder);if(n&&n.trim()){var i=document.getElementById("transcript-container");if(i){if(o){var a=i.querySelector('[data-placeholder="true"]');a&&a.remove()}else{var s=i.querySelector('[data-placeholder="true"]');s&&s.remove()}var c=document.createElement("div");c.style.cssText="\n      margin-bottom: 8px;\n      padding: 8px;\n      background: ".concat(o?"#fff3cd":"#f8f9fa",";\n      border-left: 3px solid ").concat(o?"#ffc107":"#9c27b0",";\n      border-radius: 4px;\n    "),o&&c.setAttribute("data-placeholder","true");var l=t||"Speaker",u="";r&&!o&&(u=new Date(r>1e12?r:1e3*r).toLocaleTimeString()),c.innerHTML='\n      <div style="font-weight: 600; color: '.concat(o?"#856404":"#9c27b0",'; font-size: 13px; margin-bottom: 4px;">\n        ').concat(l," ").concat(u?'<span style="color: #5f6368; font-weight: normal; font-size: 11px;">('.concat(u,")</span>"):"",'\n      </div>\n      <div style="color: ').concat(o?"#856404":"#202124","; font-size: 14px; line-height: 1.5; font-style: ").concat(o?"italic":"normal",';">\n        ').concat(n,"\n      </div>\n    "),i.appendChild(c),i.scrollTop=i.scrollHeight}o||ne.push("".concat(t||"Speaker",": ").concat(n))}}(e)},re.onBotStatusChange=function(e){console.log("Attendee bot status changed:",e),$e("Attendee bot: ".concat(e.status),"active"===e.status?"success":"info")},re.onError=function(e){console.error("Attendee Integration error:",e),$e("Attendee error: "+e.message,"error")},console.log("✅ Attendee Integration initialized successfully")}catch(e){console.error("Error initializing Attendee Integration:",e),$e("Error initializing Attendee: "+e.message,"error")}}function fe(){return he.apply(this,arguments)}function he(){return(he=$(z().m(function e(){var n,r,o,i,a,s,c,l,u;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,ae();case 1:return e.n=2,t.addon.createAddonSession({cloudProjectNumber:H});case 2:return n=e.v,e.n=3,n.createSidePanelClient();case 3:return q=e.v,e.n=4,ce(n);case 4:if(e.v){e.n=5;break}throw new Error("Failed to initialize Meet Media API");case 5:r=document.getElementById("start-activity"),o=document.getElementById("start-transcript"),i=document.getElementById("stop-transcript"),(a=document.getElementById("oauth-authorize-btn"))&&a.addEventListener("click",$(z().m(function e(){return z().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Ue();case 1:return e.a(2)}},e)}))),r&&r.addEventListener("click",$(z().m(function e(){var t;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,q.startActivity({mainStageUrl:Z});case 1:$e("Activity started successfully!","success"),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error starting activity:",t),$e("Error starting activity: "+t.message,"error");case 3:return e.a(2)}},e,null,[[0,2]])}))),o&&o.addEventListener("click",Ae),i&&i.addEventListener("click",ze),de(),pe(),s=document.getElementById("start-attendee-transcript"),c=document.getElementById("stop-attendee-transcript"),s&&s.addEventListener("click",De),c&&c.addEventListener("click",Ke),(l=document.getElementById("ai-send-btn"))&&l.addEventListener("click",qe),console.log("Add-on initialized successfully"),$e("Add-on loaded successfully!","success"),e.n=7;break;case 6:e.p=6,u=e.v,console.error("Error setting up add-on:",u),$e("Error initializing add-on: "+u.message,"error");case 7:return e.a(2)}},e,null,[[0,6]])}))).apply(this,arguments)}function ge(){return me.apply(this,arguments)}function me(){return(me=$(z().m(function e(){var n,r;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,V){e.n=1;break}return e.n=1,ae();case 1:return e.n=2,t.addon.createAddonSession({cloudProjectNumber:H});case 2:return n=e.v,e.n=3,n.createMainStageClient();case 3:return J=e.v,ie&&V&&(V.meetSession=n,console.log("✅ Meet session updated for main stage")),ke(),e.n=4,ye();case 4:console.log("Main stage initialized successfully"),e.n=6;break;case 5:e.p=5,r=e.v,console.error("Error initializing main stage:",r);case 6:return e.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function ye(){return ve.apply(this,arguments)}function ve(){return(ve=$(z().m(function e(){var t,n;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("Joining current meeting as media bot..."),ie){e.n=1;break}throw new Error("Meet Media API not initialized");case 1:return e.n=2,we();case 2:if(!(t=e.v)){e.n=4;break}return e.n=3,ie.joinConference(t);case 3:console.log("✅ Successfully joined conference using Meet Media API"),e.n=5;break;case 4:console.log("No active meeting found, using fallback mode"),console.log("📋 Note: Conference ID is required for Meet Media API access");case 5:e.n=7;break;case 6:e.p=6,n=e.v,console.error("Error joining meeting:",n),$e("Error joining meeting: "+n.message,"error");case 7:return e.a(2)}},e,null,[[0,6]])}))).apply(this,arguments)}function we(){return be.apply(this,arguments)}function be(){return(be=$(z().m(function e(){var t,n,r,o,i;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!J||!J.getMeetingInfo){e.n=2;break}return e.n=1,J.getMeetingInfo();case 1:return t=e.v,e.a(2,(null==t?void 0:t.meetingId)||(null==t?void 0:t.id));case 2:if(!q||!q.getMeetingInfo){e.n=4;break}return e.n=3,q.getMeetingInfo();case 3:return n=e.v,e.a(2,(null==n?void 0:n.meetingId)||(null==n?void 0:n.id));case 4:if(r=new URLSearchParams(window.location.search),!(o=r.get("meetingId")||r.get("id"))){e.n=5;break}return e.a(2,o);case 5:if(!window.meet||!window.meet.getMeetingId){e.n=7;break}return e.n=6,window.meet.getMeetingId();case 6:return e.a(2,e.v);case 7:return e.a(2,null);case 8:return e.p=8,i=e.v,console.error("Error getting meeting ID:",i),e.a(2,null)}},e,null,[[0,8]])}))).apply(this,arguments)}function ke(){var e,t,n=document.createElement("div");n.id="transcript-container",n.style.cssText="\n    width: 100%;\n    height: 100vh;\n    padding: 20px;\n    font-family: 'Google Sans', Arial, sans-serif;\n    background: #f8f9fa;\n    box-sizing: border-box;\n  ";var r=document.createElement("div");r.style.cssText="\n    background: white;\n    padding: 20px;\n    border-radius: 8px;\n    margin-bottom: 20px;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  ",r.innerHTML='\n    <h1 style="color: #1a73e8; margin: 0 0 20px 0; font-size: 28px;">🎤 Live Transcript</h1>\n    <div style="display: flex; gap: 10px; margin-bottom: 10px;">\n      <button id="start-transcript-btn" style="\n        padding: 12px 24px; \n        background: #34a853; \n        color: white; \n        border: none; \n        border-radius: 6px; \n        cursor: pointer;\n        font-size: 16px;\n        font-weight: 500;\n        transition: background-color 0.2s;\n      ">Start Live Transcript</button>\n      <button id="stop-transcript-btn" style="\n        padding: 12px 24px; \n        background: #ea4335; \n        color: white; \n        border: none; \n        border-radius: 6px; \n        cursor: pointer;\n        font-size: 16px;\n        font-weight: 500;\n        transition: background-color 0.2s;\n        opacity: 0.6;\n        cursor: not-allowed;\n      " disabled>Stop Transcript</button>\n    </div>\n    <div id="transcript-status" style="\n      padding: 10px;\n      border-radius: 4px;\n      font-size: 14px;\n      background: #e8f0fe;\n      color: #1a73e8;\n      display: none;\n    ">Ready to start transcription</div>\n  ';var o=document.createElement("div");o.id="transcript-area",o.style.cssText="\n    background: white;\n    border: 1px solid #dadce0;\n    border-radius: 8px;\n    padding: 20px;\n    height: calc(100vh - 200px);\n    overflow-y: auto;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  ",n.appendChild(r),n.appendChild(o),document.body.appendChild(n),Y=o,null===(e=document.getElementById("start-transcript-btn"))||void 0===e||e.addEventListener("click",Ae),null===(t=document.getElementById("stop-transcript-btn"))||void 0===t||t.addEventListener("click",ze)}function Ee(){if(Y)if(Y.innerHTML="",0!==ee.size){if(ee.forEach(function(e,t){var n=document.createElement("div");n.style.cssText="\n      margin-bottom: 20px;\n      padding: 20px;\n      border: 2px solid ".concat(e.isSpeaking?"#1a73e8":"#e0e0e0",";\n      border-radius: 12px;\n      background: ").concat(e.isSpeaking?"#e8f0fe":"#ffffff",";\n      transition: all 0.3s ease;\n      position: relative;\n    ");var r=e.isSpeaking?'\n      <div style="\n        position: absolute;\n        top: 10px;\n        right: 15px;\n        background: #1a73e8;\n        color: white;\n        padding: 4px 8px;\n        border-radius: 12px;\n        font-size: 12px;\n        font-weight: 500;\n        animation: pulse 1s infinite;\n      ">🎤 Speaking</div>\n    ':"";n.innerHTML="\n      ".concat(r,'\n      <div style="\n        display: flex;\n        align-items: center;\n        margin-bottom: 15px;\n        font-weight: 600;\n        color: #1a73e8;\n        font-size: 18px;\n      ">\n        <span style="font-size: 24px; margin-right: 10px;">').concat(e.isLocal?"👤":"👥","</span>\n        ").concat(e.name,'\n      </div>\n      <div style="\n        color: #5f6368;\n        line-height: 1.6;\n        font-size: 16px;\n        min-height: 24px;\n      ">\n        ').concat(e.transcript||'<span style="color: #9aa0a6; font-style: italic;">No transcript yet...</span>',"\n      </div>\n      ").concat(e.lastSpoke?'\n        <div style="\n          color: #9aa0a6;\n          font-size: 12px;\n          margin-top: 10px;\n          text-align: right;\n        ">\n          Last spoke: '.concat(e.lastSpoke,"\n        </div>\n      "):"","\n    "),Y.appendChild(n)}),!document.getElementById("transcript-styles")){var e=document.createElement("style");e.id="transcript-styles",e.textContent="\n      @keyframes pulse {\n        0% { opacity: 1; }\n        50% { opacity: 0.5; }\n        100% { opacity: 1; }\n      }\n    ",document.head.appendChild(e)}}else Y.innerHTML='\n      <div style="\n        text-align: center; \n        color: #5f6368; \n        padding: 40px;\n        font-size: 16px;\n      ">\n        No participants detected. Waiting for participants to join...\n      </div>\n    '}function Ae(){return Se.apply(this,arguments)}function Se(){return(Se=$(z().m(function e(){var t,n,r,o,i,a,s,c,l,u,d,p,f,h,g,m;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("Starting transcript with Google Meet API..."),e.p=1,oe){e.n=2;break}throw new Error("Google Meet Transcript API not initialized.");case 2:if(n=document.getElementById("start-transcript")||document.getElementById("start-transcript-btn"),r=document.getElementById("stop-transcript")||document.getElementById("stop-transcript-btn"),o=document.getElementById("transcript-status"),i=document.getElementById("meeting-url-input-container"),a=document.getElementById("meeting-url-input"),s=document.getElementById("space-name-input"),c=s&&s.value?s.value.trim():"",l=null==a||null===(t=a.value)||void 0===t?void 0:t.trim()){e.n=4;break}return e.n=3,Te();case 3:l=e.v;case 4:if(l){e.n=5;break}throw i&&(i.style.display="block"),new Error("Could not detect meeting code. Please enter it manually.");case 5:return n&&(n.disabled=!0),r&&(r.disabled=!1),o&&(o.style.display="block",o.style.background="#e8f0fe",o.style.color="#1a73e8",o.textContent="🔄 Connecting to Google Meet API and starting transcription..."),e.n=6,Pe();case 6:if(u=e.v){e.n=8;break}return o&&(o.style.background="#fff3cd",o.style.color="#856404",o.textContent="⚠️ Authentication required. Please enter your access token."),e.n=7,Le();case 7:if(u=e.v){e.n=8;break}throw new Error("Access token is required to use Google Meet API. Please authenticate.");case 8:if(!c||!c.startsWith("spaces/")){e.n=10;break}return d=V&&V.deepgramApiKey?V.deepgramApiKey:window.process&&window.process.env&&window.process.env.DEEPGRAM_API_KEY||"",e.n=9,oe.startRealtimeAudio(c,u,d);case 9:e.n=11;break;case 10:return e.n=11,oe.startTranscription(l,u);case 11:i&&(i.style.display="none"),te=!0,o&&(o.style.background="#e8f5e8",o.style.color="#137333",o.textContent="🎤 Live transcription active - receiving transcripts from Google Meet API"),console.log("✅ Transcription started successfully with Google Meet API"),e.n=13;break;case 12:e.p=12,m=e.v,console.error("Error starting transcription:",m),$e("Error starting transcription: "+m.message,"error"),(m.message.includes("Could not detect")||m.message.includes("meeting code"))&&(p=document.getElementById("meeting-url-input-container"))&&(p.style.display="block"),f=document.getElementById("start-transcript")||document.getElementById("start-transcript-btn"),h=document.getElementById("stop-transcript")||document.getElementById("stop-transcript-btn"),g=document.getElementById("transcript-status"),f&&(f.disabled=!1),h&&(h.disabled=!0),g&&(g.style.background="#fce8e6",g.style.color="#d93025",g.textContent="❌ Failed to start transcription: "+m.message);case 13:return e.a(2)}},e,null,[[1,12]])}))).apply(this,arguments)}function Te(){return Ie.apply(this,arguments)}function Ie(){return(Ie=$(z().m(function e(){var t,n,r,o,i,a,s,c;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!q){e.n=3;break}return e.n=1,null===(n=(r=q).getMeetingInfo)||void 0===n?void 0:n.call(r);case 1:if(null==(o=e.v)||!o.meetingCode){e.n=2;break}return e.a(2,o.meetingCode);case 2:if(null==o||!o.meetingUrl){e.n=3;break}return e.a(2,o.meetingUrl);case 3:if(null===(t=V)||void 0===t||!t.meetSession){e.n=6;break}return e.n=4,null===(i=(a=V.meetSession).getMeetingInfo)||void 0===i?void 0:i.call(a);case 4:if(null==(s=e.v)||!s.meetingCode){e.n=5;break}return e.a(2,s.meetingCode);case 5:if(null==s||!s.meetingUrl){e.n=6;break}return e.a(2,s.meetingUrl);case 6:return e.a(2,null);case 7:return e.p=7,c=e.v,console.warn("Error getting meeting code from session:",c),e.a(2,null)}},e,null,[[0,7]])}))).apply(this,arguments)}function Pe(){return xe.apply(this,arguments)}function xe(){return(xe=$(z().m(function e(){var t,n,r,o,i,a,s,c,l,u,d,p,f,h,g,m,y;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("Attempting to get access token from Meet session..."),!q){e.n=5;break}if(e.p=1,!q.getAccessToken){e.n=3;break}return e.n=2,q.getAccessToken();case 2:if(r=e.v,!(o=(null==r?void 0:r.token)||(null==r?void 0:r.accessToken)||r)||"platform-managed"===o){e.n=3;break}return console.log("✅ Got access token from sidePanelClient"),e.a(2,o);case 3:e.n=5;break;case 4:e.p=4,p=e.v,console.warn("Error getting token from sidePanelClient:",p);case 5:if(!J){e.n=10;break}if(e.p=6,!J.getAccessToken){e.n=8;break}return e.n=7,J.getAccessToken();case 7:if(i=e.v,!(a=(null==i?void 0:i.token)||(null==i?void 0:i.accessToken)||i)||"platform-managed"===a){e.n=8;break}return console.log("✅ Got access token from mainStageClient"),e.a(2,a);case 8:e.n=10;break;case 9:e.p=9,f=e.v,console.warn("Error getting token from mainStageClient:",f);case 10:if(null===(t=V)||void 0===t||!t.meetSession){e.n=16;break}if(e.p=11,!V.meetSession.getAccessToken){e.n=13;break}return e.n=12,V.meetSession.getAccessToken();case 12:if(s=e.v,!(c=(null==s?void 0:s.token)||(null==s?void 0:s.accessToken)||s)||"platform-managed"===c){e.n=13;break}return console.log("✅ Got access token from meetSession"),e.a(2,c);case 13:if(!V.meetSession.token){e.n=14;break}return console.log("✅ Got access token from meetSession.token"),e.a(2,V.meetSession.token);case 14:e.n=16;break;case 15:e.p=15,h=e.v,console.warn("Error getting token from meetSession:",h);case 16:if(null===(n=V)||void 0===n||!n.accessToken){e.n=17;break}return console.log("✅ Using access token from credentials"),e.a(2,V.accessToken);case 17:if(!(window.google&&window.google.accounts&&window.google.accounts.oauth2)){e.n=22;break}return e.p=18,e.n=19,Oe();case 19:if(!(l=e.v)){e.n=20;break}return console.log("✅ Got access token from Google OAuth"),e.a(2,l);case 20:e.n=22;break;case 21:e.p=21,g=e.v,console.warn("Error getting token from Google OAuth:",g);case 22:if(window.google&&window.google.accounts){e.n=29;break}return console.log("Loading Google Identity Services..."),e.n=23,Ce();case 23:return e.n=24,new Promise(function(e){return setTimeout(e,1e3)});case 24:if(!(window.google&&window.google.accounts&&window.google.accounts.oauth2)){e.n=29;break}return e.p=25,e.n=26,Oe();case 26:if(!(u=e.v)){e.n=27;break}return console.log("✅ Got access token from Google OAuth"),e.a(2,u);case 27:e.n=29;break;case 28:e.p=28,m=e.v,console.warn("Error getting token from Google OAuth:",m);case 29:return console.warn("⚠️ Access token not found. Starting OAuth flow..."),e.n=30,Ne();case 30:return d=e.v,e.a(2,d);case 31:return e.p=31,y=e.v,console.error("Error getting access token:",y),e.n=32,Le();case 32:return e.a(2,e.v)}},e,null,[[25,28],[18,21],[11,15],[6,9],[1,4],[0,31]])}))).apply(this,arguments)}function Ce(){return new Promise(function(e){if(window.google&&window.google.accounts)e();else{var t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.async=!0,t.defer=!0,t.onload=function(){console.log("Google Identity Services loaded"),e()},t.onerror=function(){console.warn("Failed to load Google Identity Services"),e()},document.head.appendChild(t)}})}function Ue(){return Me.apply(this,arguments)}function Me(){return(Me=$(z().m(function e(){var t,n,r,o,i,a;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("oauth-authorize-btn"),document.getElementById("auth-status"),n=document.getElementById("oauth-client-id")){e.n=1;break}return je("Error: Client ID input field not found","error"),e.a(2);case 1:if(r=n.value.trim()){e.n=2;break}return je("Please enter your OAuth Web Client ID","error"),e.a(2);case 2:return V&&(V.oauthClientId=r),t&&(t.disabled=!0,t.textContent="⏳ Authorizing..."),je("Loading Google Identity Services...","info"),e.p=3,e.n=4,Ce();case 4:o=0;case 5:if(window.google&&window.google.accounts&&window.google.accounts.oauth2||!(o<10)){e.n=7;break}return e.n=6,new Promise(function(e){return setTimeout(e,200)});case 6:o++,e.n=5;break;case 7:if(window.google&&window.google.accounts&&window.google.accounts.oauth2){e.n=8;break}throw new Error("Google Identity Services failed to load. Please refresh the page.");case 8:return je("Requesting authorization...","info"),e.n=9,Oe(r);case 9:if(!(i=e.v)){e.n=10;break}je("✅ Authorization successful! Access token acquired.","success"),t&&(t.textContent="✅ Authorized",t.style.background="#34a853"),V&&(V.accessToken=i),e.n=11;break;case 10:throw new Error("Failed to get access token");case 11:e.n=13;break;case 12:e.p=12,a=e.v,console.error("OAuth authorization error:",a),je("❌ Authorization failed: "+(a.message||"Unknown error"),"error"),t&&(t.disabled=!1,t.textContent="🔐 Authorize",t.style.background="#4285f4"),a.message&&a.message.includes("redirect_uri_mismatch")?je('❌ Error: redirect_uri_mismatch\n\nTo fix this in Google Cloud Console:\n1. Go to APIs & Services → Credentials\n2. Click your OAuth 2.0 Client ID\n3. Under "Authorized redirect URIs", click "+ Add URI"\n4. Add: http://localhost:8081\n5. Add: http://127.0.0.1:8081\n6. Click "Save"\n7. Wait 2-5 minutes, then try again\n\nNote: Redirect URIs are required for GSI popup-based OAuth',"error"):a.message&&a.message.includes("popup_closed")?je("❌ Popup was closed. Please click Authorize again and complete the authorization. Make sure popups are allowed for this site.","error"):a.message&&a.message.includes("access_denied")&&je("❌ Authorization denied. Please try again and grant all requested permissions.","error");case 13:return e.a(2)}},e,null,[[3,12]])}))).apply(this,arguments)}function je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("auth-status");if(n){if(e.includes("\n")||e.includes("<")){var r=e.replace(/\n/g,"<br>");n.innerHTML=r}else n.textContent=e;n.style.display="block","success"===t?(n.style.background="#e8f5e8",n.style.color="#137333",n.style.border="1px solid #34a853"):"error"===t?(n.style.background="#fce8e6",n.style.color="#d93025",n.style.border="1px solid #ea4335"):(n.style.background="#e8f0fe",n.style.color="#1a73e8",n.style.border="1px solid #1a73e8")}}function Oe(){return _e.apply(this,arguments)}function _e(){return _e=$(z().m(function e(){var t,n=arguments;return z().w(function(e){for(;;)if(0===e.n)return t=n.length>0&&void 0!==n[0]?n[0]:null,e.a(2,new Promise(function(e,n){if(window.google&&window.google.accounts&&window.google.accounts.oauth2){var r,o=t;if(!o){var i=document.getElementById("oauth-client-id");i&&(o=i.value.trim())}if(o||(o=(null===(r=V)||void 0===r?void 0:r.oauthClientId)||"409997382473-c9kq9iijvgibd139ngrg8acitiip22vl.apps.googleusercontent.com"),o)try{window.google.accounts.oauth2.initTokenClient({client_id:o,scope:["https://www.googleapis.com/auth/meetings.space.readonly","https://www.googleapis.com/auth/meetings.conference.media.audio.readonly","https://www.googleapis.com/auth/documents.readonly"].join(" "),callback:function(t){if(t&&t.access_token){var r=t.access_token;console.log("✅ OAuth access token acquired"),V&&(V.accessToken=r,V.oauthClientId=o),e(r)}else t&&t.error?n(new Error(t.error+(t.error_description?": "+t.error_description:""))):n(new Error("Failed to get access token from OAuth"))},error_callback:function(e){console.error("OAuth error:",e);var t=e.message||e.type||"OAuth authorization failed";n(new Error(t))}}).requestAccessToken({prompt:"consent"})}catch(e){n(e)}else n(new Error("OAuth Client ID not configured"))}else n(new Error("Google Identity Services not available"))}))},e)})),_e.apply(this,arguments)}function Ne(){return Re.apply(this,arguments)}function Re(){return(Re=$(z().m(function e(){return z().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e){var t=document.getElementById("auth-token-input-container");if(document.getElementById("auth-token-input"),t){t.innerHTML='\n        <div style="margin-bottom: 10px;">\n          <strong style="color: #856404;">🔐 Google OAuth Authorization Required</strong>\n        </div>\n        <div style="font-size: 12px; color: #856404; margin-bottom: 15px;">\n          Click the button below to authorize with Google. This will open a popup to grant permissions.\n        </div>\n        <button id="oauth-authorize-btn" class="btn btn-success" style="width: 100%; background: #4285f4;">\n          🔐 Authorize with Google\n        </button>\n        <div style="font-size: 11px; color: #856404; margin-top: 10px; text-align: center;">\n          Or <a href="#" id="manual-token-link" style="color: #1a73e8;">enter token manually</a>\n        </div>\n      ',t.style.display="block";var n=document.getElementById("oauth-authorize-btn"),r=document.getElementById("manual-token-link");n&&n.addEventListener("click",$(z().m(function o(){var i,a;return z().w(function(o){for(;;)switch(o.p=o.n){case 0:return n.disabled=!0,n.textContent="⏳ Authorizing...",o.p=1,o.n=2,Ce();case 2:return o.n=3,new Promise(function(e){return setTimeout(e,500)});case 3:return o.n=4,Oe();case 4:if(!(i=o.v)){o.n=5;break}t.style.display="none",e(i),o.n=6;break;case 5:throw new Error("Authorization failed");case 6:o.n=8;break;case 7:o.p=7,a=o.v,console.error("OAuth authorization error:",a),n.disabled=!1,n.textContent="🔐 Authorize with Google",alert("Authorization failed: "+(a.message||"Unknown error")),r&&r.click();case 8:return o.a(2)}},o,null,[[1,7]])}))),r&&r.addEventListener("click",function(n){n.preventDefault(),t.innerHTML='\n            <label for="auth-token-input" style="display: block; margin-bottom: 8px; font-size: 14px; color: #856404; font-weight: 500;">\n              🔐 Google OAuth Access Token (Manual Entry):\n            </label>\n            <input type="password" id="auth-token-input" placeholder="Enter your Google OAuth access token..." \n                   style="width: 100%; padding: 8px; border: 1px solid #dadce0; border-radius: 4px; font-size: 13px; margin-bottom: 8px;">\n            <div style="font-size: 12px; color: #856404; margin-bottom: 10px;">\n              <strong>How to get access token:</strong><br>\n              1. Go to <a href="https://console.cloud.google.com/" target="_blank" style="color: #1a73e8;">Google Cloud Console</a><br>\n              2. Enable Google Meet API<br>\n              3. Create OAuth 2.0 credentials<br>\n              4. Use OAuth 2.0 Playground or generate token\n            </div>\n            <button id="save-auth-token" class="btn btn-success" style="width: 100%;">\n              Save Token & Continue\n            </button>\n          ';var r=document.getElementById("auth-token-input"),o=document.getElementById("save-auth-token");if(o&&r){var i=function(){var n=r.value.trim();n?(V&&(V.accessToken=n),t.style.display="none",e(n)):alert("Please enter a valid access token")};o.addEventListener("click",i),r.addEventListener("keypress",function(e){"Enter"===e.key&&i()}),r.focus()}})}else try{var o=prompt("Google Meet API requires OAuth authorization.\n\nEnter your Google OAuth access token:");o&&o.trim()?(V&&(V.accessToken=o.trim()),e(o.trim())):e(null)}catch(t){e(null)}}))},e)}))).apply(this,arguments)}function Le(){return Ge.apply(this,arguments)}function Ge(){return(Ge=$(z().m(function e(){return z().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Ne();case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function ze(){return Be.apply(this,arguments)}function Be(){return(Be=$(z().m(function e(){var t,n,r,o,i;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("Stopping transcript..."),e.p=1,!oe||!te){e.n=2;break}return e.n=2,oe.stopTranscription();case 2:te=!1,t=document.getElementById("start-transcript-btn"),n=document.getElementById("stop-transcript-btn"),r=document.getElementById("transcript-status"),t&&(t.disabled=!1),n&&(n.disabled=!0),r&&(r.style.background="#fce8e6",r.style.color="#d93025",r.textContent="⏹️ Transcription stopped"),(o=document.getElementById("transcript-container"))&&(o.innerHTML=""),console.log("✅ Transcription stopped successfully"),e.n=4;break;case 3:e.p=3,i=e.v,console.error("Error stopping transcription:",i),$e("Error stopping transcription: "+i.message,"error");case 4:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function De(){return Fe.apply(this,arguments)}function Fe(){return(Fe=$(z().m(function e(){var t,n,r,o,i,a,s,c,l,u,d,p,f,h,g,m,y,v,w,b,k,E;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("Starting Attendee transcription..."),e.p=1,re){e.n=2;break}throw new Error("Attendee Integration not initialized. Please check your API key configuration.");case 2:if((t=document.getElementById("transcript-container"))||((t=document.createElement("div")).id="transcript-container",t.style.cssText="\n        background: #fff;\n        border: 1px solid #e0e0e0;\n        border-radius: 8px;\n        padding: 12px;\n        height: 220px;\n        overflow-y: auto;\n        font-family: monospace;\n        font-size: 13px;\n        white-space: pre-wrap;\n      ",(n=document.querySelector(".participants-card"))&&((r=n.querySelector("#transcript-container"))?r.replaceWith(t):n.insertBefore(t,n.firstChild))),t.innerHTML="",o=document.getElementById("start-attendee-transcript"),i=document.getElementById("stop-attendee-transcript"),a=document.getElementById("status-message"),o&&(o.disabled=!0),i&&(i.disabled=!1),a&&(a.style.display="block",a.className="status-message info",a.textContent="🔄 Creating Attendee bot and joining meeting..."),(s=document.getElementById("webhook-url-input"))&&s.value.trim()&&((c=s.value.trim()).startsWith("https://")?(re.setWebhookUrl(c),console.log("✅ Using webhook URL from input:",c)):console.warn("⚠️ Webhook URL must start with https://")),l=null,u=document.getElementById("meeting-url-input"),d=document.getElementById("space-name-input"),u&&u.value.trim()?((l=u.value.trim()).includes("http")||(l="https://meet.google.com/".concat(l.replace(/^\/+|\/+$/g,""))),console.log("[Attendee] Using meeting URL from input field:",l)):d&&d.value.trim()&&(p=d.value.trim(),console.log("[Attendee] Space name provided:",p),f=p,p.startsWith("spaces/")&&(f=p.replace("spaces/","")),(f=f.replace(/[^a-z0-9-]/gi,""))&&f.length>0&&(l="https://meet.google.com/".concat(f),console.log("[Attendee] Constructed meeting URL from space name:",l))),l&&"https://meet.google.com"!==l){e.n=4;break}return console.log("[Attendee] Trying automatic meeting URL detection..."),e.n=3,re.getMeetingUrl();case 3:(h=e.v)&&"https://meet.google.com"!==h&&"https://meet.google.com/"!==h?(l=h,console.log("[Attendee] Using detected meeting URL:",l)):console.log("[Attendee] Detected URL is incomplete:",h);case 4:if(l&&"https://meet.google.com"!==l&&"https://meet.google.com/"!==l){e.n=5;break}throw(g=document.getElementById("meeting-url-input-container"))&&(g.style.display="block"),new Error('Could not detect complete meeting URL. Please enter the meeting code (e.g., "abc-defg-hij") or full URL manually.');case 5:return console.log("[Attendee] Final meeting URL to use:",l),e.n=6,re.startTranscription(l);case 6:(m=document.getElementById("meeting-url-input-container"))&&(m.style.display="none"),y=re.useWebhooks?"webhooks":"API polling",a&&(a.className="status-message success",a.textContent="🎙️ Attendee transcription active (".concat(y,") - receiving live transcripts")),console.log("✅ Attendee transcription started successfully with",y),e.n=8;break;case 7:e.p=7,E=e.v,console.error("Error starting Attendee transcription:",E),$e("Error starting Attendee transcription: "+E.message,"error"),v=document.getElementById("start-attendee-transcript"),w=document.getElementById("stop-attendee-transcript"),b=document.getElementById("status-message"),v&&(v.disabled=!1),w&&(w.disabled=!0),b&&(b.className="status-message error",b.textContent="❌ Failed to start Attendee transcription: "+E.message),(E.message.includes("Could not detect")||E.message.includes("meeting URL"))&&(k=document.getElementById("meeting-url-input-container"))&&(k.style.display="block");case 8:return e.a(2)}},e,null,[[1,7]])}))).apply(this,arguments)}function Ke(){return We.apply(this,arguments)}function We(){return(We=$(z().m(function e(){var t,n,r,o;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("Stopping Attendee transcription..."),e.p=1,!re||!re.isActive){e.n=2;break}return e.n=2,re.stopTranscription();case 2:t=document.getElementById("start-attendee-transcript"),n=document.getElementById("stop-attendee-transcript"),r=document.getElementById("status-message"),t&&(t.disabled=!1),n&&(n.disabled=!0),r&&(r.className="status-message error",r.textContent="⏹️ Attendee transcription stopped"),console.log("✅ Attendee transcription stopped successfully"),e.n=4;break;case 3:e.p=3,o=e.v,console.error("Error stopping Attendee transcription:",o),$e("Error stopping Attendee transcription: "+o.message,"error");case 4:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function $e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("status");n&&(n.textContent=e,n.className="status ".concat(t),n.style.display="block",setTimeout(function(){n.style.display="none"},5e3))}function qe(){return Je.apply(this,arguments)}function Je(){return(Je=$(z().m(function e(){var t,n,r,o,i,a,s,c,l,u;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t=document.getElementById("ai-question-input"),n=document.getElementById("ai-answer"),t&&n){e.n=1;break}return e.a(2);case 1:if(r=t.value.trim()){e.n=2;break}return n.style.display="block",n.textContent="Please enter a question.",e.a(2);case 2:if(o=ne.join("\n"),n.style.display="block",n.textContent="Asking AI...",Q){e.n=3;break}return n.textContent="Claude API key not configured. Please set ANTHROPIC_API_KEY environment variable.",e.a(2);case 3:return i="You are an assistant. Answer the question using ONLY the following meeting transcript. If unsure, say you are unsure.\n\nTranscript:\n".concat(o,"\n\nQuestion: ").concat(r),e.n=4,fetch("http://localhost:8787/api/askClaude",{method:"POST",headers:{"Content-Type":"application/json","x-claude-key":Q},body:JSON.stringify({prompt:i})});case 4:if((a=e.v).ok){e.n=6;break}return e.n=5,a.text();case 5:return s=e.v,n.textContent="AI request failed: ".concat(a.status," ").concat(s),e.a(2);case 6:return e.n=7,a.json();case 7:c=e.v,n.textContent=c.answer||"No answer received.",e.n=9;break;case 8:e.p=8,u=e.v,(l=document.getElementById("ai-answer"))&&(l.style.display="block",l.textContent="AI error: "+(u&&u.message?u.message:String(u)));case 9:return e.a(2)}},e,null,[[0,8]])}))).apply(this,arguments)}export{ge as initializeMainStage,fe as setUpAddon};
//# sourceMappingURL=bundle.js.map