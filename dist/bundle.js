/*! For license information please see bundle.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MeetTranscriptAddon=e():t.MeetTranscriptAddon=e()}(this,()=>(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{initializeMainStage:()=>pt,setUpAddon:()=>lt});const n="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};(function(){var t=Object.defineProperty,e=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(n,r){if(r)t:{var i=e;n=n.split(".");for(var o=0;o<n.length-1;o++){var a=n[o];if(!(a in i))break t;i=i[a]}(r=r(o=i[n=n[n.length-1]]))!=o&&null!=r&&t(i,n,{configurable:!0,writable:!0,value:r})}}("Symbol.dispose",function(t){return t||Symbol("Symbol.dispose")});var n,r,i=this||self;function o(t,e){function n(){}n.prototype=e.prototype,t.qa=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.oa=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function a(t,e){if(Error.captureStackTrace)Error.captureStackTrace(this,a);else{const t=Error().stack;t&&(this.stack=t)}t&&(this.message=String(t)),void 0!==e&&(this.cause=e)}function s(t){i.setTimeout(()=>{throw t},0)}o(a,Error),a.prototype.name="CustomError";t:{for(var c=["CLOSURE_FLAGS"],l=i,u=0;u<c.length;u++)if(null==(l=l[c[u]])){r=null;break t}r=l}var p,d=r&&r[610401301];n=null!=d&&d;const f=i.navigator;function h(t){return!!n&&!!p&&p.brands.some(({brand:e})=>e&&-1!=e.indexOf(t))}function g(t){var e;return(e=i.navigator)&&(e=e.userAgent)||(e=""),-1!=e.indexOf(t)}function y(){return!!n&&!!p&&p.brands.length>0}function m(){return y()?h("Chromium"):(g("Chrome")||g("CriOS"))&&!(!y()&&g("Edge"))||g("Silk")}function v(t,e){(e=Array.prototype.indexOf.call(t,e,void 0))>=0&&Array.prototype.splice.call(t,e,1)}function w(t){let e="",n=0;const r=t.length-10240;for(;n<r;)e+=String.fromCharCode.apply(null,t.subarray(n,n+=10240));return e+=String.fromCharCode.apply(null,n?t.subarray(n):t),btoa(e)}p=f&&f.userAgentData||null,!g("Android")||m(),m(),g("Safari")&&(m()||!y()&&g("Coast")||!y()&&g("Opera")||!y()&&g("Edge")||(y()?h("Microsoft Edge"):g("Edg/"))||y()&&h("Opera"));const b=/[-_.]/g,S={"-":"+",_:"/",".":"="};function P(t){return S[t]||""}function E(t){return null!=t&&t instanceof Uint8Array}var A={};function k(){return C||(C=new T(null,A))}var T=class{constructor(t,e){if(I(e),this.g=t,null!=t&&0===t.length)throw Error("ByteString should be constructed with non-empty values")}};let C,x;function I(t){if(t!==A)throw Error("illegal external caller")}function M(t,e){t.__closure__error__context__984382||(t.__closure__error__context__984382={}),t.__closure__error__context__984382.severity=e}function R(){const t=Error();M(t,"incident"),s(t)}function j(t){return M(t=Error(t),"warning"),t}function O(){return"function"==typeof BigInt}function N(t){return Array.prototype.slice.call(t)}function _(t,e){return e&&Symbol.for&&t?Symbol.for(t):null!=t?Symbol(t):Symbol()}var D=_("jas",!0);_();var U=_(),L=_();function z(t,e){e[D]=-30975&t}function F(t,e){e[D]=-30941&t|34}_(),_();var G,B={},$={};function J(t){return!(!t||"object"!=typeof t||t.g!==$)}function K(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)&&t.constructor===Object}function V(t,e){if(null!=t)if("string"==typeof t)t=t?new T(t,A):k();else if(t.constructor!==T)if(E(t))t=t.length?new T(new Uint8Array(t),A):k();else{if(!e)throw Error();t=void 0}return t}function W(t){return!(!Array.isArray(t)||t.length||!(1&t[D]))}const Y=[];function H(t){if(2&t)throw Error()}Y[D]=55,G=Object.freeze(Y);var q=Object.freeze({});function X(t){return t.pa=!0,t}var Z=X(t=>"number"==typeof t),Q=X(t=>"string"==typeof t),tt=X(t=>"boolean"==typeof t),et="function"==typeof i.BigInt&&"bigint"==typeof i.BigInt(0),nt=X(t=>et?t>=it&&t<=at:"-"===t[0]?st(t,rt):st(t,ot));const rt=Number.MIN_SAFE_INTEGER.toString(),it=et?BigInt(Number.MIN_SAFE_INTEGER):void 0,ot=Number.MAX_SAFE_INTEGER.toString(),at=et?BigInt(Number.MAX_SAFE_INTEGER):void 0;function st(t,e){if(t.length>e.length)return!1;if(t.length<e.length||t===e)return!0;for(let n=0;n<t.length;n++){const r=t[n],i=e[n];if(r>i)return!1;if(r<i)return!0}}let ct=0,lt=0;function ut(t){const e=t>>>0;ct=e,lt=(t-e)/4294967296>>>0}function pt(t){if(t<0){ut(-t);const[e,n]=ht(ct,lt);ct=e>>>0,lt=n>>>0}else ut(t)}function dt(t,e){if(t>>>=0,(e>>>=0)<=2097151)var n=""+(4294967296*e+t);else O()?n=""+(BigInt(e)<<BigInt(32)|BigInt(t)):(t=(16777215&t)+6777216*(n=16777215&(t>>>24|e<<8))+6710656*(e=e>>16&65535),n+=8147497*e,e*=2,t>=1e7&&(n+=t/1e7>>>0,t%=1e7),n>=1e7&&(e+=n/1e7>>>0,n%=1e7),n=e+ft(n)+ft(t));return n}function ft(t){return t=String(t),"0000000".slice(t.length)+t}function ht(t,e){return e=~e,t?t=1+~t:e+=1,[t,e]}function gt(t){return null==t||"boolean"==typeof t?t:"number"==typeof t?!!t:void 0}const yt=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function mt(t){const e=typeof t;switch(e){case"bigint":return!0;case"number":return Number.isFinite(t)}return"string"===e&&yt.test(t)}function vt(t){if(null!=t){if(!Number.isFinite(t))throw j("enum");t|=0}return t}function wt(t){if(null!=t){if("string"==typeof t){if(!t)return;t=+t}"number"==typeof t&&Number.isFinite(t)}}function bt(t){if(null!=t)t:{if(!mt(t))throw j("int64");switch(typeof t){case"string":t=Pt(t);break t;case"bigint":var e=t=BigInt.asIntN(64,t);if(Q(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(Z(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=et?BigInt(t):tt(t)?t?"1":"0":Q(t)?t.trim()||"0":String(t);break t;default:t=St(t)}}return t}function St(t){if(t=Math.trunc(t),!Number.isSafeInteger(t)){pt(t);var e=ct,n=lt;(t=2147483648&n)&&(n=~n>>>0,0==(e=1+~e>>>0)&&(n=n+1>>>0));const r=4294967296*n+(e>>>0);t="number"==typeof(e=Number.isSafeInteger(r)?r:dt(e,n))?t?-e:e:t?"-"+e:e}return t}function Pt(t){var e=Math.trunc(Number(t));if(Number.isSafeInteger(e))return String(e);if(-1!==(e=t.indexOf("."))&&(t=t.substring(0,e)),!("-"===t[0]?t.length<20||20===t.length&&Number(t.substring(0,7))>-922337:t.length<19||19===t.length&&Number(t.substring(0,6))<922337)){if(t.length<16)pt(Number(t));else if(O())t=BigInt(t),ct=Number(t&BigInt(4294967295))>>>0,lt=Number(t>>BigInt(32)&BigInt(4294967295));else{e=+("-"===t[0]),lt=ct=0;const n=t.length;for(let r=e,i=(n-e)%6+e;i<=n;r=i,i+=6){const e=Number(t.slice(r,i));lt*=1e6,ct=1e6*ct+e,ct>=4294967296&&(lt+=Math.trunc(ct/4294967296),lt>>>=0,ct>>>=0)}if(e){const[t,e]=ht(ct,lt);ct=t,lt=e}}if(t=ct,2147483648&(e=lt))if(O())t=""+(BigInt(0|e)<<BigInt(32)|BigInt(t>>>0));else{const[n,r]=ht(t,e);t="-"+dt(n,r)}else t=dt(t,e)}return t}function Et(t){if(null!=t&&"string"!=typeof t)throw Error();return t}function At(t,e,n){if(null!=t&&"object"==typeof t&&t.H===B)return t;if(Array.isArray(t)){var r=0|t[D],i=r;return 0===i&&(i|=32&n),(i|=2&n)!==r&&(t[D]=i),new e(t)}}let kt,Tt,Ct,xt,It,Mt;function Rt(t){let e;return null==(e=kt)?void 0:e.get(t)}function jt(t){try{return-1!==t.toString().indexOf("[native code]")?t:null}catch{return null}}function Ot(t,e){return Nt(e)}function Nt(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return nt(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(W(t))return}else{if(E(t))return w(t);if(t instanceof T){const e=t.g;return null==e?"":"string"==typeof e?e:t.g=w(e)}}}return t}function _t(t,e,n,r,i){if(null!=t){if(Array.isArray(t))t=W(t)?void 0:i&&2&t[D]?t:Dt(t,e,n,void 0!==r,i);else if(K(t)){const o={};for(let a in t)o[a]=_t(t[a],e,n,r,i);t=o}else t=e(t,r);return t}}function Dt(t,e,n,r,i){const o=r||n?0|t[D]:0;r=r?!!(32&o):void 0,t=N(t);for(let o=0;o<t.length;o++)t[o]=_t(t[o],e,n,r,i);return n&&n(o,t),t}function Ut(t){return t.H===B?t.toJSON():Nt(t)}function Lt(t,e,n=F){if(null!=t){if(t instanceof Uint8Array)return e?t:new Uint8Array(t);if(Array.isArray(t)){var r=0|t[D];return 2&r?t:(e&&(e=0===r||!!(32&r)&&!(64&r||!(16&r))),e?(t[D]=-12293&r|34,t):Dt(t,Lt,4&r?F:n,!0,!0))}return t.H===B&&(t=2&(r=(n=t.m)[D])?t:new t.constructor(zt(n,r,!0))),t}}function zt(t,e,n){const r=n||2&e?F:z,i=!!(32&e);return t=function(t,e,n){var r=(t=N(t)).length;const i=256&e?t[r-1]:void 0;for(r+=i?-1:0,e=512&e?1:0;e<r;e++)t[e]=n(t[e]);if(i){e=t[e]={};for(const t in i)e[t]=n(i[t])}return t}(t,e,t=>Lt(t,i,r)),t[D]=32|t[D]|(n?2:0),t}function Ft(t){const e=t.m,n=e[D];return 2&n?new t.constructor(zt(e,n,!1)):t}function Gt(t,e){return $t(t=t.m,t[D],e)}function Bt(t,e,n,r){if(!((e=r+(+!!(512&e)-1))<0||e>=t.length||e>=n))return t[e]}function $t(t,e,n,r){if(-1===n)return null;const i=e>>15&1023||536870912;if(!(n>=i)){var o,a=t.length;return r&&256&e&&null!=(r=t[a-1][n])?(Bt(t,e,i,n)&&null!=U&&(t=null!=(o=x)?o:x={},(o=t[U]||0)>=4||(t[U]=o+1,R())),r):Bt(t,e,i,n)}return 256&e?t[t.length-1][n]:void 0}function Jt(t,e,n){const r=t.m;let i=r[D];return H(i),Kt(r,i,e,n),t}function Kt(t,e,n,r){const i=e>>15&1023||536870912;if(n>=i){let o,a=e;if(256&e)o=t[t.length-1];else{if(null==r)return a;o=t[i+(+!!(512&e)-1)]={},a|=256}return o[n]=r,n<i&&(t[n+(+!!(512&e)-1)]=void 0),a!==e&&(t[D]=a),a}return t[n+(+!!(512&e)-1)]=r,256&e&&n in(t=t[t.length-1])&&delete t[n],e}function Vt(t,e,n,r){return void 0!==Zt(t,e,n=Ht(t,r)===n?n:-1)}function Wt(t){return!!(2&t)&&!!(4&t)||!!(2048&t)}function Yt(t,e,n,r){const i=t.m;let o=i[D];return H(o),Kt(i,o,e,("0"===r?0===Number(n):n===r)?void 0:n),t}function Ht(t,e){return Xt(qt(t=t.m),t,t[D],e)}function qt(t){let e;return null!=(e=t[L])?e:t[L]=new Map}function Xt(t,e,n,r){let i=t.get(r);if(null!=i)return i;i=0;for(let t=0;t<r.length;t++){const o=r[t];null!=$t(e,n,o)&&(0!==i&&(n=Kt(e,n,i)),i=o)}return t.set(r,i),i}function Zt(t,e,n,r){let i=(t=t.m)[D];return(e=At(r=$t(t,i,n,r),e,i))!==r&&null!=e&&Kt(t,i,n,e),e}function Qt(t,e,n){if(null==(e=Zt(t,e,n,!1)))return e;let r=(t=t.m)[D];if(!(2&r)){const i=Ft(e);i!==e&&Kt(t,r,n,e=i)}return e}function te(t,e,n){return null==n&&(n=void 0),Jt(t,e,n)}function ee(t,e,n,r){null==r&&(r=void 0);t:{const a=t.m;var i=a[D];if(H(i),null==r){var o=qt(a);if(Xt(o,a,i,n)!==e)break t;o.set(n,0)}else{const t=qt(o=a),r=Xt(t,o,i,n);r!==e&&(r&&(i=Kt(o,i,r)),t.set(n,e))}Kt(a,i,e,r)}return t}function ne(t,e){const n=t.m;let r=n[D];if(H(r),null==e)return Kt(n,r,1),t;var i,o=e;e=(null==(i=Tt)?void 0:i.get(o))||o,i=o=0|e[D];const a=Wt(o),s=a||Object.isFrozen(e);let c=!0,l=!0;for(let t=0;t<e.length;t++){var u=e[t];a||(u=!!(2&u.m[D]),c&&(c=!u),l&&(l=u))}return a||(o=c?13:5,o=l?16|o:-17&o),s&&o===i||(e=N(e),i=0,o=ie(o=re(o,r),r,!0)),o!==i&&(e[D]=o),Kt(n,r,1,e),t}function re(t,e){return-2049&(2&e?2|t:-3&t)|32}function ie(t,e,n){return 32&e&&n||(t&=-33),t}function oe(t,e){return null!=t?t:e}function ae(t){return null!=(t=Gt(t,1))&&("bigint"==typeof t?nt(t)?t=Number(t):(t=BigInt.asIntN(64,t),t=nt(t)?Number(t):String(t)):t=mt(t)?"number"==typeof t?St(t):Pt(t):void 0),oe(t,0)}function se(t,e){return oe(null==(t=Gt(t,e))||"string"==typeof t?t:void 0,"")}function ce(t,e){return oe(t=null==(t=Gt(t,e))?t:Number.isFinite(t)?0|t:void 0,0)}function le(t,e,n,r){return Qt(t,e,n=Ht(t,r)===n?n:-1)}function ue(t){try{return Mt=!0,JSON.stringify(de(t),Ot)}finally{Mt=!1}}var pe=class{constructor(t){t:{var e=null!=e?e:0;if(null==t){var n=96;t=[]}else{if(!Array.isArray(t))throw Error("narr");if(2048&(n=0|t[D]))throw Error("farr");if(64&n)break t;1===e||2===e||(n|=64);var r=(e=t).length;if(r&&K(e[--r])){if((e=r-(+!!(512&(n|=256))-1))>=1024)throw Error("pvtlmt");n=-33521665&n|(1023&e)<<15}}t[D]=n}this.m=t}toJSON(){return de(this)}};function de(t){t=t.m,t=Mt?t:Dt(t,Ut,void 0,void 0,!1);{var e=!Mt;let l=t.length;if(l){var n=t[l-1],r=K(n);r?l--:n=void 0;var i=t;if(r){t:{var o,a=n,s=!1;if(a)for(let t in a)if(isNaN(+t)){let e;(null!=(e=o)?e:o={})[t]=a[t]}else if(r=a[t],Array.isArray(r)&&(W(r)||J(r)&&0===r.size)&&(r=null),null==r&&(s=!0),null!=r){let e;(null!=(e=o)?e:o={})[t]=r}if(s||(o=a),o)for(let t in o){s=o;break t}s=null}a=null==s?null!=n:s!==n}for(;l>0&&(null==(o=i[l-1])||W(o)||J(o)&&0===o.size);l--)var c=!0;(i!==t||a||c)&&(e?(c||a||s)&&(i.length=l):i=Array.prototype.slice.call(i,0,l),s&&i.push(s)),c=i}else c=t}return c}function fe(t){return e=>{if(null==e||""==e)e=new t;else{if(e=JSON.parse(e),!Array.isArray(e))throw Error("dnarr");e[D]|=32,e=new t(e)}return e}}pe.prototype.H=B,pe.prototype.toString=function(){try{return Mt=!0,de(this).toString()}finally{Mt=!1}};var he,ge=(he=class extends pe{},t=>{if(t=JSON.parse(t),!Array.isArray(t)){var e=typeof t;throw Error("Expected jspb data to be an array, got "+("object"!=e?e:t?Array.isArray(t)?"array":e:"null")+": "+t)}return t[D]|=34,new he(t)}),ye=class extends pe{};function me(t){return ve(t,t.index)>=t.g&&(t.h[t.index]=Date.now(),t.index=(t.index+1)%1,!0)}function ve(t,e){let n;return Date.now()-(null!=(n=t.h[e])?n:-1*t.g)}var we=class{constructor(t){this.g=t,this.h=[],this.index=0}},be=class extends pe{},Se=[2,3],Pe=class extends pe{},Ee=class extends Error{constructor({errorType:t,message:e,i:n}){super(`Meet Add-on SDK error: ${e}${n?` - ${n}`:""}`),this.errorType=t}},Ae={errorType:"InternalError",message:"An unexpected error has occurred.",i:"No further information is available."},ke={errorType:"MissingUrlParameter",message:"Missing required Meet SDK URL parameter",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not strip URL parameters (e.g. as part of a redirect)."},Te={errorType:"NeedsMainStageContext",message:"This method can only be invoked if the addon is running in the main stage.",i:"Use getFrameType to check whether the addon is running in the main stage before invoking this method."},Ce={errorType:"NeedsSidePanelContext",message:"This method can only be invoked if the addon is running in the side panel.",i:"Use getFrameType to check whether the addon is running in the side panel before invoking this method."},xe={errorType:"NotSupportedInStandalone",message:"This method is not supported in standalone mode.",i:"Do not call this method in standalone mode."},Ie={errorType:"InternalError",message:"The frame type URL parameter is set to an unexpected value.",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not modify URL parameters (e.g. as part of a redirect)."},Me={errorType:"InvalidCloudProjectNumber",message:"Cloud Project Number provided by meet does not match the one passed in by the SDK. Ensure that the correct Cloud Project Number is passed to the SDK as a string.",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not modify URL parameters (e.g. as part of a redirect) and ensure that the correct Cloud Project Number was passed into the SDK as a string."},Re={errorType:"DestinationNotReady",message:"The recipient frame is not connected via the addon SDK and cannot receive the notification.",i:"Make sure the destination frame has connected before sending messages to it."},je={errorType:"InvalidActivityStartingState",message:"Origin of the ActivityStartingState iframeURLs does not match the origin of the URLs provided in the Add-on manifest.",i:"Ensure that the ActivityStartingState iframeURL origins match the origins of the URLs provided in the Add-on manifest."},Oe={errorType:"ActivityStartingStateMissingAttributes",message:"The supplied ActivityStartingState object does not contain any recognized attributes.",i:"Ensure that the ActivityStartingState object contains at least one of the following attributes: mainStageUrl, sidePanelUrl, additionalData."},Ne={errorType:"ActivityStartingStateUnrecognizedAttributes",message:"The supplied ActivityStartingState object contains attributes that are not recognized.",i:"Ensure that the ActivityStartingState object has only the following attributes: mainStageUrl, sidePanelUrl, additionalData."},_e={errorType:"AddonStartingStateMissingAttributes",message:"The supplied AddonStartingState object does not contain any recognized attributes.",i:"Ensure that the AddonStartingState object contains at least one of the following attributes: sidePanelUrl, additionalData."},De={errorType:"AddonStartingStateUnrecognizedAttributes",message:"The supplied AddonStartingState object contains attributes that are not recognized.",i:"Ensure that the AddonStartingState object has only the following attributes: sidePanelUrl, additionalData."},Ue=t=>({errorType:"ArgumentNullError",message:`The argument supplied for '${t}' was 'null' but a value was expected.`,i:"Ensure you are passing a value of the expected type for the argument."}),Le=(t,e,n)=>({errorType:"ArgumentTypeError",message:`The type '${e}' of argument supplied for '${t}' did not match the expected type '${n}'.`,i:"Ensure the type of the argument provided matches the expected type."}),ze={errorType:"ActivityIsOngoing",message:"Operation cannot be performed while an activity is ongoing.",i:"Ensure that no activity is ongoing."},Fe={errorType:"InternalError",message:"Frame message missing required Meet SDK command.",i:"Send one of the available commands in the frame message."},Ge={errorType:"NoActivityFound",message:"No activity found.",i:"Ensure that the activity is started before performing this operation."},Be={errorType:"RequiresEapEnrollment",message:"This feature is only available to early access partners.",i:"Meet add-on early access enrollment is currently closed."},$e={errorType:"UserNotInitiator",message:"Operation cannot be performed because the user is not the initiator of the current activity.",i:"Ensure that the user is the initiator of the current activity or that the activity has ended."},Je={errorType:"SizeLimitExceededActivityStartingState",message:"The size of the activityStartingState URLs and/or its data exceed the limits allowed.",i:"Ensure that the activityStartingState URL size is less than 512 characters and the additional data size is less than 4096 characters."},Ke={errorType:"SizeLimitExceededFrameToFrameMessage",message:"The size of the frame to frame message exceeds the limits allowed.",i:"Ensure that the frame to frame message size is less than 1,000,000 characters."},Ve={errorType:"AddonSessionAlreadyCreated",message:"The addon session has already been created.",i:"Only instantiate the AddonSession once."},We={errorType:"UserCancelled",message:"The user cancelled starting an activity.",i:"The user needs to click continue to start the activity."},Ye={errorType:"NotSupportedInMeetCall",message:"This method is not supported during a Meet call.",i:"Do not call this method during a Meet call."},He={errorType:"InvalidAddonStartingState",message:"Origin of the AddonStartingState iframeURLs does not match the origin of the URLs provided in the Add-on manifest.",i:"Ensure that the AddonStartingState iframeURL origins match the origins of the URLs provided in the Add-on manifest."},qe={errorType:"SizeLimitExceededAddonStartingState",message:"The size of the AddonStartingState URLs and/or its data exceed the limits allowed.",i:"Ensure that the AddonStartingState URL size is less than 512 characters and the additional data size is less than 4096 characters."},Xe={errorType:"MeetingPolicyPreventsStartingActivity",message:"A meeting policy (such as using host control settings) prevents the user from starting the activity.",i:"Have a meeting host or administrator modify the necessary settings to allow the current user to start the activity."};function Ze({errorType:t,message:e,i:n},r=""){throw new Ee({errorType:t,message:r?`${e} ${r}`:e,i:n})}function Qe(t,e){Ze({...ke,message:`${ke.message}: ${t}. In URL ${e}`})}function tn(t){return Yt(new rn,1,vt(t),0)}function en(t,e){return Yt(t,2,Et(e),"")}function nn(t,e){return Yt(t,3,Et(e),"")}var rn=class extends pe{getFrameType(){return ce(this,1)}};function on(t){var e;e=void 0===q?2:4;var n=t.m[D],r=n,i=!(2&n),o=rn;e=(n=!!(2&r))?1:e,i&&(i=!n),n=$t(t=t.m,r,1);var a=0|(n=Array.isArray(n)?n:G)[D],s=!!(4&a);if(!s){var c=a;0===c&&(c=re(c,r)),a=n;var l=r;const t=!!(2&(c|=1));t&&(l|=2);let e=!t,i=!0,s=0,u=0;for(;s<a.length;s++){const n=At(a[s],o,l);if(n instanceof o){if(!t){const t=!!(2&n.m[D]);e&&(e=!t),i&&(i=t)}a[u++]=n}}u<s&&(a.length=u),c|=4,c=i?16|c:-17&c,c=e?8|c:-9&c,a[D]=c,t&&Object.freeze(a),a=c}if(i&&!(8&a||!n.length&&(1===e||4===e&&32&a))){for(Wt(a)&&(n=N(n),a=re(a,r),r=Kt(t,r,1,n)),i=n,o=a,a=0;a<i.length;a++)(c=i[a])!==(l=Ft(c))&&(i[a]=l);o|=8,o=i.length?-17&o:16|o,a=i[D]=o}let u;if(1===e||4===e&&32&a){if(!Wt(a)){r=a;var p=!!(32&a);(a|=!n.length||16&a&&(!s||p)?2:2048)!==r&&(n[D]=a),Object.freeze(n)}}else s=5===e&&(!!(32&a)||Wt(a)||!!Rt(n)),(2===e||s)&&Wt(a)&&(n=N(n),a=ie(a=re(a,r),r,!1),n[D]=a,r=Kt(t,r,1,n)),Wt(a)||(t=a,(a=ie(a,r,!1))!==t&&(n[D]=a)),s?u=function(t){var e;return void 0===Ct&&(Ct="function"==typeof Proxy?jt(Proxy):null),(e=!Ct)||(void 0===xt&&(xt="function"==typeof WeakMap?jt(WeakMap):null),e=!xt),e?t:(e=Rt(t))?e:Math.random()>.01?t:(function(t){if(void 0===It){const t=new Ct([],{});It=1===Array.prototype.concat.call([],t).length}It&&"function"==typeof Symbol&&Symbol.isConcatSpreadable&&(t[Symbol.isConcatSpreadable]=!0)}(t),function(t,e){(kt||(kt=new xt)).set(t,e),(Tt||(Tt=new xt)).set(e,t)}(t,e=new Ct(t,{set:(t,e,n)=>(R(),t[e]=n,!0)})),e)}(n):2===e&&(null==(p=kt)||p.delete(n));return u||n}function an(t){return ne(new sn,t)}var sn=class extends pe{},cn=class extends pe{};function ln(t){return Yt(new un,1,vt(t),0)}var un=class extends pe{},pn=class extends pe{},dn=class extends pe{},fn=class extends pe{},hn=class extends pe{getMeetingInfo(){return le(this,fn,3,gn)}getMeetPlatformInfo(){return le(this,dn,4,gn)}},gn=[2,3,4,5],yn=class extends pe{},mn=[1,4,5,6,7,8,9,10,11,12,13,14,15,16,17],vn=class extends pe{},wn=class extends pe{},bn=new Map([[2,"MAIN_STAGE"],[1,"SIDE_PANEL"]]),Sn=new Map([[0,"UNKNOWN"],[1,"OPEN_ADDON"],[2,"START_ACTIVITY"],[3,"JOIN_ACTIVITY"]]);function Pn(t){t&&"function"==typeof t.dispose&&t.dispose()}function En(){this.s=this.s,this.g=this.g}function An(t,e){t.s?e():(t.g||(t.g=[]),t.g.push(e))}function kn({J:t,R:e}){if(null===t)throw new Ee(Ue("activityStartingState"));if(e||void 0!==t){if("object"!=typeof t)throw new Ee(Le("activityStartingState",typeof t,"object"+(e?"":" | undefined")));if(void 0!==t.mainStageUrl&&"string"!=typeof t.mainStageUrl)throw new Ee(Le("mainStageUrl",typeof t.mainStageUrl,"string | undefined"));if(void 0!==t.sidePanelUrl&&"string"!=typeof t.sidePanelUrl)throw new Ee(Le("sidePanelUrl",typeof t.sidePanelUrl,"string | undefined"));if(void 0!==t.additionalData&&"string"!=typeof t.additionalData)throw new Ee(Le("additionalData",typeof t.additionalData,"string | undefined"));if(Object.keys(t).length!==+!!t.mainStageUrl+ +!!t.sidePanelUrl+ +!!t.additionalData)throw new Ee(Ne);if(0===Object.keys(t).length)throw new Ee(Oe)}}function Tn(t){const e=[];return e.push(nn(en(tn(2),t.mainStageUrl),t.additionalData)),e.push(nn(en(tn(1),t.sidePanelUrl),t.additionalData)),e}En.prototype.s=!1,En.prototype.dispose=function(){this.s||(this.s=!0,this.G())},En.prototype[Symbol.dispose]=function(){this.dispose()},En.prototype.G=function(){if(this.g)for(;this.g.length;)this.g.shift()()};var Cn=class extends En{constructor(t){super(),this.context=t,this.h={},Rr(this.context.g.U,t=>{if(7===Ht(t.content,mn)){const n=this.h.frameToFrameMessage;if(t=le(t.content,pn,7,mn),n&&t){var e=ce(t,1);if(void 0===(e=bn.get(e)))throw Error("Unknown frame type.");n({originator:e,payload:se(t,2)})}}})}async getMeetingInfo(){const t=await Hr(this.context.g,ln(2));return{meetingId:se(t.getMeetingInfo(),1),meetingCode:se(t.getMeetingInfo(),2)}}async getFrameOpenReason(){let t;const e=null!=(t=this.context.h.ca)?t:0;let n;return null!=(n=Sn.get(e))?n:"UNKNOWN"}async getActivityStartingState(){var t=le(await Hr(this.context.g,ln(1)),sn,2,gn);const e=null==t?void 0:on(t).find(t=>2===t.getFrameType());return t=null==t?void 0:on(t).find(t=>1===t.getFrameType()),{mainStageUrl:(null==e?void 0:se(e,2))||void 0,sidePanelUrl:(null==t?void 0:se(t,2))||void 0,additionalData:(null==t?void 0:se(t,3))||void 0}}async setActivityStartingState(t){kn({J:t,R:!0});var e=Tn(t);t=qr;var n=this.context.g,r=new vn;r=te(r,1,e=an(e)),await t(n,r)}on(t,e){this.h[t]=e}async getMeetPlatformInfo(){return{isMeetHardware:oe(gt(Gt((await Hr(this.context.g,ln(3))).getMeetPlatformInfo(),1)),!1)}}async closeAddon(){await async function(t){var e=Zr,n=new Gn,r=new Mn;n=ee(n,11,Bn,r),await e(t,Lr(n))}(this.context.g)}async startActivity(t){kn({J:t,R:!1});const e=new wn;t&&te(e,1,t=an(t=Tn(t))),await async function(t,e){var n=Zr;e=ee(new Gn,14,Bn,e),await n(t,Lr(e))}(this.context.g,e)}async endActivity(t){var e=Xr,n=this.context.g;t=Yt(new cn,1,vt("aab61ee0-51b4-475d-aa4d-849f2498640d"===t?999:0),0),await e(n,t)}},xn=fe(class extends pe{getFrameOpenReason(){return ce(this,5)}});function In(){var t=window.location.href,e=window.location.href,n=new URL(e).searchParams.get("meet_sdk");if(n?e=xn(atob(n)):(Qe("meet_sdk",e),e=void 0),(n=se(e,1))||Qe("meet_addon_frame_type",t),2!==(n=Number(n))&&1!==n)throw new Ee(Ie);const r=se(e,2);r||Qe("meet_control_channel_name",t);const i=se(e,4);var o;return i||Qe("addon_cloud_project_number",t),{ca:t=null!=(o=e.getFrameOpenReason())?o:0,frameType:n,ba:r,cloudProjectNumber:i,S:o=se(e,3)||"https://meet.google.com"}}var Mn=class extends pe{},Rn=class extends pe{},jn=class extends pe{},On=[1,2],Nn=class extends pe{},_n=class extends pe{},Dn=class extends pe{},Un=class extends pe{},Ln=class extends pe{},zn=class extends pe{setAddonStartingState(t){return te(this,1,t)}},Fn=class extends pe{},Gn=class extends pe{},Bn=[1,2,5,6,7,8,9,10,11,13,14,15,16],$n=class extends pe{},Jn=fe($n),Kn=[1,2];class Vn{constructor(t,e){this.data=t,this.channel=e}}var Wn=Promise;function Yn(t){const e=new MessageChannel;return Xn(e.port1,t),e}function Hn(t,e){return Xn(t,e),new qn(t)}class qn{constructor(t){this.g=t}send(t,e,n=[]){e=Yn(e),this.g.postMessage(t,[e.port2].concat(n))}C(t,e){return new Wn(n=>{this.send(t,n,e)})}}function Xn(t,e){e&&(t.onmessage=t=>{var n=t.data;t=Hn(t.ports[0]),e(new Vn(n,t))})}var Zn="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?t=>t&&AsyncContext.Snapshot.wrap(t):t=>t;function Qn(t,e){t.l(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}class tr{constructor(t,e){this.j=t,this.l=e,this.h=0,this.g=null}get(){let t;return this.h>0?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.j(),t}}function er(){var t=ar;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var nr=new tr(()=>new rr,t=>t.reset());class rr{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}let ir,or=!1,ar=new class{constructor(){this.h=this.g=null}add(t,e){const n=nr.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},sr=(t,e)=>{ir||cr(),or||(ir(),or=!0),ar.add(t,e)},cr=()=>{const t=Promise.resolve(void 0);ir=()=>{t.then(lr)}};function lr(){let t;for(;t=er();){try{t.h.call(t.g)}catch(t){s(t)}Qn(nr,t)}or=!1}function ur(){}function pr(t){if(this.g=0,this.T=void 0,this.l=this.h=this.j=null,this.v=this.B=!1,t!=ur)try{const e=this;t.call(void 0,function(t){vr(e,2,t)},function(t){vr(e,3,t)})}catch(t){vr(this,3,t)}}function dr(){this.next=this.context=this.h=this.l=this.g=null,this.j=!1}dr.prototype.reset=function(){this.context=this.h=this.l=this.g=null,this.j=!1};var fr=new tr(function(){return new dr},function(t){t.reset()});function hr(t,e,n){const r=fr.get();return r.l=t,r.h=e,r.context=n,r}function gr(t,e){(e=hr(e=Zn(e),e)).j=!0,mr(t,e)}function yr(t,e){if(0==t.g)if(t.j){var n=t.j;if(n.h){var r=0,i=null,o=null;for(let e=n.h;e&&(e.j||(r++,e.g==t&&(i=e),!(i&&r>1)));e=e.next)i||(o=e);i&&(0==n.g&&1==r?yr(n,e):(o?((r=o).next==n.l&&(n.l=r),r.next=r.next.next):br(n),Sr(n,i,3,e)))}t.j=null}else vr(t,3,e)}function mr(t,e){t.h||2!=t.g&&3!=t.g||wr(t),t.l?t.l.next=e:t.h=e,t.l=e}function vr(t,e,n){if(0==t.g){t===n&&(e=3,n=new TypeError("Promise cannot resolve to itself")),t.g=1;t:{var r=n,i=t.ma,o=t.na;if(r instanceof pr){mr(r,hr(i||ur,o||null,t));var a=!0}else{if(r)try{var s=!!r.$goog_Thenable}catch(t){s=!1}else s=!1;if(s)r.then(i,o,t),a=!0;else{if("object"==(s=typeof r)&&null!=r||"function"==s)try{const e=r.then;if("function"==typeof e){!function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}let a=!1;try{e.call(t,function(t){a||(a=!0,n.call(i,t))},o)}catch(t){o(t)}}(r,e,i,o,t),a=!0;break t}}catch(e){o.call(t,e),a=!0;break t}a=!1}}}a||(t.T=n,t.g=e,t.j=null,wr(t),3!=e||n instanceof Ar||function(t,e){t.v=!0,sr(function(){t.v&&Er.call(null,e)})}(t,n))}}function wr(t){t.B||(t.B=!0,sr(t.la,t))}function br(t){let e=null;return t.h&&(e=t.h,t.h=e.next,e.next=null),t.h||(t.l=null),e}function Sr(t,e,n,r){if(3==n&&e.h&&!e.j)for(;t&&t.v;t=t.j)t.v=!1;if(e.g)e.g.j=null,Pr(e,n,r);else try{e.j?e.l.call(e.context):Pr(e,n,r)}catch(t){Er.call(null,t)}Qn(fr,e)}function Pr(t,e,n){2==e?t.l.call(t.context,n):t.h&&t.h.call(t.context,n)}pr.prototype.then=function(t,e,n){return function(t,e,n,r){const i=hr(null,null,null);return i.g=new pr(function(t,o){i.l=e?function(n){try{const i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.h=n?function(e){try{const i=n.call(r,e);void 0===i&&e instanceof Ar?o(e):t(i)}catch(t){o(t)}}:o}),i.g.j=t,mr(t,i),i.g}(this,Zn("function"==typeof t?t:null),Zn("function"==typeof e?e:null),n)},pr.prototype.$goog_Thenable=!0,pr.prototype.cancel=function(t){if(0==this.g){const e=new Ar(t);sr(function(){yr(this,e)},this)}},pr.prototype.ma=function(t){this.g=0,vr(this,2,t)},pr.prototype.na=function(t){this.g=0,vr(this,3,t)},pr.prototype.la=function(){let t;for(;t=br(this);)Sr(this,t,this.g,this.T);this.B=!1};var Er=s;function Ar(t){a.call(this,t)}function kr(t,e,n){this.promise=t,this.resolve=e,this.reject=n}o(Ar,a),Ar.prototype.name="cancel";let Tr=1,Cr=new WeakMap;function xr(t,e,n){var r=Mr;t.h.has(e),r(e,n)}var Ir=class extends En{constructor(){super(),this.h=new Set}signal(){const t=new jr;return this.h.add(t),An(this,function(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}(Pn,t)),t}};function Mr(t,e){return new Promise(n=>{_r(()=>{t.L&&(t.ea=e,t.P=!0);for(const{I:n,slot:r}of t.o.values())try{r(e,{signal:t,I:n})}catch(t){s(t)}for(const n of t.A)n.resolve(e);t.A.clear(),n()})})}function Rr(t,e,n){const r=Tr++;return _r(()=>{!function(t,e,n,r){if(!t.s)if(r){if(!r.s){const i=()=>{_r(()=>{t.o.delete(e);const n=Cr.get(r);n&&v(n,i)})};t.o.set(e,{I:e,slot:n,F:i}),Ur(r,i)}}else t.o.set(e,{I:e,slot:n,F:()=>t.o.delete(e)})}(t,r,e,n)}),r}var jr=class extends En{constructor(){super(),this.L=!1,this.o=new Map,this.A=new Set,this.P=!1}detach(t){_r(()=>{const e=this.o.get(t);e&&e.F()})}value(t){return this.promise(!0,t)}next(t){return this.promise(!1,t)}promise(t,e){const n=function(){let t,e;return new kr(new pr(function(n,r){t=n,e=r}),t,e)}();return _r(()=>{if(this.s)n.reject(new Ar("Signal initially disposed"));else if(e&&e.s)n.reject(new Ar("Owner initially disposed"));else if(t&&this.L&&this.P)n.resolve(this.ea);else if(this.A.add(n),gr(n.promise,()=>{this.A.delete(n)}),e){const t=()=>{n.reject(new Ar("Owner asynchronously disposed"))};gr(n.promise,()=>{const n=Cr.get(e);n&&v(n,t)}),Ur(e,t)}}),n.promise}G(){super.G(),_r(()=>{for(const{F:t}of this.o.values())t();this.o.clear();for(const t of this.A)t.reject(new Ar("Signal asynchronously disposed"));this.A.clear()})}};const Or=[];let Nr=!1;function _r(t){Or.push(t),async function(){if(!Nr)try{Nr=!0;let t=Dr(0);for(;t<Or.length;)await Promise.resolve(),t=Dr(t)}catch(t){s(t)}finally{Or.length=0,Nr=!1}}()}function Dr(t){const e=t+100;for(;t<e&&t<Or.length;)try{Or[t++]()}catch(t){s(t)}return t}function Ur(t,e){if(t.s)e();else{var n=Cr.get(t);if(n)n.push(e);else{const n=[e];Cr.set(t,n),An(t,()=>{for(const t of[...n])t();Cr.delete(t)})}}}function Lr(t){return{content:ue(t=ee(new $n,1,Kn,t))}}const zr=new Ir;function Fr(t,e){const n=zr.signal();return{channel:Hn(t,t=>{const r=e(t.data);xr(zr,n,{content:r,ka:t})}),signal:n}}let Gr;var Br=class extends pe{},$r=class extends pe{},Jr=class extends pe{h(){return le(this,Br,2,Kr)}g(){return Vt(this,Br,2,Kr)}j(){return le(this,$r,3,Kr)}l(){return Vt(this,$r,3,Kr)}},Kr=[2,3],Vr=fe(class extends pe{}),Wr=fe(class extends pe{}),Yr=[1,2];async function Hr(t,e){var n=Zr;let r;return e=ee(new Gn,9,Bn,e),t=await n(t,Lr(e)),null==(r=le(Jn(t.data.content),yn,2,Kn))?void 0:le(r,hn,9,mn)}async function qr(t,e){var n=Zr;e=ee(new Gn,8,Bn,e),await n(t,Lr(e))}async function Xr(t,e){var n=Zr;e=ee(new Gn,15,Bn,e),await n(t,Lr(e))}async function Zr(t,e){let n;(t=await t.channel.C(e))||Ze(Ae,`Falsy response received from the message channel. ${JSON.stringify(t)}`),(e=t.data)||Ze(Ae,`Data field in the response from the message channel is falsy. ${JSON.stringify(e)}`),(e=e.content)||Ze(Ae,`Content field in the response from the message channel is falsy. ${JSON.stringify(e)}`);try{n=Jn(e)}catch(t){Ze(Ae,`The ControlMessage can't be deserialized. ${JSON.stringify(e)}. ${JSON.stringify(t)}`)}if((e=le(n,yn,2,Kn))||Ze(Ae,`MeetToAddonMessage field on ControlMessage is falsy. ${JSON.stringify(e)}`),void 0!==(null==(e=null==e?void 0:le(e,Pe,10,mn))?void 0:ce(e,1)))throw new Ee(function(t){switch(t){case 0:default:return Ae;case 1:return Re;case 2:return je;case 3:return ze;case 4:return Fe;case 5:return Be;case 6:return xe;case 7:return $e;case 8:return Je;case 9:return Ke;case 10:return We;case 11:return Ye;case 12:return He;case 13:return qe;case 14:return Ge;case 15:return Xe}}(ce(e,1)));return t}async function Qr(t){const e=function(){var t=new jn,e=new Rn;return ee(t,1,On,e)}(),{channel:n,response:r}=await async function(t,e){var n,r=Zr;return e=ee(new Gn,1,Bn,e),t=(r=await r(t,Lr(e))).data.messagePort,n=null!=(r=null==(n=le(Jn(r.data.content),yn,2,Kn))?void 0:le(n,be,1,mn))?r:Yt(n=new be,1,vt(0),0),{channel:t?Fr(t,t=>Wr(t)):void 0,response:n}}(t,e);if(!n)throw new Ee(function(t){let e;var n=null!=(e=ce(t,1))?e:0;switch(t=function(t){switch(t){case 2:return"co";case 3:return"gd";default:return"unknown"}}(Ht(t,Se)),n){case 1:return{errorType:"InternalError",message:`Could not connect to ${t} channel. Meet did not respond with a MessagePort.`,i:"No further information is available."};case 2:return{errorType:"InternalError",message:`Could not connect to ${t}. A conflicting ${t} exists.`,i:"No further information is available."};case 3:return{errorType:"InternalError",message:`Could not connect to ${t} channel. The addon does not have permission to open a ${t}.`,i:"This method might require EAP enrollment."};case 4:return{errorType:"InternalError",message:`Could not connect to ${t} channel. The addon is not authorized for this ${t}.`,i:"No further information is available."};case 0:default:return(t=>({errorType:"InternalError",message:`Could not connect to ${t} channel. Unknown error`,i:"No further information is available."}))(t);case 5:return"co"===t?{errorType:"InternalError",message:`Could not connect to ${t} channel. The coActivity was not found.`,i:`Consider starting the ${t} only after after the startActivity promise returns.`}:{errorType:"InternalError",message:`Could not connect to ${t} channel.`,i:"No further information is available."}}}(r));return n}async function ti(t,e,n){var r=Zr,i=new Gn;e=Yt(new Dn,1,vt(e),0),n=Yt(e,2,Et(n),""),i=ee(i,7,Bn,n),await r(t,Lr(i))}class ei extends En{constructor(t,e,n){super(),this.U=t,this.channel=e,this.h=function(t){var e=new we(100),n=Promise.resolve();return(...r)=>me(e)?t(...r):n}(async()=>{var t=this.channel,e=t.C,n=new Gn,r=new Un;n=ee(n,13,Bn,r),await e.call(t,Lr(n))}),t=function(){var t=Gr||(Gr=ge("[1,2,0]"));const e=(t=Jt(t=Ft(t),4,Et("dev-706864954"))).m,n=e[D];return 2&n?t:new t.constructor(zt(e,n,!0))}(),se(t,4),wt(Gt(t,1)),wt(Gt(t,2)),wt(Gt(t,3)),n=function(t,e){return ee(t,2,Bn,e)}(new Gn,function(t,e){return Yt(t,3,Et(e),"")}(function(t){return te(new Nn,2,t)}(t),n)),this.channel.send(Lr(n)),Rr(this.U,async t=>{16===Ht(t.content,mn)&&await async function(t){await t.h()}(this)})}}let ni;var ri=class{constructor(t){var e=ni;this.h=t,this.g=e}delete(){throw Error("Not implemented.")}},ii=class extends pe{h(){return le(this,Br,2,oi)}g(){return Vt(this,Br,2,oi)}j(){return le(this,$r,3,oi)}l(){return Vt(this,$r,3,oi)}},oi=[2,3],ai=class extends pe{},si=class extends pe{},ci=class extends pe{},li=class extends pe{h(){return le(this,Br,2,ui)}g(){return Vt(this,Br,2,ui)}j(){return le(this,$r,3,ui)}l(){return Vt(this,$r,3,ui)}},ui=[2,3],pi=[5,6],di=class extends pe{},fi=class extends pe{},hi=[1,2,3],gi=class extends Error{constructor(){super("Failed to create CoActivity: Connection refused - Meet refused to begin Live Sharing")}},yi=class{constructor(t){this.config=t}start(){return null!=this.g||(this.g=setInterval(()=>{this.config.ha()},this.config.da)),this}shutdown(){clearInterval(this.g)}};function mi(){const t=new Map,e={set:(n,r)=>(t.set(n,r),e),D:()=>t};return e}function vi(t){if(t.g()){var e=(t=t.h().m)[D],n=$t(t,e,1),r=V(n,!0);if(null!=r&&r!==n&&Kt(t,e,1,r),e=null==(t=r)?k():t,t=Uint8Array,I(A),null!=(n=e.g)&&!E(n))if("string"==typeof n){b.test(n)&&(n=n.replace(b,P)),n=atob(n),r=new Uint8Array(n.length);for(let t=0;t<n.length;t++)r[t]=n.charCodeAt(t);n=r}else n=null;return{bytes:new t((e=null==n?n:e.g=n)||0)}}}function wi(t,e){return e=Si(e),ee(t,2,ui,e),t}function bi(t,e){return e=Si(e),ee(t,2,oi,e),t}function Si(t){return Yt(new Br,1,V(t.bytes,!1),k())}function Pi(t){if(t.l()){var e,n,r=se(t=t.j(),1),i=null!=(n=null==(e=Qt(t,ye,2))?void 0:ae(e))?n:0;let o=(n=t.m)[D];const a=$t(n,o,4);return null!=(e=null==a||"number"==typeof a?a:"NaN"===a||"Infinity"===a||"-Infinity"===a?Number(a):void 0)&&e!==a&&Kt(n,o,4,e),{mediaId:r,mediaPlayoutPosition:i,mediaPlayoutRate:oe(e,0),playbackState:ki.get(ce(t,3))}}}function Ei(t,e){return e=Ci(e),ee(t,3,ui,e),t}function Ai(t,e){return e=Ci(e),ee(t,3,oi,e),t}const ki=mi().set(0,"INVALID").set(1,"BUFFERING").set(2,"PLAY").set(3,"PAUSE").set(4,"ENDED").D(),Ti=mi().set("INVALID",0).set("BUFFERING",1).set("PLAY",2).set("PAUSE",3).set("ENDED",4).D();function Ci(t){var e=new $r;e=Yt(e,1,Et(t.mediaId),"");var n=t.mediaPlayoutRate;if(null!=n&&"number"!=typeof n)throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);return e=Yt(e,4,n,0),n=Yt(n=new ye,1,bt(t.mediaPlayoutPosition),"0"),Yt(e=te(e,2,n),3,vt(t=Ti.get(t.playbackState)),0)}function xi(t,e){return e=Yt(new si,1,vt(e.u),0),ee(t,6,pi,e),t}function Ii(t){var e=new ai;return ee(t,5,pi,e),t}const Mi=mi().set("co-doing",1).set("co-watching",2).D();async function Ri(t,e,n){var r=e.C,i=new fi,o=new di;let a;if(o=Yt(o,1,Et(t.activityTitle),""),o=Yt(o,2,vt(Mi.get(t.K)),0),i=ee(i,3,hi,o),null!=(a=oe(gt(Gt(r=await r.call(e,i,Vr),1)),!1))&&a)return new Ni(t,e,n,Qt(r,Jr,2));throw new gi}function ji(t,e){const n=t.config.N(e);n&&!t.config.M(t.g,n)&&(t.g=n,t.j=ae(e),t.v(t.g))}function Oi(t,e){const{state:n,fa:r,context:i}=e(t.g);t.g=n,t.notify(t.g,i,r)}class Ni{constructor(t,e,n,r){this.l=t,this.h=e,this.config=n,this.v=function(t){var e=new we(500);let n,r=0;return(...i)=>{me(e)?t(...i):(n=()=>{t(...i)},r||(r=setTimeout(()=>{let t;r=0,null==(t=n)||t()},function(t){const e=t.g;return(t=ve(t,t.index))>=e?0:e-t}(e))))}}(t=>{this.l.O(t)}),function(t,e){const n=Rr(t.signal,t=>{e(t)});t.o.push(n)}(this.h,t=>{const e=Ht(t,Yr);switch(e){case 1:ji(this,le(t,Jr,1,Yr));break;case 2:case 0:console.warn(`IllegalMessage: ${e} - Unhandled message - Please raise a bug with the MeetJS team`)}}),this.B=new yi({da:1e3,ha:()=>{var t,e,n=null==(e=(t=this.l).ja)?void 0:e.call(t);if(null!==this.g){this.g={...this.g,...n},t=new fi,n=(e=this.config).W;var r=new ii;r=Yt(r,1,bt(this.j),"0"),e=n.call(e,r,this.g),t=ee(t,1,hi,e),this.h.send(t)}}}).start(),this.g=null,this.j=0,r&&ji(this,r)}disconnect(){this.h.shutdown(),this.B.shutdown()}notify(t,e,n){var r=n?function({activityTitle:t}){return Jt(new ci,4,Et(t))}(n):void 0,i=(n=this.config).X,o=new li;r=te(o=Yt(o,1,bt(this.j),"0"),4,r),t=i.call(n,r,t),t=this.config.V(t,e),n=(e=this.h).send,t=ee(i=new fi,2,hi,t),n.call(e,t)}}var _i=class{constructor(t){this.g=t}broadcastStateUpdate(t){Oi(this.g,()=>({state:t,context:{}}))}disconnect(){this.g.disconnect()}};function Di(t,e){return null!=t&&null!=e&&t.bytes.length===e.bytes.length&&t.bytes.every((t,n)=>t===e.bytes[n])}var Ui=class{constructor(t){this.g=t}notifySwitchedToMedia(t,e,n){Oi(this.g,()=>({state:{mediaId:e,mediaPlayoutRate:1,mediaPlayoutPosition:n,playbackState:"PLAY"},fa:{activityTitle:t},context:{u:1}}))}notifyPauseState(t,e){Oi(this.g,n=>{if(null==n)throw Error("Invalid before coWatchingState");return{state:{...n,playbackState:t?"PAUSE":"PLAY",mediaPlayoutPosition:e},context:{u:3}}})}notifySeekToTimestamp(t){Oi(this.g,e=>{if(null==e)throw Error("Invalid before coWatchingState");return{state:{...e,mediaPlayoutPosition:t},context:{u:2}}})}notifyPlayoutRate(t){Oi(this.g,e=>{if(null==e)throw Error("Invalid before coWatchingState");return{state:{...e,mediaPlayoutRate:t},context:{u:4}}})}notifyBuffering(t){Oi(this.g,e=>{if(null==e)throw Error("Invalid before coWatchingState");return{state:{...e,mediaPlayoutPosition:t,playbackState:"BUFFERING"},context:{u:3}}})}notifyReady(t){Oi(this.g,e=>{if(null==e)throw Error("Invalid before coWatchingState");return{state:{...e,mediaPlayoutPosition:t},context:{u:3}}})}disconnect(){this.g.disconnect()}};function Li(t,e){if(null==t||null==e)return!1;const n="PLAY"===t.playbackState?3*Math.max(t.mediaPlayoutRate,1):0,r=Math.abs(t.mediaPlayoutPosition-e.mediaPlayoutPosition);return t.mediaId===e.mediaId&&t.mediaPlayoutRate===e.mediaPlayoutRate&&r<=n&&t.playbackState===e.playbackState}var zi=class{constructor(t,e){this.channel=t,this.signal=e,this.o=[]}send(t){this.channel.send(ue(t))}async C(t,e){return e((t=await this.channel.C(ue(t))).data)}shutdown(){this.o.forEach(t=>{this.signal.detach(t)})}};async function Fi(t){const e=new Ir,n=e.signal();!function(t,e,n,r=t=>t){Rr(n,n=>{xr(t,e,r(n))},t)}(e,n,(t=await t).signal,t=>t.content);const{ia:r,ga:i}=function(t,e){var n=Gi;const r=t.signal(),i=t.signal();return Rr(e,e=>{const o=n(e)?r:i;xr(t,o,e)},t),{ia:r,ga:i}}(e,n);return{Z:new zi(t.channel,r),aa:new zi(t.channel,i)}}function Gi(t){if(1!==Ht(t,Yr))throw Error("CA Message arrived with no known content message set");return(t=le(t,Jr,1,Yr)).g()}var Bi=class extends Cn{async notifySidePanel(t){await ti(this.context.g,1,t)}async unloadSidePanel(){await async function(t){var e=Zr,n=new Gn,r=new Fn;n=ee(n,5,Bn,r),await e(t,Lr(n))}(this.context.g)}async loadSidePanel(){await async function(t){var e=Zr,n=new Gn,r=new _n;n=ee(n,6,Bn,r),await e(t,Lr(n))}(this.context.g)}},$i=class extends Cn{async setAddonStartingState(t){if(null===t)throw new Ee(Ue("addonStartingState"));if("object"!=typeof t)throw new Ee(Le("addonStartingState",typeof t,"object | undefined"));if(void 0!==t.sidePanelUrl&&"string"!=typeof t.sidePanelUrl)throw new Ee(Le("sidePanelUrl",typeof t.sidePanelUrl,"string | undefined"));if(void 0!==t.additionalData&&"string"!=typeof t.additionalData)throw new Ee(Le("additionalData",typeof t.additionalData,"string | undefined"));if(Object.keys(t).length!==+!!t.sidePanelUrl+ +!!t.additionalData)throw new Ee(De);if(0===Object.keys(t).length)throw new Ee(_e);var e=[];e.push(nn(en(tn(1),t.sidePanelUrl),t.additionalData)),t=this.context.g;var n=new zn,r=n.setAddonStartingState;e=ne(new Ln,e),await async function(t,e){var n=Zr;e=ee(new Gn,16,Bn,e),await n(t,Lr(e))}(t,r.call(n,e))}},Ji=class extends Cn{async notifyMainStage(t){await ti(this.context.g,2,t)}},Ki=class{constructor(t){t=t.cloudProjectNumber;const e=In();if(e.cloudProjectNumber!==t)throw new Ee(Me);const n=e.S,r=e.ba;let i;ni=null!=(i=ni)?i:function(t,e,n){const r=new Ir,i=r.signal();return t=(({destination:t,origin:e,ra:n,Y:r="ZNWN1d",onMessage:i})=>{if("*"===e)throw Error("Sending to wildcard origin not allowed.");const o=Yn(i);return t.postMessage(n?{n:r,t:n}:r,e,[o.port2]),Hn(o.port1,i)})({destination:window.parent,origin:e,Y:t,onMessage:t=>{const e=Jn(t.data.content);2===Ht(e,Kn)&&xr(r,i,{content:le(e,yn,2,Kn),ka:t,messagePort:t.data.messagePort})}}),new ei(i,t,n)}(r,n,t),this.g=new ri(e)}async createMainStageClient(){var t=this.g;if(2!==t.h.frameType)throw new Ee(Te);return await Promise.resolve(new Bi(t))}async createSidePanelClient(){var t=this.g;if(1!==t.h.frameType)throw new Ee(Ce);return await Promise.resolve(new Ji(t))}async createCoWatchingClient(t){return await async function(t,e){if(({aa:t}=await Fi(Qr(t.g))),e=await async function(t,e){if(e)return t=await Ri({activityTitle:e.activityTitle,K:"co-watching",ja:()=>e.onCoWatchingStateQuery(),O:t=>{e.onCoWatchingStateChanged(t)}},t,{X:Ei,W:Ai,V:xi,N:Pi,M:Li}),new Ui(t)}(t,e),!e)throw Error("Failed to create co-watching session");return e}(this.g,t)}async createCoDoingClient(t){return await async function(t,e){if(({Z:t}=await Fi(Qr(t.g))),e=await async function(t,e){if(e)return t=await Ri({activityTitle:e.activityTitle,K:"co-doing",O:t=>{e.onCoDoingStateChanged(t)}},t,{X:wi,W:bi,V:Ii,N:vi,M:Di}),new _i(t)}(t,e),!e)throw Error("Failed to create co-doing session");return e}(this.g,t)}async createRoomsStandaloneClient(){var t=this.g;if(2!==t.h.frameType)throw new Ee(Te);return await Promise.resolve(new $i(t))}};let Vi=null;var Wi,Yi={addon:{getFrameType:function(){t:{var t=In().frameType;switch(t){case 2:t="MAIN_STAGE";break t;case 1:t="SIDE_PANEL";break t;default:throw Error(`Unknown frame type: ${t}`)}}return t},createAddonSession:async function(t){if(null===t)throw new Ee(Ue("config"));if("object"!=typeof t)throw new Ee(Le("config",typeof t,"object"));if("string"!=typeof t.cloudProjectNumber)throw new Ee(Le("cloudProjectNumber",typeof t.cloudProjectNumber,"string"));if(Vi&&"integration.test.google.com"!==In().S)throw new Ee(Ve);return Vi=new Ki(t)}}},Hi=["meet"],qi=i;Hi[0]in qi||void 0===qi.execScript||qi.execScript("var "+Hi[0]);for(;Hi.length&&(Wi=Hi.shift());)Hi.length||void 0===Yi?qi=qi[Wi]&&qi[Wi]!==Object.prototype[Wi]?qi[Wi]:qi[Wi]={}:qi[Wi]=Yi}).apply(n);const r=n.meet;function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function a(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(a=function(){return!!t})()}function s(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function l(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return u(l,"_invoke",function(n,r,i){var o,s,c,l=0,u=i||[],p=!1,d={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return o=e,s=0,c=t,d.n=n,a}};function f(n,r){for(s=n,c=r,e=0;!p&&l&&!i&&e<u.length;e++){var i,o=u[e],f=d.p,h=o[2];n>3?(i=h===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,d.v=r,d.n=o[1]):f<h&&(i=n<3||o[0]>r||r>h)&&(o[4]=n,o[5]=r,d.n=h,s=0))}if(i||n>1)return a;throw p=!0,r}return function(i,u,h){if(l>1)throw TypeError("Generator is already running");for(p&&1===u&&f(u,h),s=u,c=h;(e=s<2?t:c)||!p;){o||(s?s<3?(s>1&&(d.n=-1),f(s,c)):d.n=c:d.v=c);try{if(l=2,o){if(s||(i="next"),e=o[i]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=t}else if((e=(p=d.n<0)?c:n.call(r,d))!==a)break}catch(e){o=t,s=1,c=e}finally{l=1}}return{value:e,done:p}}}(n,i,o),!0),l}var a={};function s(){}function c(){}function p(){}e=Object.getPrototypeOf;var d=[][r]?e(e([][r]())):(u(e={},r,function(){return this}),e),f=p.prototype=s.prototype=Object.create(d);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=p,u(f,"constructor",p),u(p,"constructor",c),c.displayName="GeneratorFunction",u(p,i,"GeneratorFunction"),u(f),u(f,i,"Generator"),u(f,r,function(){return this}),u(f,"toString",function(){return"[object Generator]"}),(l=function(){return{w:o,m:h}})()}function u(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}u=function(t,e,n,r){function o(e,n){u(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},u(t,e,n,r)}function p(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function d(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(t){p(o,r,i,a,s,"next",t)}function s(t){p(o,r,i,a,s,"throw",t)}a(void 0)})}}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function h(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}var g=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.credentials=e,this.participants=new Map,this.audioStreams=new Map,this.isConnected=!1,this.meetingId=null,this.meetSession=null,this.csrcToParticipant=new Map,this.unmappedCSRCs=new Map,this.rtpReceiverToParticipant=new Map,this.onParticipantJoined=null,this.onParticipantLeft=null,this.onAudioData=null,this.onError=null},e=[{key:"initializeAuth",value:(y=d(l().m(function t(){var e;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,console.log("Initializing Google Meet Media API authentication..."),this.credentials.serviceAccountEmail&&this.credentials.clientId){t.n=1;break}throw new Error("Missing required credentials");case 1:return console.log("✅ Google Meet Media API authentication successful"),t.a(2,!0);case 2:throw t.p=2,e=t.v,console.error("❌ Authentication failed:",e),e;case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return y.apply(this,arguments)})},{key:"joinMeeting",value:(g=d(l().m(function t(e,n){var r;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,console.log("Joining meeting: ".concat(e)),this.meetingId=e,this.meetSession=n,t.n=1,this.startRealParticipantTracking();case 1:return t.n=2,this.startRealAudioProcessing();case 2:return this.isConnected=!0,console.log("✅ Successfully joined meeting as media bot"),t.a(2,{success:!0,meetingId:e});case 3:throw t.p=3,r=t.v,console.error("❌ Failed to join meeting:",r),r;case 4:return t.a(2)}},t,this,[[0,3]])})),function(t,e){return g.apply(this,arguments)})},{key:"startRealParticipantTracking",value:(h=d(l().m(function t(){var e,n=this;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,console.log("Starting real participant tracking..."),this.meetSession){t.n=1;break}throw new Error("Meet session not available");case 1:return t.n=2,this.getCurrentParticipants();case 2:t.v.forEach(function(t){n.handleParticipantJoined(t)}),this.setupParticipantMonitoring(),this.setupCSRCMonitoring(),t.n=4;break;case 3:throw t.p=3,e=t.v,console.error("Error starting participant tracking:",e),e;case 4:return t.a(2)}},t,this,[[0,3]])})),function(){return h.apply(this,arguments)})},{key:"setupCSRCMonitoring",value:function(){try{console.log("Setting up CSRC monitoring from RTP streams..."),this.accessWebRTCPeerConnections(),this.monitorRTPPackets()}catch(t){console.error("Error setting up CSRC monitoring:",t)}}},{key:"accessWebRTCPeerConnections",value:function(){var t=this;try{this.findPeerConnections().forEach(function(e,n){console.log("Found peer connection ".concat(n,":"),e),t.monitorPeerConnectionRTP(e)})}catch(t){console.error("Error accessing peer connections:",t)}}},{key:"findPeerConnections",value:function(){var t=[];if(window.RTCPeerConnection){var e=this.getAllPeerConnections();t.push.apply(t,s(e))}return window.meet&&window.meet.peerConnections&&t.push.apply(t,s(window.meet.peerConnections)),document.querySelectorAll("video").forEach(function(e){e.srcObject&&e.srcObject.getSenders&&e.srcObject.getSenders().forEach(function(e){e.transport&&e.transport.pc&&t.push(e.transport.pc)})}),t}},{key:"getAllPeerConnections",value:function(){var t=[],e=window.RTCPeerConnection;return window.RTCPeerConnection=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var s=function(t,e,n){if(a())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(t.bind.apply(t,r));return n&&o(i,n.prototype),i}(e,r);return t.push(s),s},Object.setPrototypeOf(window.RTCPeerConnection,e),Object.setOwnPropertyNames(e).forEach(function(t){window.RTCPeerConnection[t]=e[t]}),t}},{key:"monitorPeerConnectionRTP",value:function(t){var e=this;try{t.getReceivers().forEach(function(t){t.track&&"audio"===t.track.kind&&(console.log("Found audio receiver:",t),e.monitorAudioReceiverRTP(t))})}catch(t){console.error("Error monitoring peer connection RTP:",t)}}},{key:"monitorAudioReceiverRTP",value:function(t){try{if(t.track&&t.track._rtpReceiver){var e=t.track._rtpReceiver;this.interceptRTPPacketProcessing(e)}}catch(t){console.error("Error monitoring audio receiver RTP:",t)}}},{key:"interceptRTPPacketProcessing",value:function(t){var e=this;try{if(t.processPacket){var n=t.processPacket.bind(t);t.processPacket=function(t){var r=e.extractCSRCFromRTPPacket(t);return r&&(console.log("Extracted CSRC from RTP packet:",r),e.handleRTPPacketWithCSRC(t,r)),n(t)}}}catch(t){console.error("Error intercepting RTP packet processing:",t)}}},{key:"extractCSRCFromRTPPacket",value:function(t){try{if(t&&t.length>=12){var e=new DataView(t),n=15&e.getUint8(0);if(n>0&&t.length>=12+4*n){for(var r=[],i=0;i<n;i++){var o=e.getUint32(12+4*i);r.push(o)}return r[0]}}return null}catch(t){return console.error("Error extracting CSRC from RTP packet:",t),null}}},{key:"handleRTPPacketWithCSRC",value:function(t,e){try{var n=this.csrcToParticipant.get(e),r=this.participants.get(n);if(r){var i=this.convertRTPPayloadToAudio(t.slice(12));this.handleAudioData({participantId:n,participantName:r.name,audioData:i,timestamp:Date.now(),csrc:e})}else console.log("CSRC ".concat(e," not mapped to participant yet")),this.unmappedCSRCs.set(e,t)}catch(t){console.error("Error handling RTP packet with CSRC:",t)}}},{key:"monitorRTPPackets",value:function(){try{this.setupGlobalRTPMonitoring()}catch(t){console.error("Error monitoring RTP packets:",t)}}},{key:"setupGlobalRTPMonitoring",value:function(){try{this.overrideGlobalRTPProcessing()}catch(t){console.error("Error setting up global RTP monitoring:",t)}}},{key:"overrideGlobalRTPProcessing",value:function(){try{console.log("Global RTP monitoring setup complete")}catch(t){console.error("Error overriding global RTP processing:",t)}}},{key:"getCurrentParticipants",value:(p=d(l().m(function t(){var e,n,r=this;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,!this.meetSession||!this.meetSession.getParticipants){t.n=2;break}return t.n=1,this.meetSession.getParticipants();case 1:return e=t.v,t.a(2,e.map(function(t,e){return{id:t.id||"participant_".concat(e),displayName:t.displayName||t.name||"Unknown",csrc:t.csrc||r.generateCSRC(t.id),isLocal:t.isLocal||!1,email:t.email,avatar:t.avatar}}));case 2:return t.n=3,this.getParticipantsFromMeetSession();case 3:return t.a(2,t.v);case 4:return t.p=4,n=t.v,console.error("Error getting participants:",n),t.a(2,[])}},t,this,[[0,4]])})),function(){return p.apply(this,arguments)})},{key:"getParticipantsFromMeetSession",value:(u=d(l().m(function t(){var e;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.a(2,[]);case 1:return t.p=1,e=t.v,console.error("Error getting participants from Meet session:",e),t.a(2,[])}},t,null,[[0,1]])})),function(){return u.apply(this,arguments)})},{key:"generateCSRC",value:function(t){for(var e=0,n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e&=e;return Math.abs(e)}},{key:"setupParticipantMonitoring",value:function(){var t=this;try{this.meetSession&&this.meetSession.onParticipantJoined&&this.meetSession.onParticipantJoined(function(e){console.log("Real participant joined:",e),t.handleParticipantJoined({id:e.id,displayName:e.displayName||e.name,csrc:e.csrc||t.generateCSRC(e.id),isLocal:e.isLocal||!1,email:e.email,avatar:e.avatar})}),this.meetSession&&this.meetSession.onParticipantLeft&&this.meetSession.onParticipantLeft(function(e){console.log("Real participant left:",e),t.handleParticipantLeft(e)}),this.meetSession&&this.meetSession.onParticipantUpdated&&this.meetSession.onParticipantUpdated(function(e){console.log("Real participant updated:",e),t.updateParticipant(e)})}catch(t){console.error("Error setting up participant monitoring:",t)}}},{key:"handleParticipantJoined",value:function(t){console.log("Participant joined:",t);var e={id:t.id,name:t.displayName||"Unknown",csrc:t.csrc,isLocal:t.isLocal||!1,joinedAt:new Date,transcript:"",isSpeaking:!1};this.participants.set(t.id,e),t.csrc&&(this.csrcToParticipant.set(t.csrc,t.id),this.processUnmappedCSRCPackets(t.csrc)),this.extractCSRCFromParticipant(t),this.onParticipantJoined&&this.onParticipantJoined(e)}},{key:"extractCSRCFromParticipant",value:function(t){var e=this;try{this.findParticipantAudioTracks(t).forEach(function(n){e.monitorParticipantAudioTrack(n,t)})}catch(t){console.error("Error extracting CSRC from participant:",t)}}},{key:"findParticipantAudioTracks",value:function(t){var e=this,n=[];return document.querySelectorAll("audio").forEach(function(r){r.srcObject&&r.srcObject.getAudioTracks&&r.srcObject.getAudioTracks().forEach(function(r){e.isTrackForParticipant(r,t)&&n.push(r)})}),n}},{key:"isTrackForParticipant",value:function(t,e){return"audio"===t.kind}},{key:"monitorParticipantAudioTrack",value:function(t,e){try{if(t._rtpReceiver){var n=t._rtpReceiver;this.interceptRTPPacketProcessing(n),this.rtpReceiverToParticipant.set(n,e)}}catch(t){console.error("Error monitoring participant audio track:",t)}}},{key:"processUnmappedCSRCPackets",value:function(t){var e=this.unmappedCSRCs.get(t);e&&(console.log("Processing unmapped packet for CSRC ".concat(t)),this.handleRTPPacketWithCSRC(e,t),this.unmappedCSRCs.delete(t))}},{key:"handleParticipantLeft",value:function(t){console.log("Participant left:",t);var e=this.participants.get(t);e&&(e.csrc&&this.csrcToParticipant.delete(e.csrc),this.participants.delete(t),this.onParticipantLeft&&this.onParticipantLeft(e))}},{key:"updateParticipant",value:function(t){var e=this.participants.get(t.id);e&&(Object.assign(e,t),t.csrc&&t.csrc!==e.csrc&&(this.csrcToParticipant.delete(e.csrc),this.csrcToParticipant.set(t.csrc,t.id),e.csrc=t.csrc),console.log("Participant updated:",e))}},{key:"startRealAudioProcessing",value:(c=d(l().m(function t(){var e;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,console.log("Starting real audio stream processing..."),this.meetSession){t.n=1;break}throw new Error("Meet session not available");case 1:return t.n=2,this.setupAudioStreamMonitoring();case 2:t.n=4;break;case 3:throw t.p=3,e=t.v,console.error("Error starting audio processing:",e),e;case 4:return t.a(2)}},t,this,[[0,3]])})),function(){return c.apply(this,arguments)})},{key:"setupAudioStreamMonitoring",value:(i=d(l().m(function t(){var e=this;return l().w(function(t){for(;;)switch(t.n){case 0:try{this.meetSession&&this.meetSession.onAudioStream&&this.meetSession.onAudioStream(function(t){console.log("Real audio stream received:",t),e.processRealAudioStream(t)}),this.meetSession&&this.meetSession.onAudioData&&this.meetSession.onAudioData(function(t){console.log("Real audio data received:",t),e.processRealAudioData(t)}),this.meetSession&&this.meetSession.onRTPPacket&&this.meetSession.onRTPPacket(function(t){console.log("Real RTP packet received:",t),e.processRTPPacket(t)})}catch(t){console.error("Error setting up audio stream monitoring:",t)}case 1:return t.a(2)}},t,this)})),function(){return i.apply(this,arguments)})},{key:"processRealAudioStream",value:function(t){try{var e=t.participantId,n=t.audioData,r=t.timestamp,i=t.csrc,o=this.participants.get(e);if(!o&&i){var a=this.csrcToParticipant.get(i);o=this.participants.get(a)}o&&this.handleAudioData({participantId:o.id,participantName:o.name,audioData:n,timestamp:r,csrc:i||o.csrc})}catch(t){console.error("Error processing audio stream:",t)}}},{key:"processRealAudioData",value:function(t){try{var e=t.csrc,n=t.data,r=t.timestamp,i=this.csrcToParticipant.get(e),o=this.participants.get(i);o&&this.handleAudioData({participantId:i,participantName:o.name,audioData:n,timestamp:r,csrc:e})}catch(t){console.error("Error processing audio data:",t)}}},{key:"processRTPPacket",value:function(t){try{var e=t.csrc,n=t.payload,r=t.timestamp,i=t.ssrc,o=this.csrcToParticipant.get(e),a=this.participants.get(o);if(a){var s=this.convertRTPPayloadToAudio(n);this.handleAudioData({participantId:o,participantName:a.name,audioData:s,timestamp:r,csrc:e,ssrc:i})}}catch(t){console.error("Error processing RTP packet:",t)}}},{key:"convertRTPPayloadToAudio",value:function(t){try{for(var e=new Int16Array(t.length/2),n=0;n<t.length;n+=2)e[n/2]=t[n+1]<<8|t[n];return e}catch(t){return console.error("Error converting RTP payload:",t),new Int16Array(0)}}},{key:"handleAudioData",value:function(t){var e=t.csrc,n=t.audioData,r=t.timestamp,i=this.csrcToParticipant.get(e),o=this.participants.get(i);o&&this.onAudioData&&this.onAudioData({participantId:i,participantName:o.name,audioData:n,timestamp:r,csrc:e})}},{key:"getMeetingInfo",value:(r=d(l().m(function t(){var e;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,!this.meetSession||!this.meetSession.getMeetingInfo){t.n=2;break}return t.n=1,this.meetSession.getMeetingInfo();case 1:return t.a(2,t.v);case 2:return t.a(2,null);case 3:return t.p=3,e=t.v,console.error("Error getting meeting info:",e),t.a(2,null)}},t,this,[[0,3]])})),function(){return r.apply(this,arguments)})},{key:"hasRealData",value:function(){return this.meetSession&&this.isConnected}},{key:"leaveMeeting",value:(n=d(l().m(function t(){var e;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:t.p=0,console.log("Leaving meeting..."),this.isConnected=!1,this.participants.clear(),this.audioStreams.clear(),this.csrcToParticipant.clear(),console.log("✅ Successfully left meeting"),t.n=2;break;case 1:throw t.p=1,e=t.v,console.error("Error leaving meeting:",e),e;case 2:return t.a(2)}},t,this,[[0,1]])})),function(){return n.apply(this,arguments)})},{key:"getParticipants",value:function(){return Array.from(this.participants.values())}},{key:"getParticipant",value:function(t){return this.participants.get(t)}}],e&&f(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i,c,u,p,h,g,y}();function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){l=!0,i=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(t,e)||v(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return w(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function b(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return S(l,"_invoke",function(n,r,i){var o,s,c,l=0,u=i||[],p=!1,d={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return o=e,s=0,c=t,d.n=n,a}};function f(n,r){for(s=n,c=r,e=0;!p&&l&&!i&&e<u.length;e++){var i,o=u[e],f=d.p,h=o[2];n>3?(i=h===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,d.v=r,d.n=o[1]):f<h&&(i=n<3||o[0]>r||r>h)&&(o[4]=n,o[5]=r,d.n=h,s=0))}if(i||n>1)return a;throw p=!0,r}return function(i,u,h){if(l>1)throw TypeError("Generator is already running");for(p&&1===u&&f(u,h),s=u,c=h;(e=s<2?t:c)||!p;){o||(s?s<3?(s>1&&(d.n=-1),f(s,c)):d.n=c:d.v=c);try{if(l=2,o){if(s||(i="next"),e=o[i]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=t}else if((e=(p=d.n<0)?c:n.call(r,d))!==a)break}catch(e){o=t,s=1,c=e}finally{l=1}}return{value:e,done:p}}}(n,i,o),!0),l}var a={};function s(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(S(e={},r,function(){return this}),e),p=l.prototype=s.prototype=Object.create(u);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,S(t,i,"GeneratorFunction")),t.prototype=Object.create(p),t}return c.prototype=l,S(p,"constructor",l),S(l,"constructor",c),c.displayName="GeneratorFunction",S(l,i,"GeneratorFunction"),S(p),S(p,i,"Generator"),S(p,r,function(){return this}),S(p,"toString",function(){return"[object Generator]"}),(b=function(){return{w:o,m:d}})()}function S(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}S=function(t,e,n,r){function o(e,n){S(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},S(t,e,n,r)}function P(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function E(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(t){P(o,r,i,a,s,"next",t)}function s(t){P(o,r,i,a,s,"throw",t)}a(void 0)})}}function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach(function(e){T(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function T(t,e,n){return(e=M(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,M(r.key),r)}}function I(t,e,n){return e&&x(t.prototype,e),n&&x(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function M(t){var e=function(t){if("object"!=y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:e+""}var R=function(){return I(function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};C(this,t),this.apiKey=e,this.connection=null,this.participants=new Map,this.isConnected=!1,this.options=k({model:"nova-2",language:"en-US",punctuate:!0,profanity_filter:!1,redact:!1,diarize:!0},n)},[{key:"connect",value:(t=E(b().m(function t(){var e,n,r=this;return b().w(function(t){for(;;)switch(t.p=t.n){case 0:t.p=0,e="wss://api.deepgram.com/v1/listen?model=".concat(this.options.model,"&language=").concat(this.options.language,"&punctuate=").concat(this.options.punctuate,"&profanity_filter=").concat(this.options.profanity_filter,"&redact=").concat(this.options.redact,"&diarize=").concat(this.options.diarize,"&interim_results=true&smart_format=true&encoding=linear16&sample_rate=16000&channels=1"),this.connection=new WebSocket(e,{headers:{Authorization:"Token ".concat(this.apiKey)}}),this.connection.onopen=function(){console.log("Deepgram WebSocket connected"),r.isConnected=!0,r.onConnectionOpen()},this.connection.onmessage=function(t){var e=JSON.parse(t.data);r.handleTranscriptionResult(e)},this.connection.onerror=function(t){console.error("Deepgram WebSocket error:",t),r.onConnectionError(t)},this.connection.onclose=function(){console.log("Deepgram WebSocket closed"),r.isConnected=!1,r.onConnectionClose()},t.n=2;break;case 1:throw t.p=1,n=t.v,console.error("Error connecting to Deepgram:",n),n;case 2:return t.a(2)}},t,this,[[0,1]])})),function(){return t.apply(this,arguments)})},{key:"sendAudio",value:function(t){this.connection&&this.isConnected&&this.connection.send(t)}},{key:"handleTranscriptionResult",value:function(t){if(t.channel&&t.channel.alternatives&&t.channel.alternatives.length>0){var e=t.channel.alternatives[0].transcript,n=t.channel.alternatives[0].confidence,r=null;t.channel.alternatives[0].words&&t.channel.alternatives[0].words.length>0&&(r=t.channel.alternatives[0].words[0].speaker),e&&e.trim()&&this.onTranscriptReceived({transcript:e.trim(),confidence:n,speakerId:r,isFinal:t.is_final,timestamp:(new Date).toISOString()})}}},{key:"disconnect",value:function(){this.connection&&(this.connection.close(),this.connection=null),this.isConnected=!1}},{key:"onConnectionOpen",value:function(){console.log("Deepgram connection established")}},{key:"onConnectionError",value:function(t){console.error("Deepgram connection error:",t)}},{key:"onConnectionClose",value:function(){console.log("Deepgram connection closed")}},{key:"onTranscriptReceived",value:function(t){console.log("Transcript received:",t)}}]);var t}(),j=function(){return I(function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;C(this,t),this.mediaStream=null,this.audioContext=null,this.processor=null,this.isCapturing=!1,this.meetMediaAPI=e,this.participantAudioStreams=new Map},[{key:"startCapture",value:(n=E(b().m(function t(){var e;return b().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.startMicrophoneCapture();case 1:if(!this.meetMediaAPI){t.n=2;break}return t.n=2,this.startMeetParticipantAudioCapture();case 2:this.isCapturing=!0,console.log("✅ Audio capture started (microphone + Meet participants)"),t.n=4;break;case 3:throw t.p=3,e=t.v,console.error("Error starting audio capture:",e),e;case 4:return t.a(2)}},t,this,[[0,3]])})),function(){return n.apply(this,arguments)})},{key:"startMicrophoneCapture",value:(e=E(b().m(function t(){var e,n,r=this;return b().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:16e3}});case 1:this.mediaStream=t.v,this.audioContext=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3}),e=this.audioContext.createMediaStreamSource(this.mediaStream),this.processor=this.audioContext.createScriptProcessor(4096,1,1),this.processor.onaudioprocess=function(t){for(var e=t.inputBuffer.getChannelData(0),n=new Int16Array(e.length),i=0;i<e.length;i++)n[i]=Math.max(-32768,Math.min(32767,32768*e[i]));r.onAudioData(n,"microphone")},e.connect(this.processor),this.processor.connect(this.audioContext.destination),console.log("✅ Microphone capture started"),t.n=3;break;case 2:throw t.p=2,n=t.v,console.error("Error starting microphone capture:",n),n;case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return e.apply(this,arguments)})},{key:"startMeetParticipantAudioCapture",value:(t=E(b().m(function t(){return b().w(function(t){for(;;)switch(t.n){case 0:try{console.log("Starting Meet participant audio capture..."),this.setupMeetParticipantAudioProcessing(),console.log("✅ Meet participant audio capture started")}catch(t){console.error("Error starting Meet participant audio capture:",t)}case 1:return t.a(2)}},t,this)})),function(){return t.apply(this,arguments)})},{key:"setupMeetParticipantAudioProcessing",value:function(){var t=this;this.meetMediaAPI&&this.meetMediaAPI.audioStreams&&this.meetMediaAPI.audioStreams.forEach(function(e,n){t.processParticipantAudioStream(e,n)})}},{key:"processParticipantAudioStream",value:function(t,e){var n=this;try{this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3}));var r=this.audioContext.createMediaStreamSource(t),i=this.audioContext.createScriptProcessor(4096,1,1);i.onaudioprocess=function(t){for(var r=t.inputBuffer.getChannelData(0),i=new Int16Array(r.length),o=0;o<r.length;o++)i[o]=Math.max(-32768,Math.min(32767,32768*r[o]));n.onAudioData(i,e)},r.connect(i),i.connect(this.audioContext.destination),this.participantAudioStreams.set(e,{source:r,processor:i}),console.log("✅ Audio processing started for participant: ".concat(e))}catch(t){console.error("Error processing audio stream for participant ".concat(e,":"),t)}}},{key:"stopCapture",value:function(){this.processor&&(this.processor.disconnect(),this.processor=null),this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.mediaStream&&(this.mediaStream.getTracks().forEach(function(t){return t.stop()}),this.mediaStream=null),this.participantAudioStreams.forEach(function(t,e){var n=t.source,r=t.processor;try{r.disconnect(),n.disconnect(),console.log("✅ Audio processing stopped for participant: ".concat(e))}catch(t){console.error("Error stopping audio processing for participant ".concat(e,":"),t)}}),this.participantAudioStreams.clear(),this.isCapturing=!1,console.log("✅ Audio capture stopped")}},{key:"onAudioData",value:function(t){}}]);var t,e,n}(),O=function(){return I(function t(e){C(this,t),this.participants=new Map,this.onParticipantChange=null,this.meetMediaAPI=new g(e),this.isInitialized=!1},[{key:"initialize",value:(t=E(b().m(function t(e,n){var r,i=this;return b().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,console.log("Initializing real Google Meet participant tracking..."),t.n=1,this.meetMediaAPI.initializeAuth();case 1:return t.n=2,this.meetMediaAPI.joinMeeting(e,n);case 2:return this.setupRealParticipantEventHandlers(),t.n=3,this.meetMediaAPI.getCurrentParticipants();case 3:t.v.forEach(function(t){i.handleRealParticipantJoined(t)}),this.isInitialized=!0,console.log("✅ Real Google Meet participant tracking initialized"),t.n=5;break;case 4:t.p=4,r=t.v,console.error("❌ Failed to initialize real participant tracking:",r),console.log("Falling back to mock participant data..."),this.simulateParticipants();case 5:return t.a(2)}},t,this,[[0,4]])})),function(e,n){return t.apply(this,arguments)})},{key:"setupRealParticipantEventHandlers",value:function(){var t=this;this.meetMediaAPI.onParticipantJoined=function(e){console.log("Real participant joined:",e),t.handleRealParticipantJoined(e)},this.meetMediaAPI.onParticipantLeft=function(e){console.log("Real participant left:",e),t.handleRealParticipantLeft(e)},this.meetMediaAPI.onAudioData=function(e){console.log("Real audio data received from participant:",e.participantName),t.handleRealParticipantAudio(e)},this.meetMediaAPI.onError=function(t){console.error("MeetMediaAPI error:",t)}}},{key:"handleRealParticipantJoined",value:function(t){var e={id:t.id,name:t.displayName||t.name||"Unknown",csrc:t.csrc,isLocal:t.isLocal||!1,email:t.email,avatar:t.avatar||"👤",transcript:"",isSpeaking:!1,lastSpoke:null,confidence:0,joinedAt:new Date};this.participants.set(t.id,e),this.onParticipantChange&&this.onParticipantChange(Array.from(this.participants.values())),console.log("✅ Real participant added: ".concat(e.name," (").concat(e.id,")"))}},{key:"handleRealParticipantLeft",value:function(t){var e=this.participants.get(t);e&&(this.participants.delete(t),this.onParticipantChange&&this.onParticipantChange(Array.from(this.participants.values())),console.log("✅ Real participant removed: ".concat(e.name," (").concat(t,")")))}},{key:"handleRealParticipantAudio",value:function(t){var e=this,n=this.participants.get(t.participantId);n&&(n.isSpeaking=!0,n.lastSpoke=(new Date).toLocaleTimeString(),this.onParticipantChange&&this.onParticipantChange(Array.from(this.participants.values())),setTimeout(function(){n.isSpeaking=!1,e.onParticipantChange&&e.onParticipantChange(Array.from(e.participants.values()))},3e3))}},{key:"simulateParticipants",value:function(){var t=this;[{id:"user1",name:"John Doe",avatar:"👨‍💼",isLocal:!0},{id:"user2",name:"Jane Smith",avatar:"👩‍💼",isLocal:!1},{id:"user3",name:"Bob Johnson",avatar:"👨‍🔬",isLocal:!1},{id:"user4",name:"Alice Brown",avatar:"👩‍🎨",isLocal:!1}].forEach(function(e){t.participants.set(e.id,k(k({},e),{},{transcript:"",isSpeaking:!1,lastSpoke:null,confidence:0}))}),this.onParticipantChange&&this.onParticipantChange(Array.from(this.participants.values()))}},{key:"getParticipant",value:function(t){return this.participants.get(t)}},{key:"updateParticipantTranscript",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.participants.get(t);r&&(r.transcript+=(r.transcript?" ":"")+e,r.confidence=n,r.lastSpoke=(new Date).toLocaleTimeString(),this.onParticipantChange&&this.onParticipantChange(Array.from(this.participants.values())))}},{key:"setParticipantSpeaking",value:function(t,e){var n=this.participants.get(t);n&&(n.isSpeaking=e,this.onParticipantChange&&this.onParticipantChange(Array.from(this.participants.values())))}},{key:"getAllParticipants",value:function(){return Array.from(this.participants.values())}}]);var t}(),N=function(){return I(function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;C(this,t),this.deepgram=new R(e),this.meetMediaAPI=n?new g(n):null,this.audioCapture=new j(this.meetMediaAPI),this.participantManager=new O(n),this.isTranscribing=!1,this.meetingId=null,this.meetSession=null,this.setupEventHandlers()},[{key:"setupEventHandlers",value:function(){var t=this;this.deepgram.onTranscriptReceived=function(e){t.handleTranscript(e)},this.deepgram.onConnectionOpen=function(){console.log("Deepgram connected successfully")},this.deepgram.onConnectionError=function(t){console.error("Deepgram connection error:",t)},this.deepgram.onConnectionClose=function(){console.log("Deepgram connection closed")},this.audioCapture.onAudioData=function(e,n){t.isTranscribing&&t.deepgram.sendAudio(e,n)},this.participantManager.onParticipantChange=function(e){t.onParticipantsUpdated(e)}}},{key:"startTranscription",value:(e=E(b().m(function t(){var e,n,r,i=arguments;return b().w(function(t){for(;;)switch(t.p=t.n){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:null,n=i.length>1&&void 0!==i[1]?i[1]:null,t.p=1,console.log("Starting transcription with real Google Meet integration..."),this.meetingId=e,this.meetSession=n,t.n=2,this.participantManager.initialize(e,n);case 2:return t.n=3,this.deepgram.connect();case 3:return t.n=4,this.audioCapture.startCapture();case 4:this.isTranscribing=!0,console.log("✅ Transcription started successfully with real Google Meet integration"),t.n=6;break;case 5:throw t.p=5,r=t.v,console.error("Error starting transcription:",r),r;case 6:return t.a(2)}},t,this,[[1,5]])})),function(){return e.apply(this,arguments)})},{key:"stopTranscription",value:(t=E(b().m(function t(){var e;return b().w(function(t){for(;;)switch(t.p=t.n){case 0:t.p=0,console.log("Stopping transcription..."),this.isTranscribing=!1,this.audioCapture.stopCapture(),this.deepgram.disconnect(),console.log("Transcription stopped successfully"),t.n=2;break;case 1:throw t.p=1,e=t.v,console.error("Error stopping transcription:",e),e;case 2:return t.a(2)}},t,this,[[0,1]])})),function(){return t.apply(this,arguments)})},{key:"handleTranscript",value:function(t){var e=this,n=t.transcript,r=t.confidence,i=t.speakerId,o=t.isFinal;if(n&&o){var a=this.mapSpeakerToParticipant(i);a&&(this.participantManager.updateParticipantTranscript(a,n,r),this.participantManager.setParticipantSpeaking(a,!0),setTimeout(function(){e.participantManager.setParticipantSpeaking(a,!1)},3e3))}}},{key:"mapSpeakerToParticipant",value:function(t){if(this.meetMediaAPI&&this.meetMediaAPI.csrcToParticipant){var e,n=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=v(t))){e&&(t=e);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==e.return||e.return()}finally{if(a)throw i}}}}(this.participantManager.participants);try{for(n.s();!(e=n.n()).done;){var r=m(e.value,2),i=r[0],o=r[1];if(o.csrc&&o.csrc===t)return i}}catch(t){n.e(t)}finally{n.f()}}var a=Array.from(this.participantManager.participants.keys());return a.length>0&&null!=t?a[t%a.length]:a[0]||"unknown"}},{key:"onParticipantsUpdated",value:function(t){console.log("Participants updated:",t)}},{key:"getStatus",value:function(){return{isTranscribing:this.isTranscribing,isDeepgramConnected:this.deepgram.isConnected,isAudioCapturing:this.audioCapture.isCapturing,participants:this.participantManager.getAllParticipants()}}}]);var t,e}();function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function D(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return U(l,"_invoke",function(n,r,i){var o,s,c,l=0,u=i||[],p=!1,d={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return o=e,s=0,c=t,d.n=n,a}};function f(n,r){for(s=n,c=r,e=0;!p&&l&&!i&&e<u.length;e++){var i,o=u[e],f=d.p,h=o[2];n>3?(i=h===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,d.v=r,d.n=o[1]):f<h&&(i=n<3||o[0]>r||r>h)&&(o[4]=n,o[5]=r,d.n=h,s=0))}if(i||n>1)return a;throw p=!0,r}return function(i,u,h){if(l>1)throw TypeError("Generator is already running");for(p&&1===u&&f(u,h),s=u,c=h;(e=s<2?t:c)||!p;){o||(s?s<3?(s>1&&(d.n=-1),f(s,c)):d.n=c:d.v=c);try{if(l=2,o){if(s||(i="next"),e=o[i]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=t}else if((e=(p=d.n<0)?c:n.call(r,d))!==a)break}catch(e){o=t,s=1,c=e}finally{l=1}}return{value:e,done:p}}}(n,i,o),!0),l}var a={};function s(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(U(e={},r,function(){return this}),e),p=l.prototype=s.prototype=Object.create(u);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,U(t,i,"GeneratorFunction")),t.prototype=Object.create(p),t}return c.prototype=l,U(p,"constructor",l),U(l,"constructor",c),c.displayName="GeneratorFunction",U(l,i,"GeneratorFunction"),U(p),U(p,i,"Generator"),U(p,r,function(){return this}),U(p,"toString",function(){return"[object Generator]"}),(D=function(){return{w:o,m:d}})()}function U(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}U=function(t,e,n,r){function o(e,n){U(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},U(t,e,n,r)}function L(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function z(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(t){L(o,r,i,a,s,"next",t)}function s(t){L(o,r,i,a,s,"throw",t)}a(void 0)})}}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,G(r.key),r)}}function G(t){var e=function(t){if("object"!=_(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_(e)?e:e+""}var B=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.credentials=null,this.isInitialized=!1,this.validationErrors=[]},e=[{key:"initialize",value:(o=z(D().m(function t(){var e;return D().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,console.log("🔐 Initializing secure credential manager..."),t.n=1,this.loadEnvironmentVariables();case 1:if(this.validateCredentials(),0!==this.validationErrors.length){t.n=3;break}return t.n=2,this.initializeGoogleAuth();case 2:this.isInitialized=!0,console.log("✅ Secure credential manager initialized successfully"),t.n=4;break;case 3:throw new Error("Credential validation failed: ".concat(this.validationErrors.join(", ")));case 4:return t.a(2,!0);case 5:throw t.p=5,e=t.v,console.error("❌ Failed to initialize secure credential manager:",e),e;case 6:return t.a(2)}},t,this,[[0,5]])})),function(){return o.apply(this,arguments)})},{key:"loadEnvironmentVariables",value:(i=z(D().m(function t(){var e;return D().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,"undefined"==typeof window){t.n=1;break}return console.warn("⚠️ Running in browser environment - credentials should be provided securely"),t.a(2);case 1:this.credentials={serviceAccountEmail:process.env.SERVICE_ACCOUNT_EMAIL,privateKey:process.env.SERVICE_ACCOUNT_PRIVATE_KEY,clientId:process.env.CLIENT_ID,cloudProjectNumber:process.env.CLOUD_PROJECT_NUMBER,deepgramApiKey:process.env.DEEPGRAM_API_KEY,mainStageUrl:process.env.MAIN_STAGE_URL,sidePanelUrl:process.env.SIDE_PANEL_URL,nodeEnv:"production",logLevel:process.env.LOG_LEVEL||"info"},console.log("📋 Environment variables loaded"),t.n=3;break;case 2:throw t.p=2,e=t.v,console.error("❌ Error loading environment variables:",e),e;case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return i.apply(this,arguments)})},{key:"validateCredentials",value:function(){var t=this;this.validationErrors=[],[{key:"serviceAccountEmail",name:"SERVICE_ACCOUNT_EMAIL"},{key:"privateKey",name:"SERVICE_ACCOUNT_PRIVATE_KEY"},{key:"clientId",name:"CLIENT_ID"},{key:"cloudProjectNumber",name:"CLOUD_PROJECT_NUMBER"},{key:"deepgramApiKey",name:"DEEPGRAM_API_KEY"}].forEach(function(e){t.credentials[e.key]&&"YOUR_PRIVATE_KEY_HERE"!==t.credentials[e.key]&&"YOUR_DEEPGRAM_API_KEY_HERE"!==t.credentials[e.key]||t.validationErrors.push("Missing or placeholder value for ".concat(e.name))}),this.credentials.privateKey&&!this.credentials.privateKey.includes("BEGIN PRIVATE KEY")&&this.validationErrors.push("SERVICE_ACCOUNT_PRIVATE_KEY must be in PEM format"),this.credentials.serviceAccountEmail&&!this.credentials.serviceAccountEmail.includes("@")&&this.validationErrors.push("SERVICE_ACCOUNT_EMAIL must be a valid email address"),this.credentials.clientId&&!this.credentials.clientId.includes(".apps.googleusercontent.com")&&this.validationErrors.push("CLIENT_ID must be a valid Google OAuth client ID"),this.validationErrors.length>0?console.error("❌ Credential validation errors:",this.validationErrors):console.log("✅ All credentials validated successfully")}},{key:"initializeGoogleAuth",value:(r=z(D().m(function t(){return D().w(function(t){for(;;)switch(t.n){case 0:try{"undefined"!=typeof window?(console.log("✅ Using browser-compatible authentication for Google Meet Add-ons"),this.googleAuth={isBrowserMode:!0,platform:"google-meet-addons"},console.log("✅ Browser authentication initialized")):console.warn("⚠️ Running in Node.js environment - Google Meet Add-ons require browser environment")}catch(t){console.warn("⚠️ Authentication initialization warning:",t.message)}case 1:return t.a(2)}},t,this)})),function(){return r.apply(this,arguments)})},{key:"getCredentials",value:function(){if(!this.isInitialized)throw new Error("Credential manager not initialized. Call initialize() first.");if(this.validationErrors.length>0)throw new Error("Invalid credentials: ".concat(this.validationErrors.join(", ")));return{serviceAccountEmail:this.credentials.serviceAccountEmail,privateKey:this.credentials.privateKey,clientId:this.credentials.clientId,cloudProjectNumber:this.credentials.cloudProjectNumber,deepgramApiKey:this.credentials.deepgramApiKey,mainStageUrl:this.credentials.mainStageUrl,sidePanelUrl:this.credentials.sidePanelUrl,nodeEnv:this.credentials.nodeEnv,logLevel:this.credentials.logLevel}}},{key:"getGoogleAuthClient",value:(n=z(D().m(function t(){return D().w(function(t){for(;;)switch(t.n){case 0:if(this.isInitialized){t.n=1;break}throw new Error("Credential manager not initialized");case 1:if(!this.googleAuth||!this.googleAuth.isBrowserMode){t.n=2;break}return t.a(2,{isBrowserMode:!0,platform:"google-meet-addons",getAccessToken:function(){var t=z(D().m(function t(){return D().w(function(t){for(;;)if(0===t.n)return console.log("Using Google Meet Add-ons platform authentication"),t.a(2,{token:"platform-managed"})},t)}));return function(){return t.apply(this,arguments)}}()});case 2:return t.a(2,null)}},t,this)})),function(){return n.apply(this,arguments)})},{key:"isValid",value:function(){return this.isInitialized&&0===this.validationErrors.length}},{key:"getValidationErrors",value:function(){return this.validationErrors}},{key:"logSecurityStatus",value:function(){var t,e;console.log("🔒 Security Status:"),console.log("  - Credential Manager Initialized: ".concat(this.isInitialized)),console.log("  - Validation Errors: ".concat(this.validationErrors.length)),console.log("  - Environment: ".concat((null===(t=this.credentials)||void 0===t?void 0:t.nodeEnv)||"unknown")),console.log("  - Log Level: ".concat((null===(e=this.credentials)||void 0===e?void 0:e.logLevel)||"unknown")),this.validationErrors.length>0&&console.log("  - Validation Errors:",this.validationErrors)}}],e&&F(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i,o}());function $(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return J(l,"_invoke",function(n,r,i){var o,s,c,l=0,u=i||[],p=!1,d={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return o=e,s=0,c=t,d.n=n,a}};function f(n,r){for(s=n,c=r,e=0;!p&&l&&!i&&e<u.length;e++){var i,o=u[e],f=d.p,h=o[2];n>3?(i=h===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,d.v=r,d.n=o[1]):f<h&&(i=n<3||o[0]>r||r>h)&&(o[4]=n,o[5]=r,d.n=h,s=0))}if(i||n>1)return a;throw p=!0,r}return function(i,u,h){if(l>1)throw TypeError("Generator is already running");for(p&&1===u&&f(u,h),s=u,c=h;(e=s<2?t:c)||!p;){o||(s?s<3?(s>1&&(d.n=-1),f(s,c)):d.n=c:d.v=c);try{if(l=2,o){if(s||(i="next"),e=o[i]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=t}else if((e=(p=d.n<0)?c:n.call(r,d))!==a)break}catch(e){o=t,s=1,c=e}finally{l=1}}return{value:e,done:p}}}(n,i,o),!0),l}var a={};function s(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(J(e={},r,function(){return this}),e),p=l.prototype=s.prototype=Object.create(u);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,J(t,i,"GeneratorFunction")),t.prototype=Object.create(p),t}return c.prototype=l,J(p,"constructor",l),J(l,"constructor",c),c.displayName="GeneratorFunction",J(l,i,"GeneratorFunction"),J(p),J(p,i,"Generator"),J(p,r,function(){return this}),J(p,"toString",function(){return"[object Generator]"}),($=function(){return{w:o,m:d}})()}function J(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}J=function(t,e,n,r){function o(e,n){J(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},J(t,e,n,r)}function K(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function V(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(t){K(o,r,i,a,s,"next",t)}function s(t){K(o,r,i,a,s,"throw",t)}a(void 0)})}}var W,Y,H,q=null,X=null,Z=null,Q=null,tt=new Map,et=null,nt=null;function rt(){return it.apply(this,arguments)}function it(){return(it=V($().m(function t(){var e,n;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,console.log("🔐 Initializing secure credentials..."),t.n=1,B.initialize();case 1:return q=B.getCredentials(),X=q.cloudProjectNumber,Z=q.deepgramApiKey,Q=q.mainStageUrl,B.logSecurityStatus(),console.log("✅ Secure credentials initialized successfully"),t.a(2,!0);case 2:throw t.p=2,n=t.v,console.error("❌ Failed to initialize secure credentials:",n),(e=B.getValidationErrors()).length>0&&(console.error("Validation errors:",e),console.error("Please check your .env file and ensure all required credentials are set.")),n;case 3:return t.a(2)}},t,null,[[0,2]])}))).apply(this,arguments)}function ot(){return at.apply(this,arguments)}function at(){return(at=V($().m(function t(){var e;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,console.log("Initializing Meet Media API..."),q){t.n=1;break}throw new Error("Credentials not initialized. Call initializeSecureCredentials() first.");case 1:return(nt=new g(q)).onParticipantJoined=function(t){console.log("Participant joined:",t),tt.set(t.id,t),vt()},nt.onParticipantLeft=function(t){console.log("Participant left:",t),tt.delete(t.id),vt()},nt.onAudioData=function(t){st(t)},nt.onError=function(t){console.error("Meet Media API error:",t),Ct("Meet Media API error: "+t.message,"error")},t.n=2,nt.initializeAuth();case 2:return console.log("✅ Meet Media API initialized successfully"),t.a(2,!0);case 3:return t.p=3,e=t.v,console.error("❌ Failed to initialize Meet Media API:",e),Ct("Failed to initialize Meet Media API: "+e.message,"error"),t.a(2,!1)}},t,null,[[0,3]])}))).apply(this,arguments)}function st(t){var e,n=t.participantId,r=t.participantName,i=t.audioData,o=t.timestamp;console.log("Audio from ".concat(r," (").concat(n,")")),et&&et.isTranscribing&&(e={participantId:n,participantName:r,audioData:i,timestamp:o},et&&et.deepgram.isConnected&&(et.deepgram.sendAudio(e.audioData),et.currentSpeaker={id:e.participantId,name:e.participantName,timestamp:e.timestamp}))}function ct(){console.log("Initializing Deepgram client...");try{if(!Z)throw new Error("Deepgram API key not initialized. Call initializeSecureCredentials() first.");(et=new N(Z,q)).deepgram.onTranscriptReceived=function(t){!function(t){var e=t.transcript,n=t.confidence,r=(t.speakerId,t.isFinal);if(e&&r){var i=et.currentSpeaker;if(i){var o=tt.get(i.id);o&&(o.transcript+=(o.transcript?" ":"")+e,o.isSpeaking=!0,o.lastSpoke=(new Date).toLocaleTimeString(),o.confidence=n,vt(),setTimeout(function(){o.isSpeaking=!1,vt()},3e3),console.log("".concat(i.name,": ").concat(e)))}}}(t)},console.log("Deepgram client initialized successfully")}catch(t){console.error("Error initializing Deepgram:",t),Ct("Error initializing Deepgram: "+t.message,"error")}}function lt(){return ut.apply(this,arguments)}function ut(){return(ut=V($().m(function t(){var e,n,i,o,a;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,rt();case 1:return t.n=2,r.addon.createAddonSession({cloudProjectNumber:X});case 2:return e=t.v,t.n=3,e.createSidePanelClient();case 3:return W=t.v,t.n=4,ot();case 4:if(t.v){t.n=5;break}throw new Error("Failed to initialize Meet Media API");case 5:ct(),n=document.getElementById("start-activity"),i=document.getElementById("start-transcript"),o=document.getElementById("stop-transcript"),n&&n.addEventListener("click",V($().m(function t(){var e;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,W.startActivity({mainStageUrl:Q});case 1:Ct("Activity started successfully!","success"),t.n=3;break;case 2:t.p=2,e=t.v,console.error("Error starting activity:",e),Ct("Error starting activity: "+e.message,"error");case 3:return t.a(2)}},t,null,[[0,2]])}))),i&&i.addEventListener("click",wt),o&&o.addEventListener("click",St),console.log("Add-on initialized successfully"),Ct("Add-on loaded successfully!","success"),t.n=7;break;case 6:t.p=6,a=t.v,console.error("Error setting up add-on:",a),Ct("Error initializing add-on: "+a.message,"error");case 7:return t.a(2)}},t,null,[[0,6]])}))).apply(this,arguments)}function pt(){return dt.apply(this,arguments)}function dt(){return(dt=V($().m(function t(){var e,n;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,q){t.n=1;break}return t.n=1,rt();case 1:return t.n=2,r.addon.createAddonSession({cloudProjectNumber:X});case 2:return e=t.v,t.n=3,e.createMainStageClient();case 3:return Y=t.v,mt(),t.n=4,ft();case 4:console.log("Main stage initialized successfully"),t.n=6;break;case 5:t.p=5,n=t.v,console.error("Error initializing main stage:",n);case 6:return t.a(2)}},t,null,[[0,5]])}))).apply(this,arguments)}function ft(){return ht.apply(this,arguments)}function ht(){return(ht=V($().m(function t(){var e,n;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,console.log("Joining current meeting as media bot..."),nt){t.n=1;break}throw new Error("Meet Media API not initialized");case 1:return t.n=2,gt();case 2:if(!(e=t.v)||!Y){t.n=4;break}return t.n=3,nt.joinMeeting(e,Y);case 3:console.log("✅ Successfully joined meeting as media bot"),t.n=5;break;case 4:return console.log("No active meeting found, using fallback mode"),t.n=5,nt.startRealParticipantTracking();case 5:t.n=7;break;case 6:t.p=6,n=t.v,console.error("Error joining meeting:",n),Ct("Error joining meeting: "+n.message,"error");case 7:return t.a(2)}},t,null,[[0,6]])}))).apply(this,arguments)}function gt(){return yt.apply(this,arguments)}function yt(){return(yt=V($().m(function t(){var e,n,r,i,o;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,!Y||!Y.getMeetingInfo){t.n=2;break}return t.n=1,Y.getMeetingInfo();case 1:return e=t.v,t.a(2,(null==e?void 0:e.meetingId)||(null==e?void 0:e.id));case 2:if(!W||!W.getMeetingInfo){t.n=4;break}return t.n=3,W.getMeetingInfo();case 3:return n=t.v,t.a(2,(null==n?void 0:n.meetingId)||(null==n?void 0:n.id));case 4:if(r=new URLSearchParams(window.location.search),!(i=r.get("meetingId")||r.get("id"))){t.n=5;break}return t.a(2,i);case 5:if(!window.meet||!window.meet.getMeetingId){t.n=7;break}return t.n=6,window.meet.getMeetingId();case 6:return t.a(2,t.v);case 7:return t.a(2,null);case 8:return t.p=8,o=t.v,console.error("Error getting meeting ID:",o),t.a(2,null)}},t,null,[[0,8]])}))).apply(this,arguments)}function mt(){var t,e,n=document.createElement("div");n.id="transcript-container",n.style.cssText="\n    width: 100%;\n    height: 100vh;\n    padding: 20px;\n    font-family: 'Google Sans', Arial, sans-serif;\n    background: #f8f9fa;\n    box-sizing: border-box;\n  ";var r=document.createElement("div");r.style.cssText="\n    background: white;\n    padding: 20px;\n    border-radius: 8px;\n    margin-bottom: 20px;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  ",r.innerHTML='\n    <h1 style="color: #1a73e8; margin: 0 0 20px 0; font-size: 28px;">🎤 Live Transcript</h1>\n    <div style="display: flex; gap: 10px; margin-bottom: 10px;">\n      <button id="start-transcript-btn" style="\n        padding: 12px 24px; \n        background: #34a853; \n        color: white; \n        border: none; \n        border-radius: 6px; \n        cursor: pointer;\n        font-size: 16px;\n        font-weight: 500;\n        transition: background-color 0.2s;\n      ">Start Live Transcript</button>\n      <button id="stop-transcript-btn" style="\n        padding: 12px 24px; \n        background: #ea4335; \n        color: white; \n        border: none; \n        border-radius: 6px; \n        cursor: pointer;\n        font-size: 16px;\n        font-weight: 500;\n        transition: background-color 0.2s;\n        opacity: 0.6;\n        cursor: not-allowed;\n      " disabled>Stop Transcript</button>\n    </div>\n    <div id="transcript-status" style="\n      padding: 10px;\n      border-radius: 4px;\n      font-size: 14px;\n      background: #e8f0fe;\n      color: #1a73e8;\n      display: none;\n    ">Ready to start transcription</div>\n  ';var i=document.createElement("div");i.id="transcript-area",i.style.cssText="\n    background: white;\n    border: 1px solid #dadce0;\n    border-radius: 8px;\n    padding: 20px;\n    height: calc(100vh - 200px);\n    overflow-y: auto;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  ",n.appendChild(r),n.appendChild(i),document.body.appendChild(n),H=i,null===(t=document.getElementById("start-transcript-btn"))||void 0===t||t.addEventListener("click",wt),null===(e=document.getElementById("stop-transcript-btn"))||void 0===e||e.addEventListener("click",St)}function vt(){if(H)if(H.innerHTML="",0!==tt.size){if(tt.forEach(function(t,e){var n=document.createElement("div");n.style.cssText="\n      margin-bottom: 20px;\n      padding: 20px;\n      border: 2px solid ".concat(t.isSpeaking?"#1a73e8":"#e0e0e0",";\n      border-radius: 12px;\n      background: ").concat(t.isSpeaking?"#e8f0fe":"#ffffff",";\n      transition: all 0.3s ease;\n      position: relative;\n    ");var r=t.isSpeaking?'\n      <div style="\n        position: absolute;\n        top: 10px;\n        right: 15px;\n        background: #1a73e8;\n        color: white;\n        padding: 4px 8px;\n        border-radius: 12px;\n        font-size: 12px;\n        font-weight: 500;\n        animation: pulse 1s infinite;\n      ">🎤 Speaking</div>\n    ':"";n.innerHTML="\n      ".concat(r,'\n      <div style="\n        display: flex;\n        align-items: center;\n        margin-bottom: 15px;\n        font-weight: 600;\n        color: #1a73e8;\n        font-size: 18px;\n      ">\n        <span style="font-size: 24px; margin-right: 10px;">').concat(t.isLocal?"👤":"👥","</span>\n        ").concat(t.name,'\n      </div>\n      <div style="\n        color: #5f6368;\n        line-height: 1.6;\n        font-size: 16px;\n        min-height: 24px;\n      ">\n        ').concat(t.transcript||'<span style="color: #9aa0a6; font-style: italic;">No transcript yet...</span>',"\n      </div>\n      ").concat(t.lastSpoke?'\n        <div style="\n          color: #9aa0a6;\n          font-size: 12px;\n          margin-top: 10px;\n          text-align: right;\n        ">\n          Last spoke: '.concat(t.lastSpoke,"\n        </div>\n      "):"","\n    "),H.appendChild(n)}),!document.getElementById("transcript-styles")){var t=document.createElement("style");t.id="transcript-styles",t.textContent="\n      @keyframes pulse {\n        0% { opacity: 1; }\n        50% { opacity: 0.5; }\n        100% { opacity: 1; }\n      }\n    ",document.head.appendChild(t)}}else H.innerHTML='\n      <div style="\n        text-align: center; \n        color: #5f6368; \n        padding: 40px;\n        font-size: 16px;\n      ">\n        No participants detected. Waiting for participants to join...\n      </div>\n    '}function wt(){return bt.apply(this,arguments)}function bt(){return(bt=V($().m(function t(){var e,n,r,i,o,a;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:return console.log("Starting transcript..."),t.p=1,e=document.getElementById("start-transcript-btn"),n=document.getElementById("stop-transcript-btn"),r=document.getElementById("transcript-status"),e&&(e.disabled=!0),n&&(n.disabled=!1),r&&(r.style.display="block",r.style.background="#e8f5e8",r.style.color="#137333",r.textContent="🎤 Live transcription active - listening to all participants"),t.n=2,Et();case 2:console.log("Transcription started successfully"),t.n=4;break;case 3:t.p=3,a=t.v,console.error("Error starting transcription:",a),Ct("Error starting transcription: "+a.message,"error"),i=document.getElementById("start-transcript-btn"),o=document.getElementById("stop-transcript-btn"),i&&(i.disabled=!1),o&&(o.disabled=!0);case 4:return t.a(2)}},t,null,[[1,3]])}))).apply(this,arguments)}function St(){return Pt.apply(this,arguments)}function Pt(){return(Pt=V($().m(function t(){var e,n,r,i;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:return console.log("Stopping transcript..."),t.p=1,t.n=2,kt();case 2:e=document.getElementById("start-transcript-btn"),n=document.getElementById("stop-transcript-btn"),r=document.getElementById("transcript-status"),e&&(e.disabled=!1),n&&(n.disabled=!0),r&&(r.style.background="#fce8e6",r.style.color="#d93025",r.textContent="⏹️ Transcription stopped"),console.log("Transcription stopped successfully"),t.n=4;break;case 3:t.p=3,i=t.v,console.error("Error stopping transcription:",i),Ct("Error stopping transcription: "+i.message,"error");case 4:return t.a(2)}},t,null,[[1,3]])}))).apply(this,arguments)}function Et(){return At.apply(this,arguments)}function At(){return(At=V($().m(function t(){var e;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:if(console.log("Starting Deepgram connection..."),et){t.n=1;break}throw new Error("Transcription manager not initialized");case 1:return t.p=1,t.n=2,et.startTranscription();case 2:console.log("Deepgram connection started successfully"),t.n=4;break;case 3:throw t.p=3,e=t.v,console.error("Error starting Deepgram connection:",e),e;case 4:return t.a(2)}},t,null,[[1,3]])}))).apply(this,arguments)}function kt(){return Tt.apply(this,arguments)}function Tt(){return(Tt=V($().m(function t(){var e;return $().w(function(t){for(;;)switch(t.p=t.n){case 0:if(console.log("Stopping Deepgram connection..."),et){t.n=1;break}return console.warn("Transcription manager not initialized"),t.a(2);case 1:return t.p=1,t.n=2,et.stopTranscription();case 2:console.log("Deepgram connection stopped successfully"),t.n=4;break;case 3:throw t.p=3,e=t.v,console.error("Error stopping Deepgram connection:",e),e;case 4:return t.a(2)}},t,null,[[1,3]])}))).apply(this,arguments)}function Ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("status");n&&(n.textContent=t,n.className="status ".concat(e),n.style.display="block",setTimeout(function(){n.style.display="none"},5e3))}return e})());
//# sourceMappingURL=bundle.js.map